"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[12993],{138774:function(e,t,i){var s=i(824246),n=i(674721),r=i.n(n),a=i(827378),o=i(163543),d=i(165168),c=i(298784),l=i.n(c),p=i(761830),h=i(808704),u=i(64499),m=i(513473),x=i(754333),b=i(924364),g=i(781355);let f=[h.GraderBuckets.Missing,h.GraderBuckets.Extraneous,h.GraderBuckets.Incorrect];let TrainingFeedbackChat=class TrainingFeedbackChat extends a.Component{get graderResponse(){return this.props.submissionResponse.graderResponse}renderTrainingAttemptId(){return(0,s.jsx)("div",{children:"Training Attempt Id: ".concat(this.props.trainingAttempt)},"trainingAttemptId")}renderInlineGraderAnnotations(){var e,t;let i=null===(e=this.props.trainingScenario)||void 0===e?void 0:e.params;if(!i)return null;let n=null===(t=this.graderResponse)||void 0===t?void 0:t.inlineAnnotationsList;if(!n)return null;let r=null==n?void 0:n.filter(e=>{var t,i,s;return(null===(t=e.graderConfig)||void 0===t?void 0:t.isGraded)&&(null==e?void 0:e.score)<(null!==(s=null===(i=e.graderConfig)||void 0===i?void 0:i.weight)&&void 0!==s?s:1)}),a=[...i.before,...i.turn,...i.after];return(0,s.jsx)("div",{children:l().map(r,(e,t)=>{var i,n,r;let o=null==e?void 0:e.responseIndex,d=null==e?void 0:e.score,c=null==e?void 0:e.selectedResponse,l=null==e?void 0:null===(i=e.graderConfig)||void 0===i?void 0:i.validAnswers.join(", "),p=null==e?void 0:null===(r=e.graderConfig)||void 0===r?void 0:null===(n=r.stepConfig)||void 0===n?void 0:n.fieldId,h=a.find(t=>{var i,s;return t.id===(null==e?void 0:null===(s=e.graderConfig)||void 0===s?void 0:null===(i=s.stepConfig)||void 0===i?void 0:i.stepId)}),u=null==h?void 0:h.title;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("strong",{children:[" Error #",t+1," "]}),(0,s.jsxs)("div",{children:["Field Title: ",u]}),(0,s.jsxs)("div",{children:["Field ID: ",p]}),(0,s.jsxs)("div",{children:["Response #: ",o]}),(0,s.jsxs)("div",{children:["Your Weighted Score: ",d]}),(0,s.jsxs)("div",{children:["Your Answer: ",c]}),(0,s.jsxs)("div",{children:["Valid Answers: ",l]})]})})},"inlineGraderAnnotations")}renderGlobalErrorScores(){var e;if(!(null===(e=this.graderResponse)||void 0===e?void 0:e.globalErrorScores))return;let t=this.graderResponse.globalErrorScores,i=l().map(t,e=>{var t;let i=e.intermediates&&l().size(e.intermediates)>1,n=e.correctWork!==e.totalWork,r=(null==e?void 0:null===(t=e.graderConfig)||void 0===t?void 0:t.defaultWeight)!==0;if(n&&r){let t=(0,h.getErrorCategoryName)(e),n=e.intermediates||0;return!i&&n&&(t+=" ("+l().map(n,(e,t)=>{let i=l().isNumber(e)&&!l().isInteger(e)?e.toFixed(2):e;return"".concat(t,": ").concat(i)}).join(", ")+")"),(0,s.jsx)("li",{children:t})}});if(0!==i.length)return(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Summary"}),(0,s.jsx)("ul",{children:i})]},"globalErrorScores")}getChatSubmittedAndExpectedResponse(e){let t=(0,m.Hm)(l().get(e,"currentAnnotation.frames[0]")),i=(0,m.Hm)(l().get(e,"correctAnnotation.frames[0]"));return{yourResponse:t=void 0===t?"(missing)":"".concat(t),expected:i="".concat(i)}}renderMatchedErrorScoresChat(){var e,t,i;let n=null===(e=this.props.trainingScenario)||void 0===e?void 0:e.params;if(!n)return null;let o=[...n.before,...n.turn,...n.after];if(!(null===(t=this.graderResponse)||void 0===t?void 0:t.matchedAnnotationsList))return null;let d=this.props.submissionResponse.passedAccuracyBar&&this.props.submissionResponse.passedSpeedBar,c=this.graderResponse.matchedAnnotationsList,p=(null===(i=this.props.trainingScenario.graderParams)||void 0===i?void 0:i.perAnnotationFeedback)||{},u=(0,h.getBucketedGradedAnnotations)(c,p),m={};m[h.GraderBuckets.Missing]=this.graderResponse.matchedAnnotationsList.filter(e=>e.correctAnnotation).length,m[h.GraderBuckets.Incorrect]=this.graderResponse.matchedAnnotationsList.filter(e=>e.correctAnnotation).map(e=>{var t,i;return null!==(i=null===(t=e.scores)||void 0===t?void 0:t.filter(e=>!["missing","extraneous"].includes(e.graderType)).filter(e=>{var t;return(null===(t=e.graderConfig)||void 0===t?void 0:t.defaultWeight)!==0}).length)&&void 0!==i?i:0}).reduce((e,t)=>e+t,0);let x={};return x[h.GraderBuckets.Missing]=u[h.GraderBuckets.Missing].length,x[h.GraderBuckets.Incorrect]=u[h.GraderBuckets.Incorrect].map(e=>{var t;return(null===(t=e.errors)||void 0===t?void 0:t.length)||0}).reduce((e,t)=>e+t,0),(0,s.jsxs)(a.Fragment,{children:[l().map(f,e=>{if(l().isNil(u)||l().isEmpty(u[e]))return null;let t=u[e];return(0,s.jsxs)("div",{className:"jsx-81fa3863ed7808a4 bucket",children:[this.props.trainingScenario.feedbackMessage&&(0,s.jsxs)("div",{className:"jsx-81fa3863ed7808a4 "+((d?"feedbackMessage":"feedbackMessageFail")||""),children:[(0,s.jsx)("div",{className:"jsx-81fa3863ed7808a4 bucket-name",children:"Feedback"}),(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:b.ZP.render(this.props.trainingScenario.feedbackMessage)},className:"jsx-81fa3863ed7808a4"})]}),m[e]&&(0,s.jsxs)("div",{className:"jsx-81fa3863ed7808a4 bucket-totals",children:[x[e]," errors"]}),(0,s.jsx)("div",{className:"jsx-81fa3863ed7808a4",children:l().map(t,e=>{let t=l().get(e,"currentAnnotation.frames[0].chatTaskAnnotationMetadata"),i=l().get(e,"metadata.props.label");if(t){var n;let e=t.stepId,s=o.find(t=>t.id===e),r=null===(n=l().get(s,"params.fields",[]).find(e=>e.field_id===t.originalFieldId))||void 0===n?void 0:n.title;s&&s.title&&(i="".concat(s.title," | Response#: ").concat(t.responseIndex+1).concat(void 0===t.candidateIndex?"":" | Candidate#: ".concat(t.candidateIndex+1)).concat(void 0===t.originalFieldId?"":" | Field: ".concat(null!=r?r:t.originalFieldId)))}if(!i)return null;let{yourResponse:r,expected:a}=this.getChatSubmittedAndExpectedResponse(e);return(0,s.jsxs)("div",{className:"jsx-81fa3863ed7808a4 bucket-item",children:[(0,s.jsx)("div",{className:"jsx-81fa3863ed7808a4 bucket-item-name",children:i}),(0,s.jsxs)("div",{className:"jsx-81fa3863ed7808a4",children:["Your response: ",r]}),(0,s.jsxs)("div",{className:"jsx-81fa3863ed7808a4",children:["Expected: ",a]})]},i)})})]},e)}),(0,s.jsx)(r(),{id:"81fa3863ed7808a4",children:".feedbackMessage.jsx-81fa3863ed7808a4{padding:8px;font-size:14px;border:1px solid#19b629;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;margin-bottom:12px}.feedbackMessageFail.jsx-81fa3863ed7808a4{padding:8px;font-size:14px;border:1px solid#ec322f;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;margin-bottom:12px}.bucket.jsx-81fa3863ed7808a4{padding:16px;font-size:14px}.bucket-name.jsx-81fa3863ed7808a4{letter-spacing:.5px;font-weight:500;opacity:.5}.bucket-totals.jsx-81fa3863ed7808a4{margin-top:4px;font-weight:500}.bucket-item.jsx-81fa3863ed7808a4{margin:16px 0}.bucket-item-name.jsx-81fa3863ed7808a4{margin-bottom:8px;font-weight:500}.bucket-errors.jsx-81fa3863ed7808a4{margin-left:16px}"})]})}renderInlineGraderInstructiveFeedbackMessage(){var e,t,i,n,r;return(null===(t=this.props.trainingScenario)||void 0===t?void 0:null===(e=t.benchmark)||void 0===e?void 0:e.isInstructiveBenchmark)&&(null===(i=this.graderResponse)||void 0===i?void 0:i.inlineAnnotationsList)?l().isNil(null===(n=this.props.trainingScenario)||void 0===n?void 0:n.feedbackMessage)?void 0:(0,s.jsx)("div",{className:"inline-grader-feedback-message",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("strong",{children:["Feedback Message: ",(0,s.jsx)("br",{})]}),null===(r=this.props.trainingScenario)||void 0===r?void 0:r.feedbackMessage]})}):null}renderGraderResponse(){var e;let t=new URLSearchParams(window.location.search),i=t.get("trainingId"),n=e=!!t.get("isVerificationAttempt"),a=1===this.props.submissionResponse.accuracy;return(0,s.jsxs)("div",{className:"jsx-2b3bd2a18eb650f2 grader-response branded-scroll--neutral",children:[(0,s.jsxs)("div",{className:"jsx-2b3bd2a18eb650f2 grader-response-header scale-tailwind scale-theme scaleui flex flex-row items-center space-x-2",children:[!a&&"Error Summary",n&&i&&a&&(0,s.jsx)(x.Z,{benchmarkId:i,passed:a})]}),this.renderInlineGraderInstructiveFeedbackMessage(),this.renderInlineGraderAnnotations(),this.renderGlobalErrorScores(),this.renderMatchedErrorScoresChat(),(0,s.jsx)(r(),{id:"2b3bd2a18eb650f2",children:".grader-response.jsx-2b3bd2a18eb650f2{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;width:480px;overflow:auto;background:white;border-top:1px solid var(--color-RemoGray01);border-left:1px solid var(--color-RemoGray01);font-size:15px}.grader-response-header.jsx-2b3bd2a18eb650f2{height:52px;padding:0 16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:1px solid var(--color-RemoGray01);font-weight:500}.grader-response-explanation.jsx-2b3bd2a18eb650f2{padding:0 16px;margin-bottom:8px;font-weight:400;font-style:italic}"})]})}get perfDisplay(){var e,t,i;let n,r;let{passedAccuracyBar:a,passedSpeedBar:o,timeSpentSecs:d,accuracy:c,passedBar:p,throttleTimeMs:h,isSpotterEvaluation:m}=this.props.submissionResponse,x=null===(i=this.props.trainingScenario)||void 0===i?void 0:null===(t=i.params)||void 0===t?void 0:null===(e=t.spotterBenchmarkParams)||void 0===e?void 0:e.expectedOutcome,{isInstructiveBenchmark:b,isConditionallyInstructiveBenchmark:g,isConditionallyInstructiveBenchmarkPassed:f}=this.props,k="".concat((100*Math.max(0,c)).toFixed(2),"%"),j={GREEN:"#19B629",YELLOW:"#F2C94C",RED:"#EC322F"},y=h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("br",{}),(0,s.jsx)("span",{children:(0,s.jsx)("b",{children:(0,s.jsx)("u",{children:(0,u._W)(h)})})})]}):"";if(b)1===c||g&&f?(r=j.GREEN,n=m?(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["You correctly ",x," this task!"]})," Great work!"," "]}):(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your accuracy on this task was ",k,"!"]})," Great work!"," "]})):p?(r=j.YELLOW,n=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your accuracy on this task was ",k,"."]})," Pretty good!"," "]})):(r=j.RED,n=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your accuracy on this task was ",k,"."]})," "]}));else if(a&&o)r=j.GREEN,n=(0,s.jsxs)("span",{children:[(0,s.jsx)("strong",{children:"Congratulations!"})," You successfully completed this challenge. Your response was ",k," accurate."]});else if(a){let e="".concat(Math.floor(d/60),":").concat(l().padStart(Math.floor(d%60).toString(),2,"0"));r=j.YELLOW,n=(0,s.jsxs)("span",{children:["Your response was accurate, but your time of ",(0,s.jsx)("strong",{children:e})," wasn't quite fast enough.",y]})}else r=j.RED,n=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your response was ",k," accurate."]})," ","Take a look at the error summary to see why.",y]});return{message:n,color:r}}get ctaButtons(){let{passedAccuracyBar:e,passedSpeedBar:t,accuracy:i,submitted:n,throttleTimeMs:d}=this.props.submissionResponse,{backToQueue:c,isInstructiveBenchmark:l,showFixAnswer:p,isConditionallyInstructiveBenchmark:h,isConditionallyInstructiveBenchmarkPassed:u,simpleFeedbackModalClosing:m}=this.props;return(0,s.jsxs)("div",{className:"jsx-9966e1d7a541c6b cta-buttons",children:[m?(0,s.jsx)(a.Fragment,{children:(0,s.jsx)("div",{onClick:this.props.makeChanges,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Close"})}):(0,s.jsx)(a.Fragment,{children:d&&!h?(0,s.jsx)("div",{className:"jsx-9966e1d7a541c6b cta-button primary",children:(0,s.jsx)(o.ZP,{href:"/onboarding-center",children:(0,s.jsx)("span",{style:{color:"white"},className:"jsx-9966e1d7a541c6b",children:"Back to Onboarding Center"})})}):(0,s.jsxs)(s.Fragment,{children:[l&&(0,s.jsx)(a.Fragment,{children:1===i||n||h&&u?(0,s.jsx)("div",{onClick:c,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Back to Queue"}):(0,s.jsx)("div",{onClick:c,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Fix Answer"})}),!l&&!(e&&t)&&(0,s.jsxs)(a.Fragment,{children:[t&&(0,s.jsxs)(a.Fragment,{children:[(0,s.jsx)("div",{onClick:()=>this.props.retryTraining(),className:"jsx-9966e1d7a541c6b cta-button secondary",children:"Clear & Restart"}),p&&(0,s.jsx)("div",{onClick:this.props.makeChanges,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Fix Answer"})]}),!t&&(0,s.jsx)(a.Fragment,{children:(0,s.jsx)("div",{onClick:()=>this.props.retryTraining(),className:"jsx-9966e1d7a541c6b cta-button primary",children:"Retry"})})]})]})}),(0,s.jsx)(r(),{id:"9966e1d7a541c6b",children:".cta-buttons.jsx-9966e1d7a541c6b{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex}.cta-button.jsx-9966e1d7a541c6b{-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);background:rgba(255,255,255,.2);cursor:pointer}.cta-button.jsx-9966e1d7a541c6b+.cta-button.jsx-9966e1d7a541c6b{margin-left:16px}.cta-button.primary.jsx-9966e1d7a541c6b{padding:4px 12px;font-weight:500;-webkit-transition:background-color.2s;-moz-transition:background-color.2s;-o-transition:background-color.2s;transition:background-color.2s}.cta-button.primary.jsx-9966e1d7a541c6b:hover{background:rgba(255,255,255,.25)}.cta-button.secondary.jsx-9966e1d7a541c6b{padding:4px 0px;background:none;font-weight:normal}"})]})}renderMultiTaskResponse(){let e={...this.props.trainingScenario,attemptId:this.props.trainingAttempt||this.props.trainingScenario._id,instruction:this.props.trainingScenario.instructions};return(0,s.jsx)(p.Z,{subtask:e,responses:[this.props.responses[0]]})}renderHeader(){return(0,s.jsxs)("div",{style:{background:this.perfDisplay.color},className:"jsx-73684222cea1b66 header",children:[(0,s.jsx)("div",{className:"jsx-73684222cea1b66",children:this.perfDisplay.message}),this.props.isCorpUser&&this.renderTrainingAttemptId(),(0,s.jsx)("div",{className:"jsx-73684222cea1b66",children:this.ctaButtons}),(0,s.jsx)(r(),{id:"73684222cea1b66",children:".header.jsx-73684222cea1b66{height:56px;padding:0 16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;color:white;font-size:15px}"})]})}renderRedirect(){var e;let t=new URLSearchParams(window.location.search),i="string"==typeof this.props.trainingScenario.project?this.props.trainingScenario.project:null===(e=this.props.trainingScenario.project)||void 0===e?void 0:e._id;if(i&&this.props.practiceProjectId&&i===this.props.practiceProjectId)return(0,s.jsx)(o.ZP,{href:"".concat(g.ZA,"/projects/practice/completed"),children:"Return to Introduction to Outlier"});if(!t.has("course_url"))return(0,s.jsx)(o.ZP,{href:"/en/expert",children:"Return to Dashboard"});{let e=decodeURIComponent(t.get("course_url"));return(0,s.jsx)(o.ZP,{href:e,children:"Continue Your Course"})}}renderBody(){return(0,s.jsxs)(a.Fragment,{children:[this.renderMultiTaskResponse(),this.renderGraderResponse()]})}render(){let e=this.props.submissionResponse.passedAccuracyBar&&this.props.submissionResponse.passedSpeedBar;return(0,s.jsxs)(d.u_,{isOpen:!0,margin:"32px 0",contentOverflow:"hidden",minWidth:"95vw",children:[(0,s.jsxs)("div",{className:"jsx-2462bf8c655d337c container",children:[(0,s.jsx)("div",{className:"jsx-2462bf8c655d337c feedback-header",children:this.renderHeader()}),e&&!this.props.simpleFeedbackModalClosing&&(0,s.jsx)("div",{className:"jsx-2462bf8c655d337c redirect-header",children:this.renderRedirect()}),(0,s.jsx)("div",{className:"jsx-2462bf8c655d337c feedback-body",children:this.renderBody()})]}),(0,s.jsx)(r(),{id:"2462bf8c655d337c",children:".container.jsx-2462bf8c655d337c{height:-webkit-calc(100vh - 64px);height:-moz-calc(100vh - 64px);height:calc(100vh - 64px);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;width:100%}.feedback-header.jsx-2462bf8c655d337c{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow:hidden;width:95vw}.redirect-header.jsx-2462bf8c655d337c{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow:hidden;padding:10px;margin:auto}.feedback-body.jsx-2462bf8c655d337c{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;width:95vw;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;overflow:scroll}"})]})}};TrainingFeedbackChat.defaultProps={showFixAnswer:!0},t.Z=TrainingFeedbackChat},35084:function(e,t,i){var s=i(824246),n=i(674721),r=i.n(n),a=i(827378),o=i(163543),d=i(165168),c=i(298784),l=i.n(c),p=i(167469),h=i(761830),u=i(492615),m=i(64499);let TrainingFeedbackDocumentTranscription=class TrainingFeedbackDocumentTranscription extends a.Component{get graderResponse(){return this.props.submissionResponse.graderResponse}renderTrainingAttemptId(){return(0,s.jsx)("div",{children:"Training Attempt Id: ".concat(this.props.trainingAttempt)},"trainingAttemptId")}get perfDisplay(){let e,t;let{passedAccuracyBar:i,passedSpeedBar:n,timeSpentSecs:r,accuracy:a,passedBar:o,throttleTimeMs:d}=this.props.submissionResponse,{isInstructiveBenchmark:c,allowedToSeeAnswerKey:h,isConditionallyInstructiveBenchmark:u,isConditionallyInstructiveBenchmarkPassed:x}=this.props,{params:b,taskType:g}=this.props.trainingScenario,f="".concat((100*Math.max(0,a)).toFixed(2),"%"),k={BLUE:"#008EFF",GREEN:"#19B629",YELLOW:"#F2C94C",RED:"#EC322F"},j=d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("br",{}),(0,s.jsx)("span",{children:(0,s.jsx)("b",{children:(0,s.jsx)("u",{children:(0,m._W)(d)})})})]}):"";if(!1===b.showGrade)t=k.BLUE,e=(0,s.jsxs)("span",{children:["Review all of your errors to see how well you did. Ask a trainer or on Slack when you are not sure.",j]});else if(c){let i=g===p.TaskType.SegmentAnnotation;1===a||i&&a>=.5||u&&x?(t=k.GREEN,e=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your accuracy on this task was ",f,"!"]})," Great work!"," "]})):o?(t=k.YELLOW,e=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your accuracy on this task was ",f,"."]})," Pretty good!",h&&"Take a look at the Answer Key to identify issues to improve on."]})):(t=k.RED,e=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your accuracy on this task was ",f,"."]}),h&&"Take a look at the Answer Key to identify issues to improve on."]}))}else if(i&&n)t=k.GREEN,e=(0,s.jsxs)("span",{children:[(0,s.jsx)("strong",{children:"Congratulations!"})," You successfully completed this challenge."]});else if(i){let i="".concat(Math.floor(r/60),":").concat(l().padStart(Math.floor(r%60).toString(),2,"0"));t=k.YELLOW,e=(0,s.jsxs)("span",{children:["Your response was accurate, but your time of ",(0,s.jsx)("strong",{children:i})," wasn't quite fast enough.",j]})}else t=k.RED,e=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your response was ",f," accurate."]})," ",h&&"Take a look at the Answer Key to identify issues.",j]});return{message:e,color:t}}get ctaButtons(){let{passedAccuracyBar:e,passedSpeedBar:t,accuracy:i,submitted:n,throttleTimeMs:d}=this.props.submissionResponse,{backToQueue:c,isInstructiveBenchmark:l,isConditionallyInstructiveBenchmark:p,isConditionallyInstructiveBenchmarkPassed:h,simpleFeedbackModalClosing:u}=this.props;return(0,s.jsxs)("div",{className:"jsx-9966e1d7a541c6b cta-buttons",children:[u?(0,s.jsx)(a.Fragment,{children:(0,s.jsx)("div",{onClick:this.props.makeChanges,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Close"})}):(0,s.jsx)(a.Fragment,{children:d&&!p?(0,s.jsx)("div",{className:"jsx-9966e1d7a541c6b cta-button primary",children:(0,s.jsx)(o.ZP,{href:"/onboarding-center",children:(0,s.jsx)("span",{style:{color:"white"},className:"jsx-9966e1d7a541c6b",children:"Back to Onboarding Center"})})}):(0,s.jsxs)(s.Fragment,{children:[l&&(0,s.jsx)(a.Fragment,{children:1===i||n||p&&h?(0,s.jsx)("div",{onClick:c,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Back to Queue"}):(0,s.jsx)("div",{onClick:c,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Fix Answer"})}),!l&&!(e&&t)&&(0,s.jsxs)(a.Fragment,{children:[t&&(0,s.jsxs)(a.Fragment,{children:[(0,s.jsx)("div",{onClick:()=>this.props.retryTraining(),className:"jsx-9966e1d7a541c6b cta-button secondary",children:"Clear & Restart"}),(0,s.jsx)("div",{onClick:this.props.makeChanges,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Fix Answer"})]}),!t&&(0,s.jsx)(a.Fragment,{children:(0,s.jsx)("div",{onClick:this.props.retryTraining,className:"jsx-9966e1d7a541c6b cta-button primary",children:"Retry"})})]})]})}),(0,s.jsx)(r(),{id:"9966e1d7a541c6b",children:".cta-buttons.jsx-9966e1d7a541c6b{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex}.cta-button.jsx-9966e1d7a541c6b{-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);background:rgba(255,255,255,.2);cursor:pointer}.cta-button.jsx-9966e1d7a541c6b+.cta-button.jsx-9966e1d7a541c6b{margin-left:16px}.cta-button.primary.jsx-9966e1d7a541c6b{padding:4px 12px;font-weight:500;-webkit-transition:background-color.2s;-moz-transition:background-color.2s;-o-transition:background-color.2s;transition:background-color.2s}.cta-button.primary.jsx-9966e1d7a541c6b:hover{background:rgba(255,255,255,.25)}.cta-button.secondary.jsx-9966e1d7a541c6b{padding:4px 0px;background:none;font-weight:normal}"})]})}renderMultiTaskResponse(){let e={...this.props.trainingScenario,instruction:this.props.trainingScenario.instructions};if(!this.props.allowedToSeeAnswerKey)return(0,s.jsx)(u.Z,{subtask:e,responses:[this.props.responses[0]]});let t=[...this.props.responses];return this.props.diffingResponse&&t.push(...this.props.diffingResponse),(0,s.jsx)(h.Z,{subtask:e,responses:t,diffingResponse:this.props.diffingResponse,diffingResponseName:"Problem Zones"})}renderHeader(){return(0,s.jsxs)("div",{style:{background:this.perfDisplay.color},className:"jsx-73684222cea1b66 header",children:[(0,s.jsx)("div",{className:"jsx-73684222cea1b66",children:this.perfDisplay.message}),this.props.isCorpUser&&this.renderTrainingAttemptId(),(0,s.jsx)("div",{className:"jsx-73684222cea1b66",children:this.ctaButtons}),(0,s.jsx)(r(),{id:"73684222cea1b66",children:".header.jsx-73684222cea1b66{height:56px;padding:0 16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;color:white;font-size:15px}"})]})}renderRedirect(){let e=new URLSearchParams(window.location.search);if(!e.has("course_url"))return(0,s.jsx)(o.ZP,{href:"/onboarding-center",children:"Return to Onboarding Center"});{let t=decodeURIComponent(e.get("course_url"));return(0,s.jsx)(o.ZP,{href:t,children:"Continue Your Course"})}}renderBody(){let{passedAccuracyBar:e,passedSpeedBar:t}=this.props.submissionResponse;return e&&t?(0,s.jsxs)("div",{className:"jsx-71cfad0d76e6360f completion-message",children:[!this.props.simpleFeedbackModalClosing&&this.renderRedirect(),(0,s.jsx)(r(),{id:"71cfad0d76e6360f",children:".completion-message.jsx-71cfad0d76e6360f{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding:64px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;color:rgba(0,0,0,.5)}"})]}):this.renderMultiTaskResponse()}render(){return(0,s.jsxs)(d.u_,{isOpen:!0,margin:"32px 0",contentOverflow:"hidden",maxWidth:"100vw",children:[(0,s.jsxs)("div",{className:"jsx-e79ce5b65509592 container",children:[(0,s.jsx)("div",{className:"jsx-e79ce5b65509592 feedback-header",children:this.renderHeader()}),(0,s.jsx)("div",{className:"jsx-e79ce5b65509592 feedback-body",children:this.renderBody()})]}),(0,s.jsx)(r(),{id:"e79ce5b65509592",children:".container.jsx-e79ce5b65509592{height:-webkit-calc(100vh - 64px);height:-moz-calc(100vh - 64px);height:calc(100vh - 64px);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.feedback-header.jsx-e79ce5b65509592{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}.feedback-body.jsx-e79ce5b65509592{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;overflow:hidden}"})]})}};t.Z=TrainingFeedbackDocumentTranscription},291786:function(e,t,i){i.d(t,{Z:function(){return training_TrainingFeedbackNER}});var s=i(824246),n=i(674721),r=i.n(n),a=i(827378),o=i(163543),d=i(165168),c=i(298784),l=i.n(c),p=i(761830),h=i(492615),u=i(433536),m=i(808704),x=i(885748),b=i(626407),g=i.n(b);let f=[m.GraderBuckets.Missing,m.GraderBuckets.Extraneous,m.GraderBuckets.Incorrect],getAnnotationText=e=>e&&e.frames&&e.frames[0].text,getAnnotationLabel=(e,t)=>{let i=t&&t.props&&t.props.label;for(let t of(0,x.depthFirstLabels)(e))if(t.name===i)return t},TrainingFeedbackSummary=e=>{var t,i;let{submissionResponse:n,trainingScenario:r}=e,o=k(),d=null===(t=null==n?void 0:n.graderResponse)||void 0===t?void 0:t.matchedAnnotationsList,c=null==r?void 0:null===(i=r.graderParams)||void 0===i?void 0:i.perAnnotationFeedback,p=a.useMemo(()=>{var e;return null!==(e=(0,m.getBucketedGradedAnnotations)(null!=d?d:[],null!=c?c:{}))&&void 0!==e?e:{}},[d,c]);return(0,s.jsxs)("div",{className:o.graderResponse,children:[(0,s.jsx)("div",{className:o.graderResponseHeader,children:"Error Summary"}),f.map(e=>{let t=p[e];if(!(null==t?void 0:t.length))return null;let i=l().groupBy(t,e=>e.metadata.props.type),n=l().size(i.relationship);return(0,s.jsxs)("div",{className:o.bucket,children:[(0,s.jsxs)("div",{className:o.bucketHeader,children:[(0,s.jsx)("div",{className:o.bucketName,children:e}),(0,s.jsx)("div",{className:o.bucketCount,children:t.length})]}),l().map(i.annotation,t=>(0,s.jsx)(TrainingFeedbackAnnotationRow,{labels:r.params.labels,bucketName:e,gradedAnnotation:t},t.metadata.props.id)),n>0&&(0,s.jsxs)("div",{children:["+ errors from ",n," ",g()("relationship",n)]})]},e)})]})};TrainingFeedbackSummary.displayName="TrainingFeedbackSummary";let TrainingFeedbackAnnotationRow=e=>{let{labels:t,bucketName:i,gradedAnnotation:n}=e,r=k(),renderTextWithAnnotation=(e,t)=>{var i;return(0,s.jsx)("span",{children:'"'.concat(e,'" (').concat(null!==(i=null==t?void 0:t.display_name)&&void 0!==i?i:null==t?void 0:t.name,")")})},a=i!==m.GraderBuckets.Missing,o=i!==m.GraderBuckets.Extraneous,d=getAnnotationText(n.currentAnnotation)||getAnnotationText(n.correctAnnotation),c=getAnnotationText(n.correctAnnotation)||getAnnotationText(n.currentAnnotation),p=getAnnotationLabel(t,n.currentAnnotation),h=getAnnotationLabel(t,n.correctAnnotation);return(0,s.jsxs)("div",{className:r.bucketItem,children:[(0,s.jsxs)("div",{className:r.bucketItemName,children:[a&&renderTextWithAnnotation(d,p),a&&o&&(0,s.jsx)("span",{className:r.elevatedText,children:"\xa0 â†’ \xa0"}),o&&renderTextWithAnnotation(c,h)]}),(0,s.jsx)("div",{className:r.bucketItemErrors,children:l().map(n.errors,e=>(0,s.jsx)("div",{className:r.errorMessage,children:e}))})]})};TrainingFeedbackAnnotationRow.displayName="TrainingFeedbackAnnotationRow";let k=(0,u.ZL)({graderResponse:{overflowX:"hidden",overflowY:"auto",flexShrink:0,width:360,overflow:"auto",background:"white",borderTop:"1px solid var(--color-RemoGray01)",borderLeft:"1px solid var(--color-RemoGray01)",fontSize:"15px"},graderResponseHeader:{height:52,padding:"0 16px",display:"flex",alignItems:"center",borderBottom:"1px solid var(--color-RemoGray01)",fontWeight:400},elevatedText:{display:"inline-block",marginBottom:9},bucket:{padding:16,fontSize:"14px",borderTop:"1px solid #e6e6e6"},bucketHeader:{display:"flex",flexDirection:"row",marginBottom:13},bucketName:{textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:400,opacity:1},bucketCount:{fontWeight:400,opacity:.5,marginLeft:"auto"},bucketItem:{margin:"16px 0"},bucketItemName:{marginBottom:8,fontWeight:400},bucketItemErrors:{marginLeft:16},errorMessage:{color:"rgba(0, 0, 0, 0.5)",paddingTop:4,paddingBottom:4}});var training_TrainingFeedbackNER=e=>{let t,i,n,c;let{passedAccuracyBar:u,passedSpeedBar:m,timeSpentSecs:x,accuracy:b,passedBar:g,submitted:f,earnedReward:k}=e.submissionResponse,{isInstructiveBenchmark:j,allowedToSeeAnswerKey:y,isConditionallyInstructiveBenchmark:w,isConditionallyInstructiveBenchmarkPassed:v,simpleFeedbackModalClosing:T}=e,{params:S}=e.trainingScenario,R=u&&m,C="".concat((100*Math.max(0,b)).toFixed(2),"%"),A={BLUE:"#008EFF",GREEN:"#19B629",YELLOW:"#F2C94C",RED:"#EC322F"};if(!1===S.showGrade)i=A.BLUE,t=(0,s.jsx)("span",{children:"Review all of your errors to see how well you did. Ask a trainer or on Slack when you are not sure."});else if(j)1===b||w&&v?(i=A.GREEN,t=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your accuracy on this task was ",C,"!"]})," Great work!"," "]})):g?(i=A.YELLOW,t=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your accuracy on this task was ",C,"."]})," Pretty good!",y&&"Take a look at the Answer Key to identify issues to improve on."]})):(i=A.RED,t=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your accuracy on this task was ",C,"."]}),y&&"Take a look at the Answer Key to identify issues to improve on."]}));else if(R)i=A.GREEN,t=(0,s.jsxs)("span",{children:[(0,s.jsx)("strong",{children:"Congratulations!"})," You successfully completed this challenge."]});else if(u){let e="".concat(Math.floor(x/60),":").concat(l().padStart(Math.floor(x%60).toString(),2,"0"));i=A.YELLOW,t=(0,s.jsxs)("span",{children:["Your response was accurate, but your time of ",(0,s.jsx)("strong",{children:e})," wasn't quite fast enough."]})}else i=A.RED,t=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your response was ",C," accurate."]})," ",y&&"Take a look at the Answer Key to identify issues."]});let F={message:t,color:i},{backToQueue:N}=e,P=(0,s.jsxs)("div",{className:"jsx-25691d5b6853096b cta-buttons",children:[T?(0,s.jsx)(a.Fragment,{children:(0,s.jsx)("div",{onClick:e.makeChanges,className:"jsx-25691d5b6853096b cta-button primary",children:"Close"})}):(0,s.jsxs)(a.Fragment,{children:[j&&(0,s.jsx)(a.Fragment,{children:1===b||f||w&&v?(0,s.jsx)("div",{onClick:N,className:"jsx-25691d5b6853096b cta-button primary",children:"Back to Queue"}):(0,s.jsx)("div",{onClick:N,className:"jsx-25691d5b6853096b cta-button primary",children:"Fix Answer"})}),!j&&!R&&(0,s.jsxs)(a.Fragment,{children:[m&&(0,s.jsxs)(a.Fragment,{children:[(0,s.jsx)("div",{onClick:e.retryTraining,className:"jsx-25691d5b6853096b cta-button secondary",children:"Clear & Restart"}),(0,s.jsx)("div",{onClick:e.makeChanges,className:"jsx-25691d5b6853096b cta-button primary",children:"Fix Answer"})]}),!m&&(0,s.jsx)(a.Fragment,{children:(0,s.jsx)("div",{onClick:e.retryTraining,className:"jsx-25691d5b6853096b cta-button primary",children:"Retry"})})]})]}),(0,s.jsx)(r(),{id:"25691d5b6853096b",children:".cta-buttons.jsx-25691d5b6853096b{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex}.cta-button.jsx-25691d5b6853096b{-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);background:rgba(255,255,255,.2);cursor:pointer}.cta-button.jsx-25691d5b6853096b+.cta-button.jsx-25691d5b6853096b{margin-left:16px}.cta-button.primary.jsx-25691d5b6853096b{padding:4px 12px;font-weight:400;-webkit-transition:background-color.2s;-moz-transition:background-color.2s;-o-transition:background-color.2s;transition:background-color.2s}.cta-button.primary.jsx-25691d5b6853096b:hover{background:rgba(255,255,255,.25)}.cta-button.secondary.jsx-25691d5b6853096b{padding:4px 0px;background:none;font-weight:normal}"})]}),I=new URLSearchParams(window.location.search);if(!T){if(I.has("course_url")){let e=decodeURIComponent(I.get("course_url"));n=(0,s.jsx)(o.ZP,{href:e,children:"Continue Your Course"})}else n=(0,s.jsx)(o.ZP,{href:"/onboarding-center",children:"Return to Onboarding Center"})}let{rewardAmountHundredthsOfCents:z}=e.trainingScenario,E={...e.trainingScenario,instruction:e.trainingScenario.instructions},_=!(z>0);return R&&!j&&(c=k||_?_?(0,s.jsxs)(s.Fragment,{children:["Complete more Training Courses to become enabled on more challenging, higher-paying tasks.\xa0\xa0",n]}):(0,s.jsxs)(s.Fragment,{children:["You earned $",z/1e4," for your great work. If you use these skills on tasks, you can do them faster and earn more!\xa0\xa0",n]}):(0,s.jsxs)(s.Fragment,{children:["You've already claimed the reward for this challenge.\xa0\xa0",n]})),(0,s.jsxs)(d.u_,{isOpen:!0,margin:"32px 0",contentOverflow:"hidden",maxWidth:"100vw",children:[(0,s.jsxs)("div",{className:"jsx-d6867e5b1ab5e00 container",children:[(0,s.jsx)("div",{className:"jsx-d6867e5b1ab5e00 feedback-header",children:(0,s.jsxs)("div",{style:{background:F.color},className:"jsx-d6867e5b1ab5e00 header",children:[(0,s.jsx)("div",{className:"jsx-d6867e5b1ab5e00",children:F.message}),e.isCorpUser&&(0,s.jsx)("div",{className:"jsx-d6867e5b1ab5e00",children:"Training Attempt Id: ".concat(e.trainingAttempt)},"trainingAttemptId"),(0,s.jsx)("div",{className:"jsx-d6867e5b1ab5e00",children:P})]})}),(0,s.jsx)("div",{className:"jsx-d6867e5b1ab5e00 feedback-body",children:R&&!j?(0,s.jsx)("div",{className:"jsx-d6867e5b1ab5e00 completion-message",children:c}):(0,s.jsxs)(s.Fragment,{children:[y&&(0,s.jsx)(TrainingFeedbackSummary,{trainingScenario:e.trainingScenario,submissionResponse:e.submissionResponse}),e.allowedToSeeAnswerKey?(0,s.jsx)(p.Z,{subtask:E,responses:e.responses,diffingResponse:e.diffingResponse,diffingResponseName:"Problem Zones",hideLabels:!0}):(0,s.jsx)(h.Z,{subtask:E,responses:[e.responses[0]]})]})})]}),(0,s.jsx)(r(),{id:"d6867e5b1ab5e00",children:".completion-message.jsx-d6867e5b1ab5e00{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding:64px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;color:rgba(0,0,0,.5)}.header.jsx-d6867e5b1ab5e00{height:56px;padding:0 16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;color:white;font-size:15px}.container.jsx-d6867e5b1ab5e00{height:-webkit-calc(100vh - 64px);height:-moz-calc(100vh - 64px);height:calc(100vh - 64px);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.feedback-header.jsx-d6867e5b1ab5e00{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}.feedback-body.jsx-d6867e5b1ab5e00{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;overflow:hidden}"})]})}},623589:function(e,t,i){i.d(t,{Z:function(){return training_TrainingFeedbackTextCollection}});var s=i(824246),n=i(674721),r=i.n(n),a=i(827378),o=i(163543),d=i(165168),c=i(298784),l=i.n(c),p=i(650963),h=i(924364),u=i(692975),m=i(107873),x=i(946975),b=i(433536),g=i(857428);let f={[g.S.Video]:"Watch the following short video to understand the correct answer:",[g.S.Markdown]:"Read the following explanation to understand the correct answer:"},VideoContent=e=>{let{content:t,onViewedContent:i}=e,n=k();return(0,s.jsx)("div",{className:n.videoContainer,children:(0,s.jsx)(u.Z,{controls:!0,height:"100%",url:t.videoUrl,onEnded:i})})},MarkdownContent=e=>{let{content:t,onViewedContent:i}=e;return a.useEffect(()=>{setTimeout(()=>{i()},3e3)},[i]),(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:h.ZP.render(t.markdownText)}})},k=(0,b.ZL)({container:{background:"white",padding:36,minHeight:"80vh"},header:{marginTop:0},contentContainer:{marginTop:16,display:"flex",height:"70vh"},videoContainer:{display:"flex",justifyContent:"center",flexGrow:1},continueButtonContainer:{display:"flex",flexDirection:"row",justifyContent:"center",marginTop:16}});var InstructionReminder=e=>{var t;let{instructionReminder:i,onClose:n}=e,[r,o]=a.useState(!1),d=k(),c=null!==(t=i.description)&&void 0!==t?t:f[i.content.type];return(0,s.jsxs)("div",{className:d.container,children:[(0,s.jsx)(x.H1,{children:c}),(0,s.jsxs)("div",{className:d.contentContainer,children:[i.content.type===g.S.Video&&(0,s.jsx)(VideoContent,{content:i.content,onViewedContent:()=>o(!0)}),i.content.type===g.S.Markdown&&(0,s.jsx)(MarkdownContent,{content:i.content,onViewedContent:()=>o(!0)})]}),(0,s.jsx)("div",{className:d.continueButtonContainer,children:(0,s.jsx)(m.zx,{onClick:n,disabled:!r,type:"primary",children:"View Feedback"})})]})},j=i(795115),y=i(320280),w=i(436878),v=i(60042),T=i.n(v),S=i(599789),R=i(837553),C=i(50682),A=i.n(C),F=i(92510);let N=(0,F.Z)("benchmarkreporting"),logBenchmarkReport=(e,t,i,s)=>{N.incr("reportTask",1,{projectId:e||"undefined_project_id",taskId:t||"undefined_task_id",userId:i||"undefined_user_id",explanation:s||"undefined_explanation"})};var P=i(984712),I=i(352991),training_TrainingFeedbackTextCollection=e=>{var t;let i,n,c,h;let{passedAccuracyBar:u,passedSpeedBar:m,timeSpentSecs:x,accuracy:b,passedBar:g,submitted:f,earnedReward:k,graderResponse:v,instructionReminder:C}=e.submissionResponse,F=(0,R.ZP)("show-bm-rewards",{projectId:e.project},!1),[N,z]=a.useState(!1),E=(0,R.ZP)("disable-bm-reporting",{projectId:e.trainingScenario.project},!1),_=a.useCallback(async()=>{if(E){z(!1);return}if(e.isCorpUser){z(!0);return}let{success:t,allowReporting:i}=await (0,I.ZP)(null,"corp-api/qm/benchmark/allow-reporting/".concat(e.trainingScenario.project,"/").concat(e.loggedUserId),{method:"GET"});t&&i&&z(!0)},[E,e.loggedUserId,e.trainingScenario.project,e.isCorpUser]);a.useEffect(()=>{_()},[_]);let{isInstructiveBenchmark:L,allowedToSeeAnswerKey:B,isConditionallyInstructiveBenchmark:Z,isConditionallyInstructiveBenchmarkPassed:M,simpleFeedbackModalClosing:D}=e,{params:G,trainingType:U,rewardAmountHundredthsOfCents:Y}=e.trainingScenario,V=U===S.TrainingScenarioType.AccuracyBenchmark,O=u&&m,W="".concat((100*Math.max(0,b)).toFixed(2),"%"),H={BLUE:"#008EFF",GREEN:"#19B629",YELLOW:"#F2C94C",RED:"#EC322F"};if(!1===G.showGrade||V)n=H.BLUE,i=(0,s.jsx)("span",{children:"Your submission will be reviewed."});else if(L)g||Z&&M?(n=H.GREEN,i=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your accuracy on this task was ",W,"!"]})," Great work!"," ",F&&"This task earned you $".concat(Y/1e4,".")]})):(n=H.RED,i=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your accuracy on this task was ",W,"."]}),B&&"Take a look at the Answer Key to identify issues to improve on."]}));else if(O)n=H.GREEN,i=(0,s.jsxs)("span",{children:[(0,s.jsx)("strong",{children:"Congratulations!"})," You successfully completed this challenge."]});else if(u){let e="".concat(Math.floor(x/60),":").concat(l().padStart(Math.floor(x%60).toString(),2,"0"));n=H.YELLOW,i=(0,s.jsxs)("span",{children:["Your response was accurate, but your time of ",(0,s.jsx)("strong",{children:e})," wasn't quite fast enough."]})}else n=H.RED,i=(0,s.jsxs)("span",{children:[(0,s.jsxs)("strong",{children:["Your response was ",W," accurate."]})," ",B&&"Take a look at the Answer Key to identify issues."]});let K={message:i,color:n},{backToQueue:q}=e,[Q,$]=a.useState(!0),handleReport=async(t,i)=>{$(!1);let s={reports:[{worker:e.loggedUserId,trainingAttempt:e.trainingAttempt||e.submissionResponse._id||"",reason:t,explanation:i,reportedAt:new Date}]};await (0,I.ZP)(null,"corp-api/qm/benchmark/".concat(e.trainingScenario.id),{method:"PUT",body:s}),e.trainingScenario&&logBenchmarkReport(e.trainingScenario.project,e.trainingScenario.id,e.loggedUserId,i)},J=Q&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{"data-tip":"Report if you disagree with the answer key. You must still Fix Answer and resubmit to pass.",children:(0,s.jsx)(P.Z,{disabled:!1,handleReport:handleReport,style:{marginRight:12,backgroundColor:"var(--color-RemoGold)",color:"white"},buttonText:"Report",reportBodyText:"Please let us know what's wrong with this task so we can make tasking better for you.",reportHeaderText:"Report this task",explanationPlaceholder:"I disagree with the answer key because...",closeModalOnReport:!0,isBenchmarkReporting:!0})}),(0,s.jsx)(A(),{place:"left"})]}),X=(0,s.jsxs)("div",{className:"jsx-25691d5b6853096b cta-buttons",children:[D?(0,s.jsx)(a.Fragment,{children:(0,s.jsx)("div",{onClick:e.makeChanges,className:"jsx-25691d5b6853096b cta-button primary",children:"Close"})}):(0,s.jsxs)(a.Fragment,{children:[L&&(0,s.jsx)(a.Fragment,{children:g||f||Z&&M?(0,s.jsx)("div",{onClick:q,className:"jsx-25691d5b6853096b cta-button primary",children:"Back to Queue"}):(0,s.jsxs)(a.Fragment,{children:[N&&J,(0,s.jsx)("div",{onClick:q,className:"jsx-25691d5b6853096b cta-button primary",children:"Fix Answer"})]})}),!L&&!O&&!V&&(0,s.jsxs)(a.Fragment,{children:[m&&(0,s.jsxs)(a.Fragment,{children:[N&&J,(0,s.jsx)("div",{onClick:e.retryTraining,className:"jsx-25691d5b6853096b cta-button secondary",children:"Clear & Restart"}),(0,s.jsx)("div",{onClick:e.makeChanges,className:"jsx-25691d5b6853096b cta-button primary",children:"Fix Answer"})]}),!m&&(0,s.jsx)(a.Fragment,{children:(0,s.jsx)("div",{onClick:e.retryTraining,className:"jsx-25691d5b6853096b cta-button primary",children:"Retry"})})]})]}),(0,s.jsx)(r(),{id:"25691d5b6853096b",children:".cta-buttons.jsx-25691d5b6853096b{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex}.cta-button.jsx-25691d5b6853096b{-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);background:rgba(255,255,255,.2);cursor:pointer}.cta-button.jsx-25691d5b6853096b+.cta-button.jsx-25691d5b6853096b{margin-left:16px}.cta-button.primary.jsx-25691d5b6853096b{padding:4px 12px;font-weight:400;-webkit-transition:background-color.2s;-moz-transition:background-color.2s;-o-transition:background-color.2s;transition:background-color.2s}.cta-button.primary.jsx-25691d5b6853096b:hover{background:rgba(255,255,255,.25)}.cta-button.secondary.jsx-25691d5b6853096b{padding:4px 0px;background:none;font-weight:normal}"})]}),ee=new URLSearchParams(window.location.search);D||(c=ee.has("course_url")?(0,s.jsx)("a",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"},onClick:()=>window.close(),children:"Continue Your Course (Closes this tab)"}):(0,s.jsx)(o.ZP,{href:"/onboarding-center",children:"Return to Onboarding Center"}));let et={...e.trainingScenario,instruction:e.trainingScenario.instructions},ei=!(Y>0);O&&!L&&(h=k||ei?ei?(0,s.jsxs)(s.Fragment,{children:["Complete more Training Courses to become enabled on more challenging, higher-paying tasks.\xa0\xa0",c]}):(0,s.jsxs)(s.Fragment,{children:["You earned $",Y/1e4," for your great work. If you use these skills on tasks, you can do them faster and earn more!\xa0\xa0",c]}):(0,s.jsxs)(s.Fragment,{children:["You've already claimed the reward for this challenge.\xa0\xa0",c]}));let es=v.graderDiffResponse,[en,er]=a.useState(!!C);a.useEffect(()=>{C&&(en?j.c.track("Instruction Reminder Shown",{instructionReminderId:C._id,trainingAttempt:e.trainingAttempt}):j.c.track("Instruction Reminder Completed",{instructionReminderId:C._id,trainingAttempt:e.trainingAttempt}))},[C,e.trainingAttempt,en]);let ea=(0,y.ZL)({header:{height:"56px",padding:"0 16px",display:"flex",justifyContent:"space-between",alignItems:"center",color:"white",fontSize:"15px",["@media (max-width: ".concat(w.Et,")")]:{height:"auto",padding:"16px",flexDirection:"column"}},headerSectionResponsive:{["@media (max-width: ".concat(w.Et,")")]:{marginBottom:"8px"}}}),eo=ea();return(0,s.jsxs)(d.u_,{isOpen:!0,margin:"32px 0",contentOverflow:"hidden",maxWidth:"100vw",children:[!!C&&en&&(0,s.jsx)(InstructionReminder,{instructionReminder:C,onClose:()=>er(!1)}),!en&&(0,s.jsxs)("div",{className:"jsx-795bdccce560f4b6 container",children:[(0,s.jsx)("div",{className:"jsx-795bdccce560f4b6 feedback-header",children:(0,s.jsxs)("div",{style:{background:K.color},className:"jsx-795bdccce560f4b6 "+(T()(eo.header)||""),children:[(0,s.jsx)("div",{className:"jsx-795bdccce560f4b6 "+(T()(eo.headerSectionResponsive)||""),children:K.message}),e.isCorpUser&&(0,s.jsx)("div",{className:"jsx-795bdccce560f4b6 "+(T()(eo.headerSectionResponsive)||""),children:"Training Attempt Id: ".concat(e.trainingAttempt)},"trainingAttemptId"),(0,s.jsx)("div",{className:"jsx-795bdccce560f4b6",children:X})]})}),(0,s.jsxs)("div",{className:"jsx-795bdccce560f4b6 feedback-body",children:[(l().isNil(G.showGrade)||G.showGrade)&&(0,s.jsx)(s.Fragment,{children:O&&!L?(0,s.jsx)("div",{className:"jsx-795bdccce560f4b6 completion-message",children:h}):(0,s.jsx)(p.Z,{params:et.params,graderDiffResponse:es,feedbackComment:(null===(t=e.trainingScenario.params)||void 0===t?void 0:t.feedbackComment)||e.trainingScenario.feedbackMessage,loggedUserId:e.loggedUserId,useProtectedText:e.useProtectedText,project:e.project,passedChallenge:O})}),!1===G.showGrade&&(0,s.jsx)("div",{className:"jsx-795bdccce560f4b6 completion-message",children:"Your submission will be reviewed."})]})]}),(0,s.jsx)(r(),{id:"795bdccce560f4b6",children:".completion-message.jsx-795bdccce560f4b6{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding:64px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;color:rgba(0,0,0,.5)}.container.jsx-795bdccce560f4b6{height:-webkit-calc(100vh - 64px);height:-moz-calc(100vh - 64px);height:calc(100vh - 64px);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.grader-response.jsx-795bdccce560f4b6{overflow-x:hidden!important;overflow-y:auto;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;width:360px;overflow:auto;background:white;border-top:1px solid var(--color-RemoGray01);border-left:1px solid var(--color-RemoGray01);font-size:15px}.grader-response-header.jsx-795bdccce560f4b6{height:52px;padding:0 16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:1px solid var(--color-RemoGray01);font-weight:400}.feedback-header.jsx-795bdccce560f4b6{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}.feedback-body.jsx-795bdccce560f4b6{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;overflow:hidden;width:100%}"})]})}},754333:function(e,t,i){var s=i(824246),n=i(827378),r=i(834770),a=i(416534),o=i(352991),d=i(298784),c=i.n(d);t.Z=e=>{let{benchmarkId:t,updateBenchmarkState:i,passed:d=!1}=e,[l,p]=(0,n.useState)([]),[h,u]=(0,n.useState)(!1),markBenchmarkAsVerified=async()=>{try{await (0,o.ZP)(null,"internal/training/approve/".concat(t),{method:"POST"}),i&&i(),u(!0),alert("Successfully verified benchmark: "+t)}catch(e){(0,o.vj)(e),alert("Failed to verify benchmark: "+t)}};(0,n.useEffect)(()=>{let e=!1,fetchAttempts=async()=>{let{attempts:i}=await (0,o.ZP)(null,"/corp-api/qm/individual-benchmark-metrics/attempts-since-last-update",{method:"POST",body:{scenarioId:t}});e||p(i)};return fetchAttempts(),()=>{e=!0}},[t]);let m=c().some(l,e=>e.accuracy<1),x=l.length>=1&&m||d;return(0,s.jsx)(r.u,{text:h?"This benchmark has been verified.":0===l.length?"Verification attempt must be completed to allow marking benchmark as verified.":m?"Attempts didn't meet the pass threshold. You can't verify this benchmark.":"Verify this benchmark",asChild:!1,delayDuration:0,target:(0,s.jsx)(a.zx,{onClick:()=>markBenchmarkAsVerified(),disabled:!x||h,variant:"primary",children:h?"Verified":"Mark Benchmark as Verified"})})}},362838:function(e,t,i){i.d(t,{Z:function(){return fnbind}});function fnbind(e){for(var t=arguments.length,i=Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];i.forEach(t=>{e[t]=e[t].bind(e)})}},466779:function(e,t,i){i.d(t,{$L:function(){return createProject},BF:function(){return archiveProject},L2:function(){return unarchiveProject},cx:function(){return pinProject},em:function(){return isUserAllowedInRemotasks},mW:function(){return getProjects},nN:function(){return unpinProject},ty:function(){return updateProject}});var s=i(352991),n=i(683615);async function isUserAllowedInRemotasks(e){let{context:t}=e,i=await (0,s.ZP)(t,"internal/canAccessLidar",{returnRawResponse:!0});return i&&i.ok}async function getProjects(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{context:t,cache:i=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=getFetcher(i),n=await s(t,"internal/projects",{query:e});return n.docs}async function createProject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{context:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=getFetcher(!1);return await i(t,"internal/projects",{method:"POST",body:e})}async function updateProject(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{context:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s="internal/projects/".concat(e),n=getFetcher(!1);return await n(i,s,{method:"PUT",body:t})}async function pinProject(e){let{context:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i="internal/projects/".concat(e,"/pin"),s=getFetcher(!1);return await s(t,i,{method:"PUT"})}async function unpinProject(e){let{context:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i="internal/projects/".concat(e,"/unpin"),s=getFetcher(!1);return await s(t,i,{method:"PUT"})}async function archiveProject(e){let{context:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i="internal/projects/".concat(e,"/archive"),s=getFetcher(!1);return await s(t,i,{method:"PUT"})}async function unarchiveProject(e){let{context:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i="internal/projects/".concat(e,"/unarchive"),s=getFetcher(!1);return await s(t,i,{method:"PUT"})}function getFetcher(e){return e?n.Z:s.ZP}},312993:function(e,t,i){i.d(t,{Z:function(){return TrainingPage}});var s=i(824246),n=i(674721),r=i.n(n),a=i(60042),o=i.n(a),d=i(298784),c=i.n(d),l=i(827378),p=i(792739),h=i(959807),u=i.n(h),m=i(468891),x=i(320280),b=i(120019),g=i(293030),f=i(910912),k=i(156075),j=i(416534),y=i(165168),w=i(153737),v=i(580149),T=i(43616);let padZero=e=>e<10?"0".concat(e):e,toTimeString=e=>{let t=parseInt(e,10),i=Math.floor(t/3600),s=Math.floor((t-3600*i)/60),n=t-3600*i-60*s;return"".concat(i?i+":":"").concat(s,":").concat(padZero(n))};var S=i(255146),R=i(352991),C=i(362838),A=i(731283),F=i(115125),N=i(886917),P=i(279220),I=i(599789),z=i(167469),E=i(561924),hooks_useSupplementedTrainingScenarioAssignment=e=>{let[t,i]=(0,l.useState)(),[s,n]=(0,l.useState)(),[r,a]=(0,l.useState)();(0,P.Z)(async()=>{if(!e||!e.assignmentId)return;let{assignmentId:t}=e,s=await (0,R.ZP)(null,"internal/guided_workflow/scenario/".concat(t));s&&s.enabled&&i(s.workflow)},[e]),(0,P.Z)(async()=>{if(!(null==e?void 0:e.projectId))return;let t="internal/ontology/".concat(e.projectId),i=await (0,R.ZP)(null,t);i&&(n(i.ontologyHistory),a(i.ontologyInstructions))},[e]);let o=(0,E.T)(e),d={...o,...null==e?void 0:e.featureFlags,canUseGuidedWorkflowBar:!!t},p=(0,l.useContext)(F.ZP),h=!c().includes(I.twoDTypes,null==e?void 0:e.type)&&(null==e?void 0:e.type)!==z.TaskType.DocumentTranscription&&(null==e?void 0:e.type)!==z.TaskType.TextCollection&&(null==e?void 0:e.type)!==z.TaskType.Chat&&(null==e?void 0:e.type)!==z.TaskType.ChatExperimental&&(null==e?void 0:e.type)!==z.TaskType.ChatV2,u=(0,N.h)("internal/config/".concat(null==e?void 0:e.projectId),{shouldShortCircuit:h});if(!e)return;let m={loggedUserId:null==p?void 0:p._id,taskerWorkflowDefinition:t,ontologyHistory:s,ontologyInstructions:r,config:u.response,projectConfig:u.response};return{...e,...m,featureFlags:d}},training_SupplementedTrainingScenarioAssignmentWrapper=e=>{let{assignment:t,newRenderFunction:i}=e,s=hooks_useSupplementedTrainingScenarioAssignment(t);return i(s)},_=i(433536),L=i(518496);let B=(0,_.ZL)({root:{pointerEvents:"none"},paper:{background:"none",boxShadow:"none"}});var training_TutorialHighlight=e=>{let{element:t}=e,i=t.getBoundingClientRect(),n=i.height+14,a=i.width+14,o=B();return(0,s.jsxs)(L.ZP,{elevation:9,open:!0,anchorEl:t,anchorOrigin:{vertical:"center",horizontal:"left"},transformOrigin:{vertical:"center",horizontal:"left"},classes:{root:o.root,paper:o.paper},children:[(0,s.jsxs)("div",{className:r().dynamic([["19f237689a328e28",[a,n]]])+" tutorial-highlight",children:[(0,s.jsx)("div",{className:r().dynamic([["19f237689a328e28",[a,n]]])+" tutorial-highlight-rect-container",children:(0,s.jsx)("svg",{className:r().dynamic([["19f237689a328e28",[a,n]]]),children:(0,s.jsx)("rect",{id:"box",x:"0",y:"0",width:a,height:n,className:r().dynamic([["19f237689a328e28",[a,n]]])+" tutorial-highlight-rect"})})}),(0,s.jsx)("div",{className:r().dynamic([["19f237689a328e28",[a,n]]])+" tutorial-highlight-arrow-container",children:(0,s.jsx)(p.FontAwesomeIcon,{icon:"arrow-left",style:{marginLeft:"10px",fontSize:"50px",color:k.w.ScaleBlue}})})]}),(0,s.jsx)(r(),{id:"19f237689a328e28",dynamic:[a,n],children:".tutorial-highlight.__jsx-style-dynamic-selector{z-index:99!important;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;pointer-events:none;background:none}.tutorial-highlight-rect-container.__jsx-style-dynamic-selector{width:".concat(a,"px;height:").concat(n,"px;-webkit-animation-name:pulse;-moz-animation-name:pulse;-o-animation-name:pulse;animation-name:pulse;-webkit-animation-duration:3s;-moz-animation-duration:3s;-o-animation-duration:3s;animation-duration:3s;-webkit-animation-iteration-count:infinite;-moz-animation-iteration-count:infinite;-o-animation-iteration-count:infinite;animation-iteration-count:infinite}.tutorial-highlight-rect.__jsx-style-dynamic-selector{fill:none;stroke:#0076ff;stroke-width:8;stroke-opacity:.9}@-webkit-keyframes pulse{from{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(.85);transform:scale(.85)}to{-webkit-transform:scale(1);transform:scale(1)}}@-moz-keyframes pulse{from{-moz-transform:scale(1);transform:scale(1)}50%{-moz-transform:scale(.85);transform:scale(.85)}to{-moz-transform:scale(1);transform:scale(1)}}@-o-keyframes pulse{from{-o-transform:scale(1);transform:scale(1)}50%{-o-transform:scale(.85);transform:scale(.85)}to{-o-transform:scale(1);transform:scale(1)}}@keyframes pulse{from{-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(.85);-moz-transform:scale(.85);-o-transform:scale(.85);transform:scale(.85)}to{-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1)}}")})]})},Z=i(934386),M=i(649147),D=i(138774),G=i(291786),U=i(623589),Y=i(35084),V=i(513735),O=i(160337),W=i(626199),H=i(161320),K=i.n(H),q=i(163543),Q=i(135277),$=i(556583),J=i(950743),X=i(809366),ee=i(466779),et=i(642830);async function getInitialPropsTaskerRoot(e){let{user:t,url:i}=e,s=!!e.req;return{user:t,serverRendered:s,url:i}}let getInitialProps=async e=>{let t=await getInitialPropsTaskerRoot(e),i=(e.user.trainerProject||e.user.isCorporateUser)&&e.query.show_answer,s=e.user.isCorporateUser;s||"disabled"!==e.authCache.trainingScenario.benchmark.status||et.Z.error("trainingScenario benchmark status is disabled for tasker ".concat(e.user._id,", and training scenario is ").concat(e.authCache.trainingScenario._id," and project ").concat(e.authCache.trainingScenario.project));let n=await (0,R.ZP)(e,"internal/config/".concat(e.authCache.trainingScenario.project));return{...t,...e.authCache,query:e.query,overrideAnswerKeyCooldown:i,isCorpUser:s,projectConfig:n}};var ei=i(659533),es=i(553999);let TrainingPage=class TrainingPage extends l.Component{get defaultState(){return{showingInstructions:!0,showingSummary:!1,showingLeaderboard:!0,responseIndex:0,currentTutorialStep:0,isTutorial:!1,isVerificationAttempt:!1}}get taskComponent(){return this.task.current}async waitForLoad(){for(;!this.taskComponent||!this.taskComponent.labeler;)await u().delay(500)}async componentDidMount(){var e;window.addEventListener("keydown",e=>{this.onTutorialInteraction({type:Q.TutorialStep.Shortcut,shortcutTrigger:[e.key]})}),setInterval(this.updateHighlightedElement,2e3);let t=new URLSearchParams(window.location.search),i=!!t.get("isVerificationAttempt");this.setState({isVerificationAttempt:null!=i&&i});let s=await (0,R.ZP)(null,"/internal/user-projects/practice_project_eligibility");this.setState({practiceProjectId:s.practiceProjectId}),(null===(e=this.props.trainingScenario)||void 0===e?void 0:e.benchmark.type)===I.BenchmarkType.Tutorial&&this.setState({isTutorial:!0}),this.props.submissionResponse&&(await this.waitForLoad(),this.setState({submissionResponse:this.props.submissionResponse,showingSummary:!0,showingInstructions:!1}))}canViewAnswerKey(){return this.props.overrideAnswerKeyCooldown||this.state.submissionResponse&&this.state.submissionResponse.timeSpentSecs>=this.props.trainingScenario.minimumAttemptTimeSeconds}startTraining(){if(this.taskComponent){let e=this.taskComponent.taskTimer;e.reset(0)}this.setState({showingInstructions:!1})}getSubmitDisabledStatus(){var e;let t=c().size(null===(e=this.props.trainingScenario)||void 0===e?void 0:e.tutorialSteps),{currentTutorialStep:i}=this.state;return t&&i<t?{canSubmit:!1,submitTooltip:"Follow all the steps to finish this training scenario."}:{canSubmit:!0,submitTooltip:null}}async onSubmit(e,t){let i=c().get(this.props.trainingScenario,"graderParams.version",1);if(this.props.query.edit_scenario||this.props.query.edit_answer_key){await this.submitScenarioEdit(!!this.props.query.edit_answer_key),this.setState({scenarioUpdated:!0});return}let{ready:s,submissionResponse:n}=await (0,R.ZP)(null,"internal/training/complete/".concat(this.props.trainingScenario.taskType,"/").concat(this.props.trainingAttempt)+"?".concat(m.stringify({grader_version:i})),{method:"POST",body:t}),registerSubmissionResponse=e=>{this.setState({lastSubmittedProblemZones:e.problemZonesResponse,submissionResponse:e,showingGrade:!0}),this.showSummary()};if(this.state.isTutorial&&s){let e={...n,passedBar:!0,passedAccuracyBar:!0,passedSpeedBar:!0};registerSubmissionResponse(e);return}if(s){registerSubmissionResponse(n);return}let r=setInterval(async()=>{let{submissionResponse:e,ready:t}=await (0,R.ZP)(null,"internal/training/fetch/".concat(this.props.trainingAttempt));t&&(clearInterval(r),this.state.isTutorial&&registerSubmissionResponse({...e,passedBar:!0,passedAccuracyBar:!0,passedSpeedBar:!0}),registerSubmissionResponse(e))},5e3)}onTutorialInteraction(e){var t,i,s;let{currentTutorialStep:n}=this.state,r=null===(s=this.props.trainingScenario)||void 0===s?void 0:null===(i=s.tutorialSteps)||void 0===i?void 0:null===(t=i[n])||void 0===t?void 0:t.interaction;((e,t)=>{if(e.type!==(null==t?void 0:t.type))return!1;if(e.type===Q.TutorialStep.SelectAnnotation){let{startFrame:i,endFrame:s}=t;return(!i||!(e.startFrame<i))&&(!s||!(e.endFrame>s))&&e.annotationId===t.annotationId}if(e.type===Q.TutorialStep.LidarFeature){var i,s,n;if(e.featureName!==t.featureName)return!1;if(c().isEmpty(t.featureOpts))return!0;let r=null!==(i=t.featureOpts)&&void 0!==i?i:{},a=r.threshold,o=r.value,d=null!==(s=e.featureOpts)&&void 0!==s?s:{},l=d.value;return(!r.subFeature||r.subFeature===d.subFeature)&&(c().isFinite(a)&&c().isFinite(o)?!!c().isFinite(l)&&Math.abs(o-l)<=a:!!c().isNil(o)||o===(null===(n=e.featureOpts)||void 0===n?void 0:n.value))}return c().isEqual(e,t)})(e,r)&&this.setState({currentTutorialStep:n+1})}retryTraining(){var e,t;let i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if((null===(e=this.props.trainingScenario)||void 0===e?void 0:e.taskType)===z.TaskType.LidarAnnotation){let e=new URL(window.location.href);!0===i?e.searchParams.set("retry","1"):e.searchParams.delete("retry"),window.location.href=e.href}else(null===(t=this.taskComponent)||void 0===t?void 0:t.discardChanges)&&this.taskComponent.discardChanges(),window.location.reload()}makeChanges(){if(this.taskComponent){let e=this.taskComponent.taskTimer,t=1e3*this.state.submissionResponse.timeSpentSecs;e.reset(t),this.taskComponent.resetSubmit()}this.hideSummary()}exit(){(0,S.ZP)(null,"/dashboard")}get includeInitialResponse(){var e,t;let{user:i,query:s}=this.props;return i.isCorporateUser&&(null==s?void 0:s.view_initial_response)&&(null===(t=this.props.trainingScenario)||void 0===t?void 0:null===(e=t.params)||void 0===e?void 0:e.initialScene)}get responsesReady(){return!!this.state.submissionResponse}get initialTrainingScenarioSubtask(){var e,t,i;return(null===(e=this.props.query)||void 0===e?void 0:e.view_initial_response)?null===(i=this.props.trainingScenario)||void 0===i?void 0:null===(t=i.params)||void 0===t?void 0:t.initialScene:void 0}get scenesToLoad(){return[this.props.trainingAttempt,this.initialTrainingScenarioSubtask].filter(e=>!!e)}render2DScenarioHeader(){let e=this.props.user.accountType===I.AccountType.Expert;return(0,s.jsxs)("div",{className:"jsx-695fe4a0b9e08858 training-header",children:[(0,s.jsxs)("div",{className:"jsx-695fe4a0b9e08858 training-header__meta",children:[(0,s.jsx)("span",{className:"jsx-695fe4a0b9e08858 training-header__title",children:(0,s.jsx)("strong",{className:"jsx-695fe4a0b9e08858",children:this.props.trainingScenario.name})}),(0,s.jsx)("span",{className:"jsx-695fe4a0b9e08858 training-header__subtitle",children:(0,s.jsx)("strong",{className:"jsx-695fe4a0b9e08858",children:this.props.trainingScenario.description})})]}),(0,s.jsx)("div",{className:"jsx-695fe4a0b9e08858 training-header__subtitle",children:!0!==this.props.hideBackButton&&(0,s.jsxs)(f.Z,{type:"link",onClick:this.props.toggleShowingFeedback,style:{color:"rgba(0,0,0,0.4)",marginLeft:"8px",marginTop:"8px"},href:e?"/expert":"/dashboard",children:[(0,s.jsx)(p.FontAwesomeIcon,{icon:"chevron-left"}),"\xa0 Back To Dashboard"]})}),(0,s.jsx)(r(),{id:"695fe4a0b9e08858",children:"@media screen and (max-width:768px){.training-header.jsx-695fe4a0b9e08858{z-index:1;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;padding:16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:1px solid rgba(0,0,0,.1);-webkit-box-shadow:0px 0px 8px rgba(0,0,0,.05);-moz-box-shadow:0px 0px 8px rgba(0,0,0,.05);box-shadow:0px 0px 8px rgba(0,0,0,.05);background:white;color:black;font-size:15px}.training-header__meta.jsx-695fe4a0b9e08858 span.jsx-695fe4a0b9e08858{padding-right:16px}.training-header__title.jsx-695fe4a0b9e08858{font-size:20px}.training-header__subtitle.jsx-695fe4a0b9e08858{color:rgba(0,0,0,.4)}}"})]})}renderLeaderboard(){if(this.props.leaderboard)return(0,s.jsxs)("div",{className:"jsx-4324743f279bcd63 "+(o()("leaderboard",{hidden:!this.state.showingLeaderboard})||""),children:[(0,s.jsxs)("div",{className:"jsx-4324743f279bcd63 leaderboard-header",children:["\uD83C\uDFC6 ",this.props.trainingScenario.name," Leaderboard"]}),(0,s.jsx)("div",{className:"jsx-4324743f279bcd63 leaderboard-list",children:this.props.leaderboard.length?this.props.leaderboard.map((e,t)=>(0,s.jsxs)("div",{className:"jsx-4324743f279bcd63 leaderboard-item",children:[(0,s.jsxs)("div",{className:"jsx-4324743f279bcd63",children:[(0,s.jsx)("span",{className:"jsx-4324743f279bcd63 ranking",children:t+1})," ",e.worker]}),(0,s.jsx)("span",{className:"jsx-4324743f279bcd63",children:"speed"===this.props.trainingScenario.trainingType?toTimeString(e.score):"".concat(Math.floor(100*e.score),"%")})]},t)):(0,s.jsx)("div",{className:"jsx-4324743f279bcd63 leaderboard-item",children:"No training scores yet"})}),(0,s.jsx)("div",{className:"jsx-4324743f279bcd63 leaderboard-close",children:(0,s.jsx)("a",{onClick:this.hideLeaderboard,className:"jsx-4324743f279bcd63 btn-flat",children:"Hide"})}),(0,s.jsx)(r(),{id:"4324743f279bcd63",children:".leaderboard.jsx-4324743f279bcd63{-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);padding:12px 16px;background:rgba(255,255,255,.9);color:black;font-weight:bold;font-size:13px;-webkit-transition:top.5s ease-in-out;-moz-transition:top.5s ease-in-out;-o-transition:top.5s ease-in-out;transition:top.5s ease-in-out;position:absolute;top:0;pointer-events:auto}.leaderboard.hidden.jsx-4324743f279bcd63{top:-360px}.leaderboard-list.jsx-4324743f279bcd63{margin-top:16px}.leaderboard-item.jsx-4324743f279bcd63 .ranking.jsx-4324743f279bcd63{display:inline-block;width:16px}.leaderboard-item.jsx-4324743f279bcd63{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.leaderboard-close.jsx-4324743f279bcd63{margin-top:8px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-moz-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.leaderboard-close.jsx-4324743f279bcd63 .btn-flat.jsx-4324743f279bcd63{background:rgba(0,0,0,0);-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;overflow:hidden;padding:.5em;-webkit-transition:background.3s ease-in-out;-moz-transition:background.3s ease-in-out;-o-transition:background.3s ease-in-out;transition:background.3s ease-in-out}.leaderboard-close.jsx-4324743f279bcd63 .btn-flat.jsx-4324743f279bcd63:hover{background:rgba(0,0,0,.08)}.leaderboard-close.jsx-4324743f279bcd63 .btn-flat.jsx-4324743f279bcd63:not(:first-of-type){margin-left:.5em}"})]})}renderScenarioUpdated(){if(this.state.scenarioUpdated)return(0,s.jsxs)(y.u_,{isOpen:!0,children:[(0,s.jsx)("div",{className:"jsx-504828f3394fd24e section",children:'"Scenario updated!"'}),(0,s.jsx)(r(),{id:"504828f3394fd24e",children:".section.jsx-504828f3394fd24e{padding:32px}.section.jsx-504828f3394fd24e+.section.jsx-504828f3394fd24e{border-top:1px solid var(--bg-gray-light)}"})]})}renderTutorialHighlight(){if(this.state.highlightedElement)return(0,s.jsx)(training_TutorialHighlight,{element:this.state.highlightedElement})}renderTutorialProgress(){var e,t,i,n;let a=c().size(null===(e=this.props.trainingScenario)||void 0===e?void 0:e.tutorialSteps);if(!a||this.state.showingInstructions)return;let{currentTutorialStep:o}=this.state,d=null===(i=this.props.trainingScenario)||void 0===i?void 0:null===(t=i.tutorialSteps)||void 0===t?void 0:t[o],l=null!==(n=null==d?void 0:d.instructions)&&void 0!==n?n:"All done! Once you have fixed these errors, submit your scenario.",p=(null==d?void 0:d.allowContinue)||(null==d?void 0:d.type)===Q.TutorialStep.Text?(0,s.jsx)("p",{style:{textDecoration:"underline",color:"white",cursor:"pointer"},onClick:()=>this.setState({currentTutorialStep:this.state.currentTutorialStep+1}),children:"Click here to continue"}):null;return(0,s.jsxs)("div",{className:"jsx-e3cb8d9f95dad905 tutorial-progress-container",children:[(0,s.jsxs)("div",{className:"jsx-e3cb8d9f95dad905 tutorial-progress-text",children:[(0,s.jsxs)("h3",{className:"jsx-e3cb8d9f95dad905",children:["(",o+1,"/",a+1,") ",l]}),p]}),(0,s.jsx)("div",{className:"jsx-e3cb8d9f95dad905 progress-bar-container",children:(0,s.jsx)("div",{className:"jsx-e3cb8d9f95dad905 progress-bar",children:(0,s.jsx)(A.ZP,{completed:o,total:a,height:25,fillColor:"#2ecc71",backgroundColor:"#c4e5d2"})})}),(0,s.jsx)(r(),{id:"e3cb8d9f95dad905",children:".tutorial-progress-container.jsx-e3cb8d9f95dad905{pointer-events:none;position:fixed;top:100px;left:50%;-webkit-transform:translatex(-50%);-moz-transform:translatex(-50%);-ms-transform:translatex(-50%);-o-transform:translatex(-50%);transform:translatex(-50%);z-index:99!important}.tutorial-progress-text.jsx-e3cb8d9f95dad905{pointer-events:auto;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;min-width:300px;text-align:center;background-color:rgba(0,0,0,.5);-webkit-border-radius:16px;-moz-border-radius:16px;border-radius:16px}h3.jsx-e3cb8d9f95dad905{color:white;margin:8px}.progress-bar-container.jsx-e3cb8d9f95dad905{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;text-align:center;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;margin-top:20px}.progress-bar.jsx-e3cb8d9f95dad905{width:250px;display:inline-block;margin-left:auto;margin-right:auto}"})]})}renderTaskPage(){var e,t,i;let n;let{query:r,trainingScenario:a,projectConfig:o}=this.props;if(!a||!a.params)return;c().get(this.state,"submissionResponse.processedResponse")?n=c().get(this.state,"submissionResponse.processedResponse"):c().get(r,"edit_answer_key")?n=a.expectedResponse:a.benchmark.type===I.BenchmarkType.Tutorial&&a.benchmark.tutorialMode===es.BenchmarkTutorialMode.Instructor?n=a.expectedResponse:a.taskType===z.TaskType.Chat&&a.benchmark.isAttempterBenchmark||(n=a.initialResponse);let d={trainingScenario:a,isTestQuestion:!0,config:this.props.config,projectConfig:o,showHeader:!1,showFooter:!0,isTrainingFeedbackOpen:this.state.showingSummary,onSubmit:this.onSubmit,getSubmitDisabledStatus:this.getSubmitDisabledStatus,onRetryTraining:this.retryTraining,closeTrainingFeedback:this.hideSummary,trainingResponse:this.state.submissionResponse,fixResponse:n,instruction:a.instructions,instructionObjectId:a.instructionObjectId,userFlags:this.props.user.featureFlags,loggedUserId:this.props.user.id,useProtectedText:a.useProtectedText,isSimultaneousEditing:!!r.edit_diff,ocrTextUrls:this.getOCRTextUrls(null!==(t=a.attachmentS3Downloads)&&void 0!==t?t:[]),courseVersion:this.props.courseVersion,hideHeader:this.props.hideHeader,trainingAttemptId:this.props.trainingAttempt};(0,W.Hz)(a);let l=this.transformToAssignment(a,n);l&&a&&a.expectedResponse&&a.tutorialResponse&&a.benchmark.type===I.BenchmarkType.Tutorial&&(l.expectedResponse=a.expectedResponse,l.tutorialResponse=a.tutorialResponse,l.isTutorialBenchmark=!0,l.isVerificationAttempt=!0,l.tutorialMode||(l.tutorialMode=null!==(i=a.tutorialMode)&&void 0!==i?i:a.benchmark.tutorialMode));let h=r.overrideReviewLevel||r.reviewLevel;if(l&&h){let e=parseInt(h);isNaN(e)||(l.overrideReviewLevel=e)}let u="string"==typeof a.project?a.project:null===(e=a.project)||void 0===e?void 0:e._id;return(0,s.jsxs)(s.Fragment,{children:[this.props.courseVersion===I.CourseVersion.V2&&!c().isNil(u)&&(0,s.jsx)("div",{className:"pr-1",children:(0,s.jsx)(j.zx,{variant:"white",onClick:()=>{let e="/expert/instruction/".concat(u),t=window.location.origin+e;(null==l?void 0:l.assignmentId)&&(t+="?assignmentId=".concat(l.assignmentId)),window.open(t,"_blank")},children:(0,s.jsx)(p.FontAwesomeIcon,{size:"sm",icon:"books"})})}),(0,s.jsx)(training_SupplementedTrainingScenarioAssignmentWrapper,{assignment:l,newRenderFunction:e=>{switch(e.type){case z.TaskType.AudioTranscription:return(0,s.jsx)(w.Gi,{ref:this.task,...d,...a});case z.TaskType.Categorization:if(a.params.taxonomies)return(0,s.jsx)(w.kq,{ref:this.task,...d,...a,examAttemptId:a.params.attachment_type===I.AttachmentType.JSON&&this.props.trainingAttempt},a._id);return(0,s.jsx)(w.LO,{ref:this.task,...d,...a});case z.TaskType.Comparison:return(0,s.jsx)(w.FS,{ref:this.task,...d,...a});case z.TaskType.DataCollection:return(0,s.jsx)(w.kv,{ref:this.task,...d,...a});case z.TaskType.ImageAnnotation:case z.TaskType.PointAnnotation:case z.TaskType.LineAnnotation:case z.TaskType.Annotation:case z.TaskType.CuboidAnnotation:case z.TaskType.PolygonAnnotation:return(0,s.jsx)(V.M5,{children:(0,s.jsx)(w.B,{ref:this.task,...d,...a,assignment:e})});case z.TaskType.SegmentAnnotation:return(0,s.jsx)(w.lb,{ref:this.task,...d,...a,assignment:e});case z.TaskType.Transcription:return(0,s.jsx)(w._N,{ref:this.task,...d,...a});case z.TaskType.VideoAnnotation:case z.TaskType.VideoBoxAnnotation:case z.TaskType.VideoCuboidAnnotation:case z.TaskType.VideoPolygonAnnotation:return(0,s.jsx)(V.M5,{children:(0,s.jsx)(w.xe,{ref:this.task,...d,...a,assignment:e},a._id)});case z.TaskType.VideoPlaybackAnnotation:return(0,s.jsx)(w.sE,{ref:this.task,...d,...a,assignment:e});case z.TaskType.LidarAnnotation:case z.TaskType.LidarSegmentation:case z.TaskType.SensorFusion:return(0,s.jsx)(en,{trainingAttemptId:this.props.trainingAttempt});case z.TaskType.NamedEntityRecognition:return(0,s.jsx)(w.bs,{ref:this.task,...d,...a},a._id);case z.TaskType.TextCollection:if(a.params.externalAmsLink)return(0,s.jsx)(w.fT,{ref:this.task,...d,...a,assignment:e},a._id);return(0,s.jsx)(w.JO,{ref:this.task,...d,...a,assignment:e,tasker:this.props.user},a._id);case z.TaskType.DocumentTranscription:return(0,s.jsx)(w.QH,{ref:this.task,...d,...a,assignment:e});case z.TaskType.Chat:return(0,s.jsx)(w.JL,{ref:this.task,...d,...a,assignment:e});case z.TaskType.ChatExperimental:case z.TaskType.ChatV2:return(0,s.jsx)(w.bb,{ref:this.task,...d,...a,assignment:e})}return null}})]})}renderChatFeedback(){if(!this.state.showingSummary)return null;if(this.state.showingSummary&&this.state.isTutorial&&!this.state.isVerificationAttempt){var e,t;this.props.onFeedbackCloseLoading||null===(e=(t=this.props).onFeedbackClose)||void 0===e||e.call(t);return}let i=[{name:O.DiffView.TaskerResponse,response:c().get(this.state,"submissionResponse.processedResponse"),graderResponse:this.state.submissionResponse.graderResponse,graderParams:this.props.trainingScenario.graderParams}];return(0,s.jsx)(D.Z,{makeChanges:this.props.simpleFeedbackModalClosing?this.makeChanges:this.hideSummary,trainingScenario:this.props.trainingScenario,trainingAttempt:this.props.trainingAttempt,submissionResponse:this.state.submissionResponse,retryTraining:this.retryTraining,responses:i,isCorpUser:this.props.isCorpUser,diffingResponse:this.state.lastSubmittedProblemZones,config:this.props.config,simpleFeedbackModalClosing:this.props.simpleFeedbackModalClosing,practiceProjectId:this.state.practiceProjectId})}render2DFeedback(){var e;if(!this.state.showingSummary)return null;let t=this.canViewAnswerKey(),i=[{name:O.DiffView.TaskerResponse,response:c().get(this.state,"submissionResponse.processedResponse"),graderResponse:t?this.state.submissionResponse.graderResponse:null,graderParams:t?this.props.trainingScenario.graderParams:null},{name:O.DiffView.AnswerKey,response:this.state.submissionResponse.closestExpectedResponse||this.props.trainingScenario.expectedResponse,graderResponse:this.state.submissionResponse.graderResponse,graderParams:this.props.trainingScenario.graderParams,isAnswerKey:!0}],n=null===(e=this.state.submissionResponse)||void 0===e?void 0:e.visualDiff;return n&&i.unshift({name:O.DiffView.VisualDiff,response:n,graderResponse:t?this.state.submissionResponse.graderResponse:null,graderParams:t?this.props.trainingScenario.graderParams:null}),(0,s.jsx)(M.Z,{makeChanges:this.props.simpleFeedbackModalClosing?this.makeChanges:this.hideSummary,trainingScenario:this.props.trainingScenario,trainingAttempt:this.props.trainingAttempt,submissionResponse:this.state.submissionResponse,retryTraining:this.retryTraining,responses:i,allowedToSeeAnswerKey:t,isCorpUser:this.props.isCorpUser,diffingResponse:this.state.lastSubmittedProblemZones,config:this.props.config,simpleFeedbackModalClosing:this.props.simpleFeedbackModalClosing})}renderNERFeedback(){if(!this.state.showingSummary)return null;let e=this.canViewAnswerKey(),t=this.state.submissionResponse,i=[{name:O.DiffView.TaskerResponse,response:t&&t.processedResponse,graderResponse:e?t.graderResponse:null,graderParams:e?this.props.trainingScenario.graderParams:null},{name:O.DiffView.AnswerKey,response:this.state.submissionResponse.closestExpectedResponse||this.props.trainingScenario.expectedResponse,graderResponse:this.state.submissionResponse.graderResponse,graderParams:this.props.trainingScenario.graderParams,isAnswerKey:!0}];return(0,s.jsx)(G.Z,{makeChanges:this.props.simpleFeedbackModalClosing?this.makeChanges:this.hideSummary,name:this.props.name,showingGrade:this.state.showingGrade,trainingScenario:this.props.trainingScenario,submissionResponse:this.state.submissionResponse,retryTraining:this.retryTraining,responses:i,allowedToSeeAnswerKey:e,diffingResponse:this.state.lastSubmittedProblemZones,isCorpUser:this.props.isCorpUser,trainingAttempt:this.props.trainingAttempt,backToQueue:()=>{},simpleFeedbackModalClosing:this.props.simpleFeedbackModalClosing})}renderTextCollectionFeedback(){var e;if(!this.state.showingSummary)return null;let t=this.canViewAnswerKey(),i=this.state.submissionResponse,n=[{name:O.DiffView.TaskerResponse,response:i&&i.processedResponse,isAnswerKey:!1},{name:O.DiffView.AnswerKey,response:this.state.submissionResponse.closestExpectedResponse||this.props.trainingScenario.expectedResponse,isAnswerKey:!0}];return(0,s.jsx)(U.Z,{makeChanges:this.props.simpleFeedbackModalClosing?this.makeChanges:this.hideSummary,name:this.props.name,showingGrade:this.state.showingGrade,trainingScenario:this.props.trainingScenario,submissionResponse:this.state.submissionResponse,retryTraining:this.retryTraining,responses:n,allowedToSeeAnswerKey:t,diffingResponse:this.state.lastSubmittedProblemZones,isCorpUser:this.props.isCorpUser,trainingAttempt:this.props.trainingAttempt,backToQueue:()=>{},loggedUserId:this.props.user.id,useProtectedText:this.props.trainingScenario.useProtectedText,project:null===(e=this.props.trainingScenario)||void 0===e?void 0:e.project,simpleFeedbackModalClosing:this.props.simpleFeedbackModalClosing})}renderDocumentTranscriptionFeedback(){var e,t,i;if(!this.state.showingSummary)return null;let n=this.canViewAnswerKey(),r=[{name:O.DiffView.TaskerResponse,response:null===(e=this.state.submissionResponse)||void 0===e?void 0:e.processedResponse,graderResponse:n?this.state.submissionResponse.graderResponse:null,graderParams:n?this.props.trainingScenario.graderParams:null},{name:O.DiffView.AnswerKey,response:this.state.submissionResponse.closestExpectedResponse||this.props.trainingScenario.expectedResponse,graderResponse:this.state.submissionResponse.graderResponse,graderParams:this.props.trainingScenario.graderParams,isAnswerKey:!0}],a=null===(t=this.state.submissionResponse)||void 0===t?void 0:t.visualDiff;return a&&r.unshift({name:O.DiffView.VisualDiff,response:a,graderResponse:n?this.state.submissionResponse.graderResponse:null,graderParams:n?this.props.trainingScenario.graderParams:null}),(0,s.jsx)(Y.Z,{makeChanges:this.props.simpleFeedbackModalClosing?this.makeChanges:this.hideSummary,trainingScenario:this.props.trainingScenario,trainingAttempt:this.props.trainingAttempt,submissionResponse:this.state.submissionResponse,retryTraining:this.retryTraining,responses:r,allowedToSeeAnswerKey:n,isCorpUser:this.props.isCorpUser,diffingResponse:null!==(i=this.state.lastSubmittedProblemZones)&&void 0!==i?i:[],simpleFeedbackModalClosing:this.props.simpleFeedbackModalClosing})}renderWithWrapper(e){return(0,s.jsx)(x.ag,{children:(0,s.jsxs)("div",{className:"jsx-edaa971672f78f0a tasks__container scaler flex-column h-100",children:[window.location.pathname.includes("/expert")?(0,s.jsx)(X.Z,{title:"Training"}):(0,s.jsx)(v.Z,{title:"Instruction"}),(0,s.jsx)(b.Z,{}),(0,s.jsx)(k.Z,{}),(0,s.jsx)(T.Z,{}),(0,s.jsx)(l.Suspense,{fallback:(0,s.jsx)(g.Z,{}),children:e}),(0,s.jsx)(r(),{id:"edaa971672f78f0a",children:".flex-column.jsx-edaa971672f78f0a{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.h-100.jsx-edaa971672f78f0a{height:100vh}"})]})})}renderThrottlePage(){return this.renderWithWrapper((0,s.jsxs)("div",{style:{marginLeft:"25%",marginRight:"25%",marginTop:"10%",textAlign:"center"},children:[(0,s.jsx)("h2",{children:"Better luck next time"}),(0,s.jsx)("p",{children:"Unfortunately, you've run out of attempts for this scenario!"}),(0,s.jsxs)("p",{children:["You can try again in ",(0,s.jsx)("b",{children:K().duration(this.props.throttleTimeMs).humanize()})]}),(0,s.jsxs)("p",{children:["In the mean time, head on back to the"," ",(0,s.jsx)(q.ZP,{href:"/onboarding-center",children:(0,s.jsx)("a",{href:"/onboarding-center",children:"onboarding center"})}),"!"]})]}))}render(){if(!this.props.trainingScenario)return;let e=this.props.trainingScenario.taskType===z.TaskType.LidarAnnotation||this.props.trainingScenario.taskType===z.TaskType.LidarSegmentation||this.props.trainingScenario.taskType===z.TaskType.SensorFusion;if(e)return(0,s.jsx)(en,{trainingAttemptId:this.props.trainingAttempt});let[t,i]=this.getFeedbackComponents();return c().isFinite(this.props.throttleTimeMs)?this.renderThrottlePage():this.renderWithWrapper((0,s.jsxs)(s.Fragment,{children:[t,this.renderTutorialProgress(),this.renderTutorialHighlight(),this.renderTaskPage(),(0,s.jsx)(Z.Z,{showingInstructions:this.state.showingInstructions,trainingScenario:this.props.trainingScenario,startTraining:this.startTraining}),i,this.renderScenarioUpdated()]}))}constructor(e,t){super(e,t),this.updateHighlightedElement=()=>{var e,t,i,s,n;let{currentTutorialStep:r}=this.state,a=null===(i=this.props.trainingScenario)||void 0===i?void 0:null===(t=i.tutorialSteps)||void 0===t?void 0:null===(e=t[r])||void 0===e?void 0:e.highlightCSSClass,o=a&&(null!==(n=null!==(s=document.getElementsByClassName(a)[0])&&void 0!==s?s:document.getElementById(a))&&void 0!==n?n:document.querySelector(a));o!==this.state.highlightedElement&&this.setState({highlightedElement:o})},this.showLeaderboard=()=>this.setState({showingLeaderboard:!0}),this.hideLeaderboard=()=>this.setState({showingLeaderboard:!1}),this.showSummary=()=>this.setState({showingSummary:!0}),this.hideSummary=()=>this.setState({showingSummary:!1}),this.submitScenarioEdit=async e=>{let t={type:this.props.trainingScenario.taskType};await (0,R.ZP)(null,"internal/training/update/".concat(this.props.trainingScenario._id),{method:"POST",query:{...e?{isAnswerKey:1}:{}},body:t})},this.getOCRTextUrls=(0,$.default)(e=>c().compact(e.map(e=>e.ocrTextUrl))),this.transformToAssignment=(0,$.default)(J.Z),this.getFeedbackComponents=()=>{let e=this.props.trainingScenario.taskType;return e===z.TaskType.NamedEntityRecognition?[this.render2DScenarioHeader(),this.renderNERFeedback()]:e===z.TaskType.TextCollection?[this.render2DScenarioHeader(),this.renderTextCollectionFeedback()]:e===z.TaskType.DocumentTranscription?[this.render2DScenarioHeader(),this.renderDocumentTranscriptionFeedback()]:e===z.TaskType.Chat||e===z.TaskType.ChatExperimental||e===z.TaskType.ChatV2?[this.render2DScenarioHeader(),this.renderChatFeedback()]:[this.render2DScenarioHeader(),this.render2DFeedback()]},(0,C.Z)(this,"onSubmit","startTraining","retryTraining","waitForLoad","makeChanges","renderWithWrapper","onTutorialInteraction","getSubmitDisabledStatus","updateHighlightedElement","exit"),this.task=l.createRef(),this.state={showingInstructions:!0,showingSummary:!1,showingLeaderboard:!0,responseIndex:0,currentTutorialStep:0,isTutorial:!1,isVerificationAttempt:!1}}};TrainingPage.getPageConfig=()=>({user:{authorize:async e=>{let t;let{query:{trainingId:i,attemptId:s,edit_scenario:n,edit_answer_key:r,edit_diff:a,retry:o,view_initial_response:d},user:c}=e,l=!!c.trainerProject;if(!i&&!s)return[!1];if(s)t=await (0,R.ZP)(e,"internal/training/view/".concat(s),{query:d?{with_initial_cuboids:1}:{}});else if((n||r||a)&&l){let s=await (0,R.ZP)(e,"internal/training/edit/".concat(i));t={...s,trainingAttempt:a?s.trainingScenario._id:s.trainingScenario.params[r?"answerScene":"initialScene"]}}else t=await (0,R.ZP)(e,"internal/training/begin/".concat(i).concat(o?"?retry=1":""));let p=!t||!(0,I.isTaskTypeLidar)(z.TaskType[t.trainingScenario.taskType])||await (0,ee.em)({context:e});return{success:p,cache:t}},kinds:["worker","expert"],required:!0}}),TrainingPage.getInitialProps=getInitialProps;let en=l.memo(function(e){return l.useEffect(()=>{let t=new URLSearchParams(window.location.search),i=Object.fromEntries(t.entries()),s={sceneId:e.trainingAttemptId};i.spoof&&(s.spoof=i.spoof),window.location.href=(0,ei.vI)(s)},[e.trainingAttemptId]),(0,s.jsx)("p",{children:"Loading LidarLite..."})})}}]);