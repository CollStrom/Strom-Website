(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[89502],{555216:function(e,t,r){"use strict";var s=r(824246),i=r(713222),n=r(138944),__rest=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)0>t.indexOf(s[i])&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(r[s[i]]=e[s[i]]);return r};t.Z=e=>{var{className:t,size:r="lg"}=e,a=__rest(e,["className","size"]);return(0,s.jsxs)("button",Object.assign({className:(0,n.default)("scaleui scale-tailwind rounded-full border-0 bg-neutral-700 hover:bg-neutral-800 text-neutral-0 flex justify-center items-center",t),type:"button"},a,{children:[(0,s.jsx)(i.J,{icon:["far","question-circle"],size:r,variant:"white"}),(0,s.jsx)("div",{className:"transition-all max-w-xs py-2 pr-2 overflow-hidden whitespace-nowrap font-medium",children:"Need Help?"})]}))}},811508:function(e,t,r){"use strict";r.d(t,{Z:function(){return ZendeskDynamicFormWithHelpCenter},E:function(){return k}});var s=r(824246),i=r(827378),n=r(792739),a=r(722030),l=r(416534),o=r(713222),u=r(810852),d=r(43755),c=r(423973),f=r(940048),p=r(924501),h=r(527565),m=r(298784),v=r.n(m),b=r(167469),g=r(428907),y=r(594802),x=r(412937),j=r(339389),D=r(926263),N=r(60042),w=r.n(N),support_ZendeskFileUpload=({className:e,file:t,onFileChanged:r,disabled:n,isSuccess:a})=>{let[l,u]=(0,i.useState)(),d=(0,i.useCallback)((e,t)=>(r(void 0),t.length>1)?u("Please upload only one file"):t.length?u("Unsupported format"):void(u(void 0),r(e[0])),[r]),{getRootProps:c,getInputProps:f,isDragActive:p}=(0,D.useDropzone)({onDrop:d,multiple:!1,accept:"audio/*,video/*,image/*,text/*,.pdf,.json",disabled:n}),h=(0,i.useCallback)(e=>{e.stopPropagation(),r(void 0)},[r]);return(0,s.jsxs)("div",{className:e,children:[(0,s.jsx)("label",{htmlFor:"support-attachment",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Attachments (optional)"}),(0,s.jsx)("p",{className:"text-sm text-neutral-500 my-1",children:"Upload a screenshot of the issue youâ€™re having, so we can help you resolve your issue faster."}),(0,s.jsxs)("div",Object.assign({className:w()("border-2 border-dashed border-neutral-200 bg-neutral-100 rounded w-full p-2 flex gap-2 items-center justify-center cursor-pointer",!n&&"hover:bg-neutral-50")},c(),{children:[(0,s.jsx)("input",Object.assign({id:"support-attachment"},f())),(0,s.jsx)(o.J,{variant:a&&!p?"success":"neutral",className:"[&_svg]:text-xl",icon:p||!t?"file-import":"file-check"}),p?(0,s.jsx)("p",{className:"text-sm font-medium text-neutral-700",children:"Drop"}):t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-neutral-700",children:t.name}),(0,s.jsx)(o.J,{icon:"plus",size:"sm",className:w()("rotate-45 ml-auto",n&&"pointer-events-none"),onClick:h})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-neutral-700",children:"Drag or Upload a file"}),l&&(0,s.jsx)("p",{className:"mt-4 text-danger-500",children:l})]})]}))]})},TaxonomySelectMenus=({issue:e,subIssue:t,subSubIssue:r,setIssue:i,setSubIssue:n,setSubSubIssue:a,issueOptions:l,subIssueOptions:o,subSubIssueOptions:u})=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.S,{label:"What do you need help with?",options:l,selectedOptionId:e,setSelected:e=>{i(e),n(""),a("")},renderValue:e=>e||"Select an option...",labelClassName:"font-light text-xs",className:"mb-2"}),e&&(0,s.jsx)(x.S,{label:`${e} Issue Type`,options:o,selectedOptionId:t,setSelected:e=>{n(e),a("")},renderValue:e=>e||"Select an option...",labelClassName:"font-light text-xs",className:"mb-2"}),t&&!v().isEmpty(u)&&(0,s.jsx)(x.S,{label:`${t} Issue Type`,options:u,selectedOptionId:r,setSelected:e=>{a(e)},renderValue:e=>e||"Select an option...",labelClassName:"font-light text-xs",className:"mb-2"})]});let ZendeskTextField=({field:e,value:t,setFieldData:r,title:i})=>(0,s.jsx)("div",{children:(0,s.jsx)(y.n,{id:`zendesk-textfield-${e.id}`,label:i,description:e.description,value:t,onChange:t=>{r(e.id,t.target.value)}})}),ZendeskTaggerField=({title:e,field:t,value:r,setFieldData:i})=>{let n=t.custom_field_options.map(e=>({id:e.value,name:e.name}));return(0,s.jsx)("div",{children:(0,s.jsx)(x.S,{label:e,helperText:t.description,options:n,selectedOptionId:r,setSelected:e=>{i(t.id,e)},renderValue:e=>e?n.find(t=>t.id===e).name:"Select an option..."})})},ZendeskField=({title:e,field:t,value:r,setFieldData:i})=>{var n;let a=null!=e?e:`${null!==(n=t.title_in_portal)&&void 0!==n?n:t.title}${t.required?"":" (optional)"}`;return(0,s.jsxs)("div",{children:["text"===t.type&&(0,s.jsx)(ZendeskTextField,{field:t,value:r,setFieldData:i,title:a}),"tagger"===t.type&&(0,s.jsx)(ZendeskTaggerField,{field:t,value:r,setFieldData:i,title:a})]})};var ZendeskSupportTicketBody=({issue:e,subIssue:t,subSubIssue:r,setIssue:i,setSubIssue:n,setSubSubIssue:a,issueOptions:l,subIssueOptions:o,subSubIssueOptions:u,displayedFields:d,description:c,setDescription:f,hasDescriptionError:p,file:h,handleFileChanged:m,isFileLoading:v,fileToken:g,fieldData:y,handleSetFieldValue:x})=>(0,s.jsxs)("div",{className:"flex flex-col bg-neutral-0 gap-2 bg-neutral-0 relative p-4",children:[(0,s.jsx)(TaxonomySelectMenus,{issue:e,subIssue:t,subSubIssue:r,setIssue:i,setSubIssue:n,setSubSubIssue:a,issueOptions:l,subIssueOptions:o,subSubIssueOptions:u}),d.map(e=>e.id!==b.NEW_TAXONOMY_FIELD_ID&&(0,s.jsx)(ZendeskField,{field:e,value:y[e.id],setFieldData:x},e.id)),(0,s.jsx)(j.K,{id:"zendesk-textarea-description",label:"Description",value:c,onChange:e=>{f(e.target.value)},error:p,description:p?`${c.length}/400`:void 0}),(0,s.jsx)(support_ZendeskFileUpload,{className:"mt-4",file:h,onFileChanged:m,disabled:v,isSuccess:!!g})]}),O=r(462252),S=r(824385),support_ZendeskHelpCenterBody=({userId:e,onContactSupport:t,issue:r,subIssue:n,subSubIssue:a,setIssue:u,setSubIssue:d,setSubSubIssue:c,issueOptions:f,subIssueOptions:p,subSubIssueOptions:h,helpCenterArticles:m,logEvent:v})=>{var g;let y=(0,O.O)(!0),x=null!==(g=y.data)&&void 0!==g?g:"";return(0,i.useEffect)(()=>{m.map(t=>{v&&v(S.Event.HelpCenterArticleViewEvent,{userId:e,articleUrl:b.ARTICLE_NAME_MAPPING[t],articleDisplayName:t,issue:r,subIssue:n,subSubIssue:a})})},[m,v,e,r,n,a]),(0,s.jsxs)("div",{className:"flex flex-col gap-2 bg-neutral-0 relative p-4 h-[27.5rem]",children:[(0,s.jsx)(TaxonomySelectMenus,{issue:r,subIssue:n,subSubIssue:a,setIssue:u,setSubIssue:d,setSubSubIssue:c,issueOptions:f,subIssueOptions:p,subSubIssueOptions:h}),m.length>0&&(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsx)("div",{className:"font-medium text-sm leading-6",children:"Here's a few articles we found related to that topic:"}),m.map(t=>(0,s.jsx)("div",{className:"pt-4 flex items-center text-primary-400",onClick:()=>{k.invalidateQueries(["zendesk-login-and-redirect-prefix"]),v&&v(S.Event.HelpCenterArticleClickEvent,{userId:e,articleUrl:b.ARTICLE_NAME_MAPPING[t],articleDisplayName:t,issue:r,subIssue:n,subSubIssue:a})},children:(0,s.jsxs)("a",{target:"_blank",rel:"noopener noreferrer",href:b.NOT_ZENDESK_HELP_ARTICLES.includes(t)?`${b.ARTICLE_NAME_MAPPING[t]}`:`${x}${b.ARTICLE_NAME_MAPPING[t]}`,className:"w-full flex",children:[(0,s.jsx)("div",{className:"underline underline-offset-4",children:t}),(0,s.jsx)(o.J,{icon:"up-right-from-square",className:"w-5 h-5 pl-3",iconClassName:"text-primary-400"})]})},t)),(0,s.jsxs)("div",{className:"rounded-md bg-misc-periwinkle5 mt-auto p-2 flex items-center",children:[(0,s.jsx)("div",{className:"flex pr-2",children:(0,s.jsx)(o.J,{icon:["far","question-circle"],className:"w-5 h-5",iconClassName:"text-brand-lightPeriwinkle"})}),(0,s.jsx)("div",{className:"flex w-52",children:"Didn't find what you were looking for?"}),(0,s.jsx)("div",{className:"ml-auto",children:(0,s.jsx)(l.zx,{variant:"outline",size:"sm",className:"flex justify-center bg-misc-periwinkle5 text-brand-lightPeriwinkle border-brand-lightPeriwinkle",onClick:t,children:"Contact Support"})})]})]})]})},support_ZendeskSubmitConfirmation=({userEmail:e})=>(0,s.jsxs)("div",{className:"text-center flex flex-col justify-center items-center gap-2 bg-neutral-0 relative p-4 h-[27.5rem]",children:[(0,s.jsx)("div",{className:"flex justify-center items-center mb-4 ml-6",children:(0,s.jsx)("img",{src:"/static/img/outlier/3d-envelope-with-green-check.svg",className:"w-auto h-32"})}),(0,s.jsx)("div",{className:"flex text-xl font-medium",children:"Thank you for contacting us!"}),(0,s.jsxs)("div",{className:"flex text-neutral-500 w-72",children:["Thank you for submitting your help request. You will be contacted via email at ",e," ","within 3-5 business days."]})]});let k=new u.S({defaultOptions:{queries:{refetchOnWindowFocus:!1,staleTime:1/0}}}),ZendeskDynamicFormHelpCenterDataWrapper=({onClose:e,open:t,userId:r,logEvent:u,isMarketplace:d})=>{var m,y,x,j;let D=(0,i.useRef)(null);(0,p.Z)(D,e);let{data:N,isLoading:w}=(0,c.a)({queryKey:["zendesk-form-data"],queryFn:async()=>(0,h.ZP)("/internal/support/zendesk-forms",{method:"GET"}),enabled:t}),_=(0,O.O)(t),I=null!==(m=_.data)&&void 0!==m?m:"",[E,C]=(0,i.useState)(!1),T=null!==(x=null===(y=null==N?void 0:N.forms.find(e=>e.id===b.NEW_TAXONOMY_FORM_ID))||void 0===y?void 0:y.ticket_field_ids)&&void 0!==x?x:[],A=null!==(j=null==N?void 0:N.fields.filter(e=>T.includes(e.id)))&&void 0!==j?j:[],P=(0,i.useMemo)(()=>A.find(e=>e.id===b.NEW_TAXONOMY_FIELD_ID),[A]),[M,F]=(0,i.useState)(""),[H,W]=(0,i.useState)(""),[Z,z]=(0,i.useState)(""),L=(0,i.useMemo)(()=>{let e=new Set(null==P?void 0:P.custom_field_options.map(e=>e.name.split("::")[0]));return Array.from(e.values()).map(e=>({id:e,name:e}))},[P]),$=(0,i.useMemo)(()=>{if(!M)return[];let e=new Set(null==P?void 0:P.custom_field_options.filter(e=>e.name.startsWith(M)).map(e=>e.name.split("::")[1]));return Array.from(e.values()).map(e=>({id:e,name:e}))},[P,M]),R=(0,i.useMemo)(()=>{if(!M||!H)return[];let e=[],t=null==P?void 0:P.custom_field_options.filter(e=>e.name.startsWith(`${M}::${H}`));if(!t)return[];for(let r of t)r.name.split("::").length>2&&e.push(r.name.split("::")[2]);return e.map(e=>({id:e,name:e}))},[P,M,H]),q=(0,i.useMemo)(()=>`${M}::${H}`+(Z?`::${Z}`:""),[M,H,Z]),Y=(0,i.useMemo)(()=>{if(!M||!H)return"";let e=null==P?void 0:P.custom_field_options.find(e=>e.name===q);return e?e.value:""},[P,M,H,q]),U=(0,i.useMemo)(()=>b.ISSUE_MAPPING[q]?(C(!1),b.ISSUE_MAPPING[q]):[],[q]);(0,i.useEffect)(()=>{(0===R.length&&H||Z)&&0===U.length&&C(!0)},[R,H,Z,U]);let[X,G]=(0,i.useState)(""),[J,V]=(0,i.useState)({}),[B,K]=(0,i.useState)(),Q=(0,i.useCallback)((e,t)=>{V(r=>(0,g.produce)(r,r=>{r[e]=t}))},[]),ee=(0,i.useMemo)(()=>{if(!N)return[];let e=A.filter(e=>{if("country"===e.title.toLowerCase()||"subject"===e.type||"description"===e.type)return!1;let t=N.forms.find(e=>e.id===b.NEW_TAXONOMY_FORM_ID),r=t.end_user_conditions,s=r.filter(t=>v().some(t.child_fields,t=>t.id===e.id));return 0===s.length||v().some(s,e=>v().isEqual(J[e.parent_field_id],e.value))});return e.sort((e,t)=>e.position-t.position),e},[J,A,null==N?void 0:N.forms]);(0,i.useEffect)(()=>{V(e=>(0,g.produce)(e,e=>{e[b.NEW_TAXONOMY_FIELD_ID]=Y}))},[P,Y]);let et=X.length>400,er=!et&&X&&v().every(ee,e=>{let t=J[e.id];return!e.required||!!t}),[es,ei]=(0,i.useState)(),[en,ea]=(0,i.useState)(!1),el=(0,i.useCallback)(e=>{e?ei(e):(ei(void 0),K(void 0))},[]);(0,i.useEffect)(()=>{async function uploadFile(){ea(!0);let e=new FormData;e.append("upload",es);try{let{token:t}=await (0,h.ZP)("/internal/support/attachment",{method:"POST",body:e});K(t)}catch(e){console.error("Error uploading file",e)}finally{ea(!1)}}es&&uploadFile()},[es]);let[eo,eu]=(0,i.useState)(!1),{mutate:ed,isLoading:ec}=(0,f.D)({mutationFn:async()=>{let e=Object.entries(J).filter(e=>v().some(ee,t=>t.id===Number(e[0]))).map(([e,t])=>({id:e,value:t}));return d&&e.push({id:"27843299099163",value:!0}),(0,h.ZP)("/internal/support/dynamic-form",{method:"POST",body:JSON.stringify({formId:b.NEW_TAXONOMY_FORM_ID,formTitle:N.forms.find(e=>e.id===b.NEW_TAXONOMY_FORM_ID).name,description:X,fieldData:e,attachments:B?[B]:[]})})},onSuccess:()=>{eu(!0),u&&u(S.Event.SubmitTicketEvent,{userId:r,issue:M,subIssue:H,subSubIssue:Z})}});return t?(0,s.jsxs)("div",{ref:D,className:"scaleui scale-tailwind outlier-theme z-[99999] absolute bottom-0 left-0 m-4 w-[460px] drop-shadow-lg rounded-md overflow-scroll border border-neutral-200",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-neutral-50 h-12 border-b border-neutral-200",children:[(0,s.jsx)("div",{className:"font-medium leading-6 text-lg text-neutral-800",children:"Support"}),(0,s.jsx)(n.FontAwesomeIcon,{icon:"minus",className:"cursor-pointer",onClick:e})]}),!N||w?(0,s.jsx)("div",{className:"bg-neutral-0 p-4 h-96 flex items-center justify-center",children:(0,s.jsx)(a.$,{size:"lg"})}):eo?(0,s.jsx)(support_ZendeskSubmitConfirmation,{userEmail:N.userEmail}):E?(0,s.jsx)(ZendeskSupportTicketBody,{issue:M,subIssue:H,subSubIssue:Z,setIssue:F,setSubIssue:W,setSubSubIssue:z,issueOptions:L,subIssueOptions:$,subSubIssueOptions:R,displayedFields:ee,description:X,setDescription:G,hasDescriptionError:et,file:es,handleFileChanged:el,isFileLoading:en,fileToken:B,fieldData:J,handleSetFieldValue:Q}):(0,s.jsx)(support_ZendeskHelpCenterBody,{userId:r,onContactSupport:()=>{u&&u(S.Event.ContinueToSupportEvent,{userId:r,issue:M,subIssue:H,subSubIssue:Z}),C(!0)},issue:M,subIssue:H,subSubIssue:Z,setIssue:F,setSubIssue:W,setSubSubIssue:z,issueOptions:L,subIssueOptions:$,subSubIssueOptions:R,helpCenterArticles:U,logEvent:u}),!eo&&(0,s.jsxs)("div",{className:"flex items-center justify-between bg-neutral-0 py-1 px-4 h-12 border-t border-neutral-200 w-full",children:[(0,s.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:`${I}https://tryoutlier.zendesk.com/hc/en-us`,className:"w-full flex",children:(0,s.jsx)(l.zx,{variant:"outline",size:"lg",className:`w-full flex justify-center ${E?"mr-1":""}`,onClick:()=>{k.invalidateQueries(["zendesk-login-and-redirect-prefix"]),u&&u(S.Event.HelpCenterClickEvent,{userId:r,issue:M,subIssue:H,subSubIssue:Z})},children:(0,s.jsxs)("span",{className:"flex",children:["Help Center",(0,s.jsx)(o.J,{icon:"up-right-from-square",className:"w-5 h-5 pl-3",iconClassName:"text-primary-400"})]})})}),E&&(0,s.jsx)(l.zx,{size:"lg",disabled:!er||ec||en,className:"w-full flex justify-center ml-1",onClick:()=>ed(),children:"Contact Support"})]})]}):null};var ZendeskDynamicFormWithHelpCenter=e=>(0,s.jsx)(d.aH,{client:k,children:(0,s.jsx)(ZendeskDynamicFormHelpCenterDataWrapper,Object.assign({},e))})},473631:function(e,t,r){"use strict";t.Li=function(e,t,r="HH:mm"){if(!e.startsWith("UTC "))throw Error(`getLocalTime only supprots UTC time. Date ${e} is not supported`);let n=e.slice(3),a=i.default.utc(n,"YYYY-MM-DD HH:mm:ss"),l=s.default.last(t.split(" "));if(!l?.startsWith("GMT"))throw Error(`timezone ${t} is not supported. Please update configuration if we need to support it!`);let o=s.default.toNumber(l.slice(3));if(!s.default.isNumber(o))throw Error(`timezone ${t} is not supported. Please update configuration if we need to support it!`);return a.utcOffset(o).format(r)},t.ZP=void 0;var s=_interopRequireDefault(r(298784)),i=_interopRequireDefault(r(951154));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}t.ZP=function(e,t,r="seconds"){if(e&&t)return i.default(e).utc().diff(i.default(t).utc(),r)}},575904:function(e,t){"use strict";var r,s;t.mp=t.cL=void 0,t.cL=r,(s=r||(t.cL=r={})).Pending="Awaiting Review",s.Accepted="Accepted",s.Rejected="Rejected",t.mp=e=>!e.disabled},351818:function(e,t){"use strict";var r,s,i,n;t.We=t.vw=void 0,t.vw=r,(i=r||(t.vw=r={})).WorkerTeamPrimary="WorkerTeamPrimary",i.WorkerTeamSecondary="WorkerTeamSecondary",i.AssignedProjectLayers="AssignedProjectLayers",i.TieredBursty="TieredBursty",i.TieredPrimary="TieredPrimary",i.TieredSecondary="TieredSecondary",i.TieredTertiary="TieredTertiary",t.We=s,(n=s||(t.We=s={})).Info="info",n.Alert="alert",n.Warning="warning"},222091:function(e,t,r){var s,i;i=function(e){var t=["N","E","A","D"];function inherits(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function Diff(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function DiffEdit(e,t,r){DiffEdit.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:r,enumerable:!0})}function DiffNew(e,t){DiffNew.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function DiffDeleted(e,t){DiffDeleted.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function DiffArray(e,t,r){DiffArray.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:r,enumerable:!0})}function arrayRemove(e,t,r){var s=e.slice((r||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,s),e}function realTypeOf(e){var t=typeof e;return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"==typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function hashThisString(e){var t=0;if(0===e.length)return t;for(var r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t&=t;return t}function getOrderIndependentHash(e){var t=0,r=realTypeOf(e);if("array"===r){e.forEach(function(e){t+=getOrderIndependentHash(e)});var s="[type: array, hash: "+t+"]";return t+hashThisString(s)}if("object"===r){for(var i in e)if(e.hasOwnProperty(i)){var n="[ type: object, key: "+i+", value hash: "+getOrderIndependentHash(e[i])+"]";t+=hashThisString(n)}return t}return t+hashThisString("[ type: "+r+" ; value: "+e+"]")}function deepDiff(e,t,r,s,i,n,a,l){r=r||[],a=a||[];var o,u,d,c,f=(i=i||[]).slice(0);if(null!=n){if(s){if("function"==typeof s&&s(f,n))return;if("object"==typeof s){if(s.prefilter&&s.prefilter(f,n))return;if(s.normalize){var p=s.normalize(f,n,e,t);p&&(e=p[0],t=p[1])}}}f.push(n)}"regexp"===realTypeOf(e)&&"regexp"===realTypeOf(t)&&(e=e.toString(),t=t.toString());var h=typeof e,m=typeof t,v="undefined"!==h||a&&a.length>0&&a[a.length-1].lhs&&Object.getOwnPropertyDescriptor(a[a.length-1].lhs,n),b="undefined"!==m||a&&a.length>0&&a[a.length-1].rhs&&Object.getOwnPropertyDescriptor(a[a.length-1].rhs,n);if(!v&&b)r.push(new DiffNew(f,t));else if(!b&&v)r.push(new DiffDeleted(f,e));else if(realTypeOf(e)!==realTypeOf(t))r.push(new DiffEdit(f,e,t));else if("date"===realTypeOf(e)&&e-t!=0)r.push(new DiffEdit(f,e,t));else if("object"===h&&null!==e&&null!==t){for(o=a.length-1;o>-1;--o)if(a[o].lhs===e){c=!0;break}if(c)e!==t&&r.push(new DiffEdit(f,e,t));else{if(a.push({lhs:e,rhs:t}),Array.isArray(e)){for(l&&(e.sort(function(e,t){return getOrderIndependentHash(e)-getOrderIndependentHash(t)}),t.sort(function(e,t){return getOrderIndependentHash(e)-getOrderIndependentHash(t)})),o=t.length-1,u=e.length-1;o>u;)r.push(new DiffArray(f,o,new DiffNew(void 0,t[o--])));for(;u>o;)r.push(new DiffArray(f,u,new DiffDeleted(void 0,e[u--])));for(;o>=0;--o)deepDiff(e[o],t[o],r,s,f,o,a,l)}else{var g=Object.keys(e),y=Object.keys(t);for(o=0;o<g.length;++o)d=g[o],(c=y.indexOf(d))>=0?(deepDiff(e[d],t[d],r,s,f,d,a,l),y[c]=null):deepDiff(e[d],void 0,r,s,f,d,a,l);for(o=0;o<y.length;++o)(d=y[o])&&deepDiff(void 0,t[d],r,s,f,d,a,l)}a.length=a.length-1}}else e===t||"number"===h&&isNaN(e)&&isNaN(t)||r.push(new DiffEdit(f,e,t))}function observableDiff(e,t,r,s,i){var n=[];if(deepDiff(e,t,n,s,null,null,null,i),r)for(var a=0;a<n.length;++a)r(n[a]);return n}function accumulateDiff(e,t,r,s){var i=observableDiff(e,t,s?function(e){e&&s.push(e)}:void 0,r);return s||(i.length?i:void 0)}function applyChange(e,r,s){if(void 0===s&&r&&~t.indexOf(r.kind)&&(s=r),e&&s&&s.kind){for(var i=e,n=-1,a=s.path?s.path.length-1:0;++n<a;)void 0===i[s.path[n]]&&(i[s.path[n]]=void 0!==s.path[n+1]&&"number"==typeof s.path[n+1]?[]:{}),i=i[s.path[n]];switch(s.kind){case"A":s.path&&void 0===i[s.path[n]]&&(i[s.path[n]]=[]),function applyArrayChange(e,t,r){if(r.path&&r.path.length){var s,i=e[t],n=r.path.length-1;for(s=0;s<n;s++)i=i[r.path[s]];switch(r.kind){case"A":applyArrayChange(i[r.path[s]],r.index,r.item);break;case"D":delete i[r.path[s]];break;case"E":case"N":i[r.path[s]]=r.rhs}}else switch(r.kind){case"A":applyArrayChange(e[t],r.index,r.item);break;case"D":e=arrayRemove(e,t);break;case"E":case"N":e[t]=r.rhs}return e}(s.path?i[s.path[n]]:i,s.index,s.item);break;case"D":delete i[s.path[n]];break;case"E":case"N":i[s.path[n]]=s.rhs}}}return inherits(DiffEdit,Diff),inherits(DiffNew,Diff),inherits(DiffDeleted,Diff),inherits(DiffArray,Diff),Object.defineProperties(accumulateDiff,{diff:{value:accumulateDiff,enumerable:!0},orderIndependentDiff:{value:function(e,t,r,s){var i=observableDiff(e,t,s?function(e){e&&s.push(e)}:void 0,r,!0);return s||(i.length?i:void 0)},enumerable:!0},observableDiff:{value:observableDiff,enumerable:!0},orderIndependentObservableDiff:{value:function(e,t,r,s,i,n,a){return deepDiff(e,t,r,s,i,n,a,!0)},enumerable:!0},orderIndepHash:{value:getOrderIndependentHash,enumerable:!0},applyDiff:{value:function(e,t,r){e&&t&&observableDiff(e,t,function(s){(!r||r(e,t,s))&&applyChange(e,t,s)})},enumerable:!0},applyChange:{value:applyChange,enumerable:!0},revertChange:{value:function(e,t,r){if(e&&t&&r&&r.kind){var s,i,n=e;for(s=0,i=r.path.length-1;s<i;s++)void 0===n[r.path[s]]&&(n[r.path[s]]={}),n=n[r.path[s]];switch(r.kind){case"A":!function revertArrayChange(e,t,r){if(r.path&&r.path.length){var s,i=e[t],n=r.path.length-1;for(s=0;s<n;s++)i=i[r.path[s]];switch(r.kind){case"A":revertArrayChange(i[r.path[s]],r.index,r.item);break;case"D":case"E":i[r.path[s]]=r.lhs;break;case"N":delete i[r.path[s]]}}else switch(r.kind){case"A":revertArrayChange(e[t],r.index,r.item);break;case"D":case"E":e[t]=r.lhs;break;case"N":e=arrayRemove(e,t)}return e}(n[r.path[s]],r.index,r.item);break;case"D":case"E":n[r.path[s]]=r.lhs;break;case"N":delete n[r.path[s]]}}},enumerable:!0},isConflict:{value:function(){return"undefined"!=typeof $conflict},enumerable:!0}}),accumulateDiff.DeepDiff=accumulateDiff,e&&(e.DeepDiff=accumulateDiff),accumulateDiff}(this),void 0!==(s=(function(){return i}).call(t,r,t,e))&&(e.exports=s)},505940:function(e,t,r){"use strict";r.d(t,{VC:function(){return withHistory}});var s=r(413735),i=r(585912);new WeakMap;var n=new WeakMap,a=new WeakMap,l={isHistoryEditor:e=>{var t;return t=e.history,(0,s.P)(t)&&Array.isArray(t.redos)&&Array.isArray(t.undos)&&(0===t.redos.length||i.OX.isOperationList(t.redos[0]))&&(0===t.undos.length||i.OX.isOperationList(t.undos[0]))&&i.ML.isEditor(e)},isMerging:e=>a.get(e),isSaving:e=>n.get(e),redo(e){e.redo()},undo(e){e.undo()},withoutMerging(e,t){var r=l.isMerging(e);a.set(e,!1),t(),a.set(e,r)},withoutSaving(e,t){var r=l.isSaving(e);n.set(e,!1),t(),n.set(e,r)}},withHistory=e=>{var{apply:t}=e;return e.history={undos:[],redos:[]},e.redo=()=>{var{history:t}=e,{redos:r}=t;if(r.length>0){var s=r[r.length-1];l.withoutSaving(e,()=>{i.ML.withoutNormalizing(e,()=>{for(var t of s)e.apply(t)})}),t.redos.pop(),t.undos.push(s)}},e.undo=()=>{var{history:t}=e,{undos:r}=t;if(r.length>0){var s=r[r.length-1];l.withoutSaving(e,()=>{i.ML.withoutNormalizing(e,()=>{for(var t of s.map(i.OX.inverse).reverse())e.apply(t)})}),t.redos.push(s),t.undos.pop()}},e.apply=r=>{var{operations:s,history:i}=e,{undos:n}=i,a=n[n.length-1],o=a&&a[a.length-1],u=shouldOverwrite(r,o),d=l.isSaving(e),c=l.isMerging(e);if(null==d&&(d=shouldSave(r)),d){if(null==c&&(c=null!=a&&(0!==s.length||shouldMerge(r,o)||u)),a&&c)u&&a.pop(),a.push(r);else{var f=[r];n.push(f)}for(;n.length>100;)n.shift();shouldClear(r)&&(i.redos=[])}t(r)},e},shouldMerge=(e,t)=>!!("set_selection"===e.type||t&&"insert_text"===e.type&&"insert_text"===t.type&&e.offset===t.offset+t.text.length&&i.y$.equals(e.path,t.path)||t&&"remove_text"===e.type&&"remove_text"===t.type&&e.offset+e.text.length===t.offset&&i.y$.equals(e.path,t.path)),shouldSave=(e,t)=>"set_selection"!==e.type||null!=e.properties&&null!=e.newProperties,shouldOverwrite=(e,t)=>!!t&&"set_selection"===e.type&&"set_selection"===t.type,shouldClear=e=>"set_selection"!==e.type}}]);