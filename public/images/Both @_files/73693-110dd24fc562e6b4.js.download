(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[73693],{965167:function(e,t,n){"use strict";n.d(t,{BH:function(){return useMultiTurnContinueResponseForTurnIndex},Bi:function(){return getAllStepsCompleted},Cw:function(){return useMostRecentResponseForStepId},DL:function(){return useMostRecentStepParamsForStepType},H9:function(){return useIsCurrentStep},Hp:function(){return x},IQ:function(){return useTurnMessages},Is:function(){return useTurnByIndex},Kx:function(){return usePromptInputDisplayType},L8:function(){return useNumberOfTurns},LD:function(){return useAfterSteps},LG:function(){return useTurnVersion},M$:function(){return useChatConfig},MB:function(){return useMostRecentResponseForStepType},QA:function(){return useIsStepSequentiallySkippedAndVisible},RZ:function(){return useChatStoreRef},S2:function(){return useLastResponseGeneratorStep},Ur:function(){return useBeforeSteps},Vf:function(){return useInvalidErrorMessagesForTurn},Xn:function(){return useAllResponsesForStepType},Yu:function(){return useIsStepVisible},Zo:function(){return useStepParamsOrUndefined},a9:function(){return useMostRecentResponseInTurn},bK:function(){return g},cf:function(){return useSystemPrompt},dK:function(){return useStepParams},gL:function(){return useIsTurnCompleted},jH:function(){return useMostRecentResponseFullObject},jP:function(){return useMostRecentOutputFullObject},j_:function(){return useIsRealCustomerAudit},l4:function(){return useTurnIndexes},lp:function(){return D},mQ:function(){return useHasIncompleteStepsInTurn},o7:function(){return useIsStepConditionallyVisible},pk:function(){return useTurnContinuationContext},qn:function(){return useStepResponse},rg:function(){return useMostRecentPromptForStepId},rt:function(){return useIsStepCompleted},s4:function(){return useMostRecentPromptAttachments},t0:function(){return useChatStoreExtract},t9:function(){return useIsAnyTurnIncomplete},uF:function(){return useMostRecentPrompt},uO:function(){return useProcessSupervisionLimitChatHistory},ux:function(){return useMostRecentMessageMetadata},v2:function(){return useChatHistory},xg:function(){return useCurrentStep},xy:function(){return useMostRecentResponse}});var r=n(827378),o=n(236125),s=n(634040),a=n(67370),l=n(854358),i=n(844159),d=n(199729),u=n.n(d),c=n(138354),p=n.n(c),m=n(830644),h=n.n(m),f=n(900218);let g="**DISCLAIMER: There is no model response in this turn. Expand this section to view the steps in the turn.**",x="**DISCLAIMER: This turn has no visible steps and no model response.**";function useChatStoreRef(){let e=(0,r.useContext)(s.p);if(!(null==e?void 0:e.current))throw Error("You have to wrap Chat component into ChatStoreContextProvider");return e}function useChatStoreExtract(e){let t=(0,r.useContext)(s.p);if(!(null==t?void 0:t.current))throw Error("You have to wrap Chat component into ChatStoreContextProvider");return(0,o.oR)(t.current,e)}function getAllStepsCompleted(e){return Object.values(e.completedSteps).every(e=>!1!==e)}let v=(0,a.Mt)((e,t)=>e.stepParams[t]);function useStepParams(e){return useChatStoreExtract(t=>v(t,e))}let b=(0,a.Mt)((e,t)=>{if(!h()(t))return e.stepParams[t]});function useStepParamsOrUndefined(e){return useChatStoreExtract(t=>b(t,e))}function useCurrentStep(){return useChatStoreExtract(e=>e.stepParams.at(-1))}function useChatConfig(){return useChatStoreExtract(e=>e.config)}let C=(0,a.HP)(e=>e.stepParams.slice(0,e.config.before.length));function useBeforeSteps(){return useChatStoreExtract(e=>C(e))}(0,a.HP)(e=>{let t=e.config.turn.length+1,n=e.stepParams.filter(e=>e.stage===i.ChatTaskParamsStages.Turn),r=[];for(let e=0;e<n.length;e+=t){let o=n.slice(e,e+t);r.push(o)}return r});let y=(0,a.HP)(e=>{let t=e.config.turn.length+1,n=e.stepParams.filter(e=>e.stage===i.ChatTaskParamsStages.Turn),r=[];for(let e=0;e<n.length;e+=t)r.push(n[e].turn);return r});function useTurnIndexes(){return useChatStoreExtract(e=>y(e))}let w=(0,a.Mt)((e,t)=>e.stepParams.filter(e=>e.stage===i.ChatTaskParamsStages.Turn&&e.turn===t));function useTurnByIndex(e){return useChatStoreExtract(t=>w(t,e))}let k=(0,a.Mt)((e,t)=>{let n=e.stepParams.find(e=>e.stage===i.ChatTaskParamsStages.Turn&&e.turn===t&&e.type===l.InteractionStepType.MultiTurnContinue);if(!n)return!1;let r=e.responses.at(null==n?void 0:n.responseIndex);return!h()(r)&&r.contextType!==l.ContextType.Skipped});function useIsTurnCompleted(e){return useChatStoreExtract(t=>k(t,e))}function useTurnMessages(e){return useChatStoreExtract(t=>{let n=t.stepParams.find(t=>t.stage===i.ChatTaskParamsStages.Turn&&t.turn===e&&t.type===l.InteractionStepType.MultiTurnContinue);if(!n)return[];let r=t.responses.at(n.responseIndex);if(!r)return[];let o=r.output,s=r.context,a=s.message.length?s.message:function(e,t,n){let r=(0,f.getMostRecentModelSelectorResponseForTurn)(e,t,n);return r.length?"".concat("**DISCLAIMER: The selected response is a placeholder for the chat history even though you selected no preference.**","\n\n").concat(r):g}(t.responses,e,t.stepParams),d={role:l.MessageRole.Assistant,content:a,attachments:s.modelResponseAttachments,messageMetadata:s.modelResponseMetadata};if(!s.shouldContinue)return[d];let u={role:s.role||l.MessageRole.User,content:o,attachments:s.attachments,skipMessage:s.skipPromptInput||!1};return[d,u]})}function useTurnContinuationContext(e){return useChatStoreExtract(t=>{let n=t.stepParams.find(t=>t.stage===i.ChatTaskParamsStages.Turn&&t.turn===e&&t.type===l.InteractionStepType.MultiTurnContinue);if(!n)return;let r=t.responses.at(n.responseIndex);if(r)return r.context})}let j=(0,a.Mt)((e,t)=>{let n=e.stepParams.find(e=>e.stage===i.ChatTaskParamsStages.Turn&&e.turn===t&&e.type===l.InteractionStepType.MultiTurnContinue);if(n)return e.responses.at(n.responseIndex)});function useMultiTurnContinueResponseForTurnIndex(e){return useChatStoreExtract(t=>j(t,e))}let S=(0,a.HP)(e=>e.stepParams.filter(e=>e.stage===i.ChatTaskParamsStages.After));function useAfterSteps(){return useChatStoreExtract(e=>S(e))}let T=(0,a.Mt)((e,t)=>(0,f.isStepSequentiallySkippedAndVisible)(e.stepParams,e.responses,t,e.reviewLevel,e.config.templateVariables));function useIsStepSequentiallySkippedAndVisible(e){return useChatStoreExtract(t=>T(t,e))}let E=(0,a.Mt)((e,t)=>{let n=e.responses.length;return n===t});function useIsCurrentStep(e){return useChatStoreExtract(t=>E(t,e))}let N=(0,a.Mt)((e,t)=>{let n=e.stepParams.at(t);return!!n&&(0,f.isStepVisible)(n,e.reviewLevel)});function useIsStepVisible(e){return useChatStoreExtract(t=>N(t,e))}let isStepConditionallyVisible=(e,t)=>{let n=e.stepParams.at(t);return!!n&&(0,f.isConditionallyVisible)(n,e.responses,t,e.config.templateVariables,e.reviewLevel)},M=(0,a.Mt)((e,t)=>isStepConditionallyVisible(e,t));function useIsStepConditionallyVisible(e){return useChatStoreExtract(t=>M(t,e))}let R=(0,a.Mt)((e,t,n)=>{let r=e.responses.at(t);if(r&&(n||(null==r?void 0:r.contextType)!==l.ContextType.Skipped))return r});function useStepResponse(e,t){return useChatStoreExtract(n=>R(n,e,null!=t&&t))}let A=(0,a.Mt)((e,t,n)=>{let r=e.responses.at(t);r&&(n||(null==r?void 0:r.contextType)!==l.ContextType.Skipped)||(r=void 0);let o=e.completedSteps;return!!r&&o[t]});function useIsStepCompleted(e,t){return useChatStoreExtract(n=>A(n,e,null!=t&&t))}function usePromptInputDisplayType(){return useChatStoreExtract(e=>{var t;let n=e.config.before.find(e=>e.type===l.InteractionStepType.PromptInput),r=null!==(t=u()(n,"[0].params.params.display_type"))&&void 0!==t?t:u()(n,"params.display_type");return null!=r?r:l.ChatMessageDisplayType.Markdown})}let P=(0,a.HP)(e=>e.config.turn.filter(e=>i.RESPONSE_GENERATOR_STEPS.includes(e.type)).at(-1));function useLastResponseGeneratorStep(){return useChatStoreExtract(e=>P(e))}let I=(0,a.HP)(e=>{let t=p()(e.stepParams.filter(e=>e.stage===i.ChatTaskParamsStages.Turn),e=>{let{turn:t}=e;return t});return!Object.values(t).every(t=>{let n=t.at(-1);return!h()(n)&&n.type===l.InteractionStepType.MultiTurnContinue&&!h()(e.responses.at(n.responseIndex))})});function useIsAnyTurnIncomplete(){return useChatStoreExtract(e=>I(e))}function useHasIncompleteStepsInTurn(e){return useChatStoreExtract(t=>{let n=t.stepParams.filter(t=>t.stage===i.ChatTaskParamsStages.Turn&&t.turn===e&&t.type!==l.InteractionStepType.MultiTurnContinue).map(e=>e.responseIndex);return n.some(e=>!t.completedSteps[e])})}function useInvalidErrorMessagesForTurn(e){return useChatStoreExtract(t=>{var n;if(h()(e))return[];let r=(null!==(n=t.invalidStepIndices)&&void 0!==n?n:[]).filter(t=>(null==t?void 0:t.turnIndex)===e).map(e=>{var t;return null!==(t=e.errorMessage)&&void 0!==t?t:"This turn has some steps that are not completed."});return r})}let L=(0,a.Mt)((e,t)=>{var n;let r=h()(t)?e.stepParams:e.stepParams.slice(0,t+1),o=r.filter(e=>e.stage===i.ChatTaskParamsStages.Turn).at(-1),s=null!==(n=null==o?void 0:o.turn)&&void 0!==n?n:0;return s+1});function useNumberOfTurns(e){return useChatStoreExtract(t=>L(t,e))}let B=(0,a.Mt)((e,t)=>{var n;let r=e.responses.filter((n,r)=>{var o;return(null===(o=e.stepParams[n.index])||void 0===o?void 0:o.turn)===t&&n.contextType!==l.ContextType.Skipped&&i.RESPONSE_GENERATOR_STEPS.includes(n.type)&&isStepConditionallyVisible(e,r)}).at(-1);return null!==(n=null==r?void 0:r.output)&&void 0!==n?n:""});function useMostRecentResponseInTurn(e){return useChatStoreExtract(t=>B(t,e))}let _=(0,a.Mt)((e,t)=>{let n=h()(t)?e.responses:e.responses.slice(0,t);for(let t=n.length-1;t>=0;t--){let r=n[t];if(r.contextType!==l.ContextType.Skipped&&i.RESPONSE_GENERATOR_STEPS.includes(r.type)&&isStepConditionallyVisible(e,t))return r;if([l.InteractionStepType.PromptInput,l.InteractionStepType.MultiTurnContinue].includes(r.type))break}return null});function useMostRecentResponseFullObject(e){return useChatStoreExtract(t=>_(t,e))}function useMostRecentMessageMetadata(e){var t,n,r,o;let s=useMostRecentResponseFullObject(e);if((null==s?void 0:s.type)===l.InteractionStepType.ModelResponseSelector){let e=0;(null===(n=s.context)||void 0===n?void 0:n.selectedIndex)>=0&&(e=null===(o=s.context)||void 0===o?void 0:o.selectedIndex);let t=null===(r=s.context)||void 0===r?void 0:r.candidates.at(e);return null==t?void 0:t.message.messageMetadata}return null==s?void 0:null===(t=s.context)||void 0===t?void 0:t.messageMetadata}function useMostRecentResponse(e){var t,n;return null!==(n=null===(t=useMostRecentResponseFullObject(e))||void 0===t?void 0:t.output)&&void 0!==n?n:""}let D=(0,a.Mt)((e,t)=>{let n=h()(t)?e.responses:e.responses.slice(0,t),r=e.config,o=n.filter(e=>[l.InteractionStepType.PromptInput,l.InteractionStepType.MultiTurnContinue].includes(e.type)).at(-1);return o?(0,f.producePromptWithReferenceTexts)(o,r.useAppendedReferenceText):""});function useMostRecentPrompt(e){return useChatStoreExtract(t=>D(t,e))}let O=(0,a.Mt)((e,t,n)=>{let r=e.responses.slice(0,t),o=e.config,s=r.filter(e=>[l.InteractionStepType.PromptInput,l.InteractionStepType.MultiTurnContinue].includes(e.type)&&e.step_id===n).at(-1);return s?(0,f.producePromptWithReferenceTexts)(s,o.useAppendedReferenceText):""});function useMostRecentPromptForStepId(e,t){return useChatStoreExtract(n=>t?O(n,e,t):"")}function useMostRecentOutputFullObject(e){return useChatStoreExtract(t=>{let n=h()(e)?t.responses:t.responses.slice(0,e);return 0===n.length?null:n.at(-1)})}function useMostRecentPromptAttachments(e){return useChatStoreExtract(t=>{var n;let r=h()(e)?t.responses:t.responses.slice(0,e),o=r.filter(e=>[l.InteractionStepType.PromptInput,l.InteractionStepType.MultiTurnContinue].includes(e.type)).at(-1);if(!o)return[];let s=null===(n=o.context)||void 0===n?void 0:n.attachments;return null!=s?s:[]})}function useMostRecentResponseForStepType(e,t){return useChatStoreExtract(n=>{var r;let o=h()(t)?n.responses:n.responses.slice(0,t);return null!==(r=o.filter((t,r)=>t.type===e&&t.contextType!==l.ContextType.Skipped&&isStepConditionallyVisible(n,r)).at(-1))&&void 0!==r?r:null})}function useAllResponsesForStepType(e,t){return useChatStoreExtract(n=>{let r=h()(t)?n.responses:n.responses.slice(0,t);return r.filter(t=>t.type===e)})}function useMostRecentStepParamsForStepType(e,t){return useChatStoreExtract(n=>{let r=h()(t)?n.responses:n.responses.slice(0,t),o=r.filter(t=>t.type===e&&t.contextType!==l.ContextType.Skipped).at(-1);if(!o)return null;let s=n.stepParams.at(o.index);return null!=s?s:null})}function useMostRecentResponseForStepId(e,t){return useChatStoreExtract(n=>{if(!e)return null;let r=h()(t)?n.responses:n.responses.slice(0,t),o=r.filter(t=>t.step_id===e).at(-1);return o||null})}let F=(0,a.Mt)((e,t)=>{var n;return null!==(n=e.turnVersionHistory[t])&&void 0!==n?n:0});function useTurnVersion(e){return useChatStoreExtract(t=>F(t,e))}function useChatHistory(e){return useChatStoreExtract(t=>(0,f.constructChatHistory)({responses:t.responses,config:t.config,stepParamsWithStage:t.stepParams,responseIndex:e}))}let useProcessSupervisionLimitChatHistory=e=>{let t=useChatHistory(e),n=t.find(e=>e.role===l.MessageRole.User),r=t.find(e=>e.role===l.MessageRole.Assistant),o=useChatStoreExtract(e=>{let t=e.config.turn.find(e=>[l.InteractionStepType.ProcessSupervision,l.InteractionStepType.ExperimentalToolUse].includes(e.type));return t});return{isEnabled:null==o?void 0:o.params.limit_chat_history,promptRole:r?l.MessageRole.Assistant:l.MessageRole.User,chatHistory:r?[n]:[]}},useSystemPrompt=()=>{let e=useChatHistory();return e.find(e=>e.role===l.MessageRole.System)},z=(0,a.HP)(e=>e.isRealCustomerAudit);function useIsRealCustomerAudit(){return useChatStoreExtract(e=>{var t;return null!==(t=z(e))&&void 0!==t&&t})}},634040:function(e,t,n){"use strict";n.d(t,{p:function(){return o}});var r=n(827378);let o=(0,r.createContext)(null);o.Consumer},257770:function(e,t,n){"use strict";var r=n(824246),o=n(349596),s=n(556997),a=n(720227),l=n(827378),i=n(792739),d=n(134069),u=n(961661);let Tabs=e=>{let{tabs:t,value:n,onChange:o,className:s}=e;return(0,r.jsx)("div",{className:(0,a.m)("border-0 border-b border-solid scaleui border-neutral-200",s),children:(0,r.jsx)("nav",{className:"flex -mb-px space-x-4","aria-label":"Tabs",children:t.map(e=>{var t;let s=null!==(t=e.label)&&void 0!==t?t:e.id;return(0,r.jsx)("button",{type:"button",disabled:e.disabled,className:(0,a.m)("whitespace-nowrap py-2 px-1 border-0 border-solid border-b-2 font-medium text-xs text-neutral-0",e.id===n?"border-neutral-0":"border-transparent hover:border-primary-500"),"aria-current":e.id===n?"page":void 0,onClick:()=>o(e.id),children:(0,r.jsxs)("span",{className:"flex items-center",children:[e.icon&&(0,r.jsx)(i.FontAwesomeIcon,{icon:e.icon,className:"mr-2"}),s,e.suffix&&(0,r.jsx)("span",{className:"ml-1",children:e.suffix})]})},e.id)})})})},XIcon=e=>{let{width:t,height:n,color:o}=e;return(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:n,viewBox:"0 0 24 24",fill:"none",stroke:o,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,r.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})};t.Z=function(e){let{outputValue:t,setOutputTabOpen:n,tab:c,setTab:p,fetchError:m}=e,[h,f]=(0,l.useState)(!1),g=t.split(/\r\n|\r|\n/).length,toggleExpand=e=>{e.stopPropagation(),f(!h)};return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:(0,a.m)("group bg-transparent relative px-0 py-0",h?"overflow-auto":"overflow-hidden"),children:[(0,r.jsxs)("div",{className:"text-white text-xs font-mono font-medium px-3 flex items-center justify-between bg-neutral-800 rounded-t-md py-1.5",children:[(0,r.jsx)(Tabs,{className:"border-none",value:c,tabs:[{id:s.A.STDOUT,label:"Output"},{id:s.A.STDERR,label:"Errors"}],onChange:e=>p(e)}),(0,r.jsxs)("div",{className:"flex items-center justify-end",children:[g>5&&h&&(0,r.jsxs)("button",{onClick:e=>toggleExpand(e),className:"border ml-1 rounded-md py-1.5 px-2 text-xs flex items-center justify-center bg-neutral-600 border-neutral-500 text-neutral-0",children:["Collapse",(0,r.jsx)(i.FontAwesomeIcon,{icon:"chevron-up",className:"ml-1"})]}),(0,r.jsx)("div",{className:"pl-4",children:(0,r.jsx)(u.f,{code:t})}),(0,r.jsx)("button",{onClick:()=>n(!1),className:"ml-1 rounded-md py-1.5 pl-2 pr-1 text-xs flex items-center justify-center text-neutral-0",children:(0,r.jsx)(XIcon,{width:16,height:16,color:"#FFFFFF"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:(0,a.m)("p-3 bg-neutral-900",h?"max-h-[600px] overflow-auto rounded-b-md":"max-h-[97px] overflow-hidden",g<=5||h?"rounded-b-md":"rounded-none"),children:(0,r.jsx)(d.Z,{children:m?"Error executing code - this usually occurs due to execution timeout. Please try again.":t,style:c===s.A.STDERR?{...o.Q,...o.V}:o.Q,PreTag:"div",CodeTag:"div",showLineNumbers:!1})}),g>5&&!h&&(0,r.jsx)("div",{className:"flex items-center justify-center py-2 text-white text-xs font-medium font-mono bg-neutral-900 rounded-b-md",children:(0,r.jsxs)("button",{onClick:e=>toggleExpand(e),className:"border ml-1 text-white rounded-md py-1.5 px-2 text-xs flex items-center justify-center bg-neutral-600 border-neutral-500 text-neutral-0",children:["Expand",(0,r.jsx)(i.FontAwesomeIcon,{icon:"chevron-down",className:"ml-1"})]})})]})]})})}},424727:function(e,t,n){"use strict";n.d(t,{Q:function(){return Y}});var r,o,s=n(824246),a=n(792739),l=n(827378),i=n(416534),d=n(722030),u=n(834770),c=n(461442),p=n(713222),m=n(776845),h=n(89916),f=n(60042),g=n.n(f),x=n(704076),v=n(922632),b=n(720227),C=n(601148),y=n(667332);let CodeEditorField=e=>{let{className:t,label:n,labelDescription:r,required:o,disabled:a,error:i,value:u,name:c,helperText:p,autoFocus:m,onFocus:h,onBlur:f,onChange:g,onKeyDown:w,editorOptions:k={fontSize:14,minimap:{enabled:!1},scrollBeyondLastLine:!1,padding:{top:16,bottom:16},formatOnPaste:!0,formatOnType:!0,renderLineHighlight:"none"},editorProps:j={},tooltipContentClassName:S}=e,[T,E]=(0,l.useState)(null);return(0,l.useEffect)(()=>{if(T){let formatDocument=()=>{var e;null==T||null===(e=T.getAction("editor.action.formatDocument"))||void 0===e||e.run()};T.onDidChangeModelLanguageConfiguration(formatDocument),T.onDidLayoutChange(formatDocument),T.onDidFocusEditorWidget(()=>{null==h||h()}),T.onDidBlurEditorWidget(()=>{formatDocument(),null==f||f()}),T.onKeyDown(e=>{null==w||w(e)})}},[T,h,f,w]),(0,s.jsxs)("div",{className:(0,b.m)("scaleui flex flex-col z-20",t),children:[(0,s.jsx)(C.A,{required:o,error:i,disabled:a,labelDescription:r,tooltipContentClassName:S,children:n}),(0,s.jsx)(x.default,{...j,loading:(0,s.jsx)("div",{className:(0,b.m)("h-full w-full flex items-center justify-center",j.className),children:(0,s.jsx)(d.$,{size:"md",variant:"primary"})}),wrapperProps:{className:"shadow-sm overflow-hidden rounded-b-lg",name:c},options:k,value:u,onChange:g,onMount:(e,t)=>{E(e),t.languages.registerDocumentFormattingEditProvider("sql",{provideDocumentFormattingEdits:e=>[{range:e.getFullModelRange(),text:(0,v.WU)(e.getValue())}]}),t.languages.registerDocumentRangeFormattingEditProvider("sql",{provideDocumentRangeFormattingEdits:(e,t)=>[{range:t,text:(0,v.WU)(e.getValueInRange(t))}]}),m&&e.focus()}}),p?(0,s.jsx)(y.p,{error:i,className:"px-1 w-full whitespace-pre-line",children:p}):null]})};var w=n(320280),k=n(916115),j=n(556997);let S=(0,w.ZL)(()=>({scrollBarColor:{scrollbarColor:"rgba(255, 255, 255, 0.5) rgba(255, 255, 255, 0.1)",scrollbarWidth:"thin"}}));var coding_CodeEditorExecutionOutput=function(e){let{className:t,outputValue:n,setOutputTabOpen:r,tab:o,setTab:a,fetchError:l,fullScreenEnabled:i,fullWidthEnabled:d}=e,u=S();return(0,s.jsxs)("div",{className:(0,b.m)(g()("flex flex-col",{"pl-4":i&&!d,"pl-2 w-3/12":!i&&!d},t)),children:[(0,s.jsxs)("div",{className:g()("flex flex-row rounded-t-lg h-16 justify-between bg-[#2d2d30]",{"w-full":!i,"w-[23vw]":i}),children:[(0,s.jsx)(k.m,{className:"pt-2 pl-3 border-none",value:o,tabs:[{id:j.A.STDOUT,label:"Output"},{id:j.A.STDERR,label:"Errors"}],onChange:e=>a(e)}),(0,s.jsx)("div",{className:"pt-4 pr-2",children:(0,s.jsx)(p.J,{icon:"xmark",variant:"white",onClick:e=>{e.stopPropagation(),r(!1)},tooltipProps:{side:"top"},tooltip:"Hide Output/Errors"})})]}),(0,s.jsx)("div",{className:g()("flex flex-row rounded-b-lg bg-[#1e1e1e]",{"h-[80vh] w-[23vw] z-[10002]":i,"h-64 w-full":!i}),children:(0,s.jsx)("div",{className:g()("text-sm p-2 pl-3 overscroll-x-contain overflow-y-scroll font-mono w-full whitespace-pre-wrap",u.scrollBarColor,{"text-neutral-0":o===j.A.STDOUT,"text-danger-400":o===j.A.STDERR||l}),children:l?"Error executing code - this usually occurs due to execution timeout. Please try again.":n})})]})},T=n(236125),E=n(527467),N=n(298784),M=n.n(N);let R=(0,T.Ue)()((0,E.mW)((e,t)=>({scratchpadCodeState:{},setScratchpadCodeState:(t,n)=>{e(e=>({scratchpadCodeState:{...e.scratchpadCodeState,[t]:M().merge(e.scratchpadCodeState[t],n)}}))},getScratchpadCodeState:e=>{let n=t().scratchpadCodeState[e];return n&&0!==Object.keys(n).length?n:null}})));var A=n(159400);let CodeContextSidebar=e=>{let{className:t,codePopupButtonClassName:n,codeBlocks:r,codeBlockIndex:o,language:a,handleSetEditorCode:l,handleOpen:i,open:d}=e,u=r.reduce((e,t)=>t.language===a?e+t.code+"\n":e,"");return(0,s.jsx)("div",{className:(0,b.m)("flex flex-col bg-[#242424] rounded-b-lg",t),children:(0,s.jsxs)("div",{className:"flex flex-col w-full h-full pl-1",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"flex flex-row justify-between items-center pl-1 pt-1 h-16",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center",children:[(0,s.jsx)(p.J,{icon:["fas","code"],size:"md",className:"fill-neutral-300/50 stroke-success-500",variant:"white"}),(0,s.jsx)(m.ZT.Subtitle4,{className:"text-neutral-0 pl-1 text-lg",children:"Code Snippets"})]}),(0,s.jsx)("div",{className:"pr-2",children:(0,s.jsx)(p.J,{icon:d?["fas","chevron-down"]:["fas","chevron-up"],size:"md",className:"fill-neutral-300/50 stroke-neutral-300",variant:"white",onClick:()=>i(!d)})})]}),(0,s.jsx)("section",{className:"ml-2",children:d&&(0,s.jsx)(CodePopupButton,{className:"hover:bg-neutral-700 w-fit flex flex-row items-center",variant:"long",code:u,language:a,selected:!1,title:"Replace Current Code With All Code Snippets",icon:["fas","arrow-right"],onClick:()=>l(u)})})]}),(0,s.jsx)("section",{className:"ml-2 mt-4 h-full overflow-y-hidden",children:d&&(0,s.jsx)("div",{className:"flex flex-row overflow-x-auto pb-2",children:r.map((e,t)=>(0,s.jsx)("div",{className:"w-32 h-20 pr-2 shrink-0",children:(0,s.jsx)(CodePopupButton,{className:n,code:e.code,language:e.language,selected:o===t,title:"Block ".concat((t+1).toString()),icon:["far","clipboard"],onClickTransitionIcon:["fas","check"],onClick:()=>{navigator.clipboard.writeText(e.code)}})},t))})})]})})},CodePopupButton=e=>{let{className:t,code:n,language:r,selected:o,title:a,onClick:i,icon:d,onClickTransitionIcon:c,variant:m="block"}=e,[h,f]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{if(h){let e=setTimeout(()=>f(!1),1e3);return()=>{clearTimeout(e)}}},[h]),(0,s.jsx)(u.u,{target:(0,s.jsx)("div",{className:(0,b.m)("bg-[#2d2d30] h-full w-full align-middle hover:cursor-pointer rounded-md",t),children:(0,s.jsxs)("div",{className:"block"===m?"flex flex-col h-full w-full md:flex-wrap justify-between":"flex items-center",onClick:e=>{i&&i(e),f(!0)},children:[(0,s.jsxs)("div",{className:"flex flex-col items-baseline p-2",children:[(0,s.jsx)("span",{className:"text-neutral-0 text-xs font-medium",children:a}),o&&(0,s.jsx)("span",{className:"text-primary-300 text-[9px]",children:" Current "})]}),(0,s.jsx)("div",{className:(0,b.m)("flex flex-row justify-end pr-1","block"===m?"pb-1":""),children:h&&c?(0,s.jsx)(p.J,{icon:c,size:"sm",className:"fill-neutral-300/50 stroke-neutral-300",variant:"white"}):d&&(0,s.jsx)(p.J,{icon:d,size:"sm",className:"fill-neutral-300/50 stroke-success-500",variant:"white"})})]})}),side:"top",delayDuration:.1,text:(0,s.jsx)("div",{className:"whitespace-pre-wrap",children:(0,s.jsx)(A.U,{markdown:"~~~".concat(r,"\n").concat(n,"\n~~~")})})})};var P=n(445820),I=n(232337),L=n(412937);let LanguageDropdown=e=>{var t;let{className:n,selectMenuClassName:r,selectMenuButtonClassName:o,selectMenuOptionClassName:a,customCodeEnvironments:i,selectedLanguage:d,selectedCustomCodeEnvironment:u,useFullLanguageOptions:c,disabled:p,handleLanguageChange:m,setSelectedCustomCodeEnvironment:f,onBlur:g}=e,x=(0,l.useMemo)(()=>Object.keys(h.fullLanguageMap).sort().map(e=>({id:e,name:h.fullLanguageMap[e]})),[]),v=(0,l.useMemo)(()=>{if(i&&i.length>0){let e=i.map(e=>({id:e.name,name:"*"+e.name})),t=c?x:[...h.LANGUAGE_OPTIONS,...h.SUPPORTED_PRETTY_PRINT_FORMATS],n=new Set(e.map(e=>e.id));return[...e,...t.filter(e=>!n.has(e.id))]}return c?x:[...h.LANGUAGE_OPTIONS,...h.SUPPORTED_PRETTY_PRINT_FORMATS]},[i,c,x]);return(0,s.jsx)("div",{className:(0,b.m)("flex flex-row z-[3] transform scale-[0.85]",n),children:(0,s.jsx)(L.S,{placeholder:"Select Environment",className:r,menuDirection:"bottom",selectedOptionId:null!==(t=null==u?void 0:u.name)&&void 0!==t?t:d,setSelected:e=>{let t=null==i?void 0:i.find(t=>t.name===e);t?(m(t.language),f&&f(t)):(m(e),f&&f(null))},options:v,floatStrategy:"fixed",buttonClassName:o,optionClassName:a,onBlur:g,disabled:p})})};var B=n(703647),_=n(243467);let D=B.fC,O=l.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,s.jsx)(B.ck,{ref:t,className:g()("-mt-8",n),...r})});O.displayName="AccordionItem";let F=l.forwardRef((e,t)=>{let{className:n,hint:r,children:o,...a}=e;return(0,s.jsx)(B.h4,{className:"flex",children:(0,s.jsxs)(B.xz,{ref:t,className:g()("flex flex-1 items-center text-sm transition-all justify-between [&[data-state=open]>div>svg]:rotate-90",n),...a,children:[(0,s.jsxs)("div",{className:"flex gap-2 font-bold text-neutral-0",children:[(0,s.jsx)(_.ChevronRightIcon,{className:"h-5 w-5 shrink-0 text-muted-foreground transition-transform duration-200"}),o]}),r&&(0,s.jsx)("div",{className:"text-muted-foreground",children:r})]})})});F.displayName=B.xz.displayName;let z=l.forwardRef((e,t)=>{let{className:n,children:r,...o}=e;return(0,s.jsx)(B.VY,{ref:t,className:"overflow-hidden text-sm pl-10 pr-3 data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...o,children:(0,s.jsx)("div",{className:g()("pb-0 pt-0 text-neutral-0",n),children:r})})});z.displayName=B.VY.displayName;var H=n(322107),V=n(428907),$=n(736166);(r=o||(o={})).None="none",r.ExpandAll="expand-all",r.CollapseAll="collapse-all";let{Provider:Z,useContextStore:W,useImperativeApi:U}=function(e){let t=l.createContext(void 0);return{Provider:n=>{let{children:r}=n,[o]=(0,l.useState)(()=>(0,$.M)(e));return(0,s.jsx)(t.Provider,{value:o,children:r})},useContextStore:function(e){let n=l.useContext(t);if(!n)throw Error("useContextStore must be used within a Provider");return(0,T.oR)(n,e)},useImperativeApi:function(){let e=l.useContext(t);if(!e)throw Error("useImperativeApi must be used within a Provider");return e}}}(e=>({globalValue:"none",onChangeGlobalValue:t=>{e((0,V.produce)(e=>{e.globalValue=t}))}}));function NestedAccordionsRoot(e){let{className:t,children:n}=e;return(0,s.jsx)(Z,{children:(0,s.jsx)(NestedAccordionsWrapper,{className:t,children:n})})}function NestedAccordionsWrapper(e){let{className:t,children:n}=e,{globalValue:r,onChangeGlobalValue:d}=W(e=>({globalValue:e.globalValue,onChangeGlobalValue:e.onChangeGlobalValue}));return(0,l.useEffect)(()=>{d(o.ExpandAll)},[d]),(0,s.jsxs)("div",{className:g()("relative group",t),children:[(0,s.jsxs)(i.zx,{className:"absolute top-2.5 right-3 h-6 group-hover:flex gap-2 bg-transparent hover:bg-secondary hidden",size:"sm",onClick:e=>{e.stopPropagation(),d(r===o.CollapseAll?o.ExpandAll:o.CollapseAll)},children:[(0,s.jsx)(a.FontAwesomeIcon,{icon:H.iAX}),r===o.CollapseAll?"Expand all":"Collapse all"]}),n]})}let J=(0,l.forwardRef)((e,t)=>{let{children:n,defaultValue:r,...a}=e,[i,d]=(0,l.useState)(null!=r?r:[]),{globalValue:u,onChangeGlobalValue:c}=W(e=>({globalValue:e.globalValue,onChangeGlobalValue:e.onChangeGlobalValue})),p=l.Children.count(n);return(0,l.useEffect)(()=>{d(e=>{switch(u){case o.ExpandAll:return[...Array(p).keys()].map((e,t)=>"item-".concat(t));case o.CollapseAll:return[];default:return e}})},[u,p]),(0,s.jsx)(D,{ref:t,...a,type:"multiple",value:i,onValueChange:e=>{u!==o.None&&c(o.None),d(e)},children:n})});function isPrimitive(e){return M().isNull(e)||M().isBoolean(e)||M().isNumber(e)||M().isString(e)}function RenderNull(){return(0,s.jsx)("span",{className:"text-[#ce9178] overflow-auto whitespace-pre-line break-words items-baseline",children:"Null"})}function RenderBoolean(e){let{value:t}=e;return(0,s.jsx)("span",{className:"capitalize text-[#ce9178] overflow-auto whitespace-pre-line break-words items-baseline",children:t.toString()})}function RenderNumber(e){let{value:t}=e;return(0,s.jsx)("span",{className:"text-[#b5cea8] overflow-auto whitespace-pre-line break-words items-baseline",children:t})}function RenderString(e){let{value:t}=e;return t.startsWith("http")||t.startsWith("https")?(0,s.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",style:{color:"#179fff"},className:"!text-[#179fff] overflow-auto whitespace-pre-line break-words items-baseline",children:t}):(0,s.jsx)("span",{className:"text-[#ce9178] overflow-auto whitespace-pre-line break-words items-baseline",children:t})}function RenderArray(e){let{value:t,depth:n=0}=e;return t.every(isPrimitive)?(0,s.jsx)("span",{className:"divide-x",children:t.map((e,t)=>(0,s.jsx)("span",{className:"px-2 last:pr-0 first:pl-0",children:renderValue(e)},t))}):(0,s.jsx)(J,{className:"w-full border-b-0",defaultValue:[n<=3?"item-0":""],children:t.map((e,t)=>(0,s.jsxs)(O,{value:"item-".concat(t),className:"w-full border-b-0 pb-0",children:[(0,s.jsx)(F,{className:"py-2 mb-1 pl-1 hover:bg-neutral-500 rounded",children:"Item ".concat(t+1)}),(0,s.jsx)(z,{className:"py-2 mb-3 -ml-7 pl-3 border-l border-neutral-500 overflow-scroll",children:renderValue(e,n+1)})]},t))})}function RenderObject(e){let{value:t,depth:n=1}=e;return(0,s.jsx)("div",{children:Object.entries(t).map((e,t)=>{let[r,o]=e;return isPrimitive(o)?(0,s.jsxs)("div",{style:{width:"120vw"},className:"pb-3 mb-1 pl-2 flex items-baseline",children:[(0,s.jsx)("div",{className:"whitespace-pre",children:"".concat(M().startCase(r),":")}),"\xa0",(0,s.jsx)(u.u,{asChild:!0,target:(0,s.jsx)("div",{className:"overflow-scroll",children:renderValue(o)}),text:(0,s.jsx)("div",{className:"break-words max-w-md",children:o})})]},t):(0,s.jsx)(J,{className:"w-full border-b-0",defaultValue:[n<=3?"item-0":""],children:(0,s.jsxs)(O,{value:"item-0",className:"w-full border-b-0 pb-0",children:[(0,s.jsx)(F,{className:"py-2 mb-1 pl-1 hover:bg-neutral-500 relative rounded text-neutral-0",children:"".concat(M().startCase(r),":")}),(0,s.jsx)(z,{className:"py-2 mb-3 -ml-7 pl-3 border-l border-neutral-500 overflow-scroll",children:renderValue(o,n+1)})]})},t)})})}function renderValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return M().isNull(e)?(0,s.jsx)(RenderNull,{}):M().isBoolean(e)?(0,s.jsx)(RenderBoolean,{value:e}):M().isNumber(e)?(0,s.jsx)(RenderNumber,{value:e}):M().isString(e)?(0,s.jsx)(RenderString,{value:e}):M().isArray(e)?(0,s.jsx)(RenderArray,{value:e,depth:t}):M().isObject(e)?(0,s.jsx)(RenderObject,{value:e,depth:t}):null}J.displayName="NestedAccordion";let K=l.memo(e=>{let{className:t,content:n,disableYScroll:r}=e,[o,a]=(0,l.useMemo)(()=>{try{return[JSON.parse(n),!0]}catch(e){return[n,!1]}},[n]);return a?(0,s.jsx)(NestedAccordionsRoot,{className:g()("px-3 pt-7 pb-2.5",!r&&"overflow-y-auto",t),children:renderValue(o)}):null});K.displayName="JsonRenderer";let q={json:K};var G=n(99562);let Y=(0,l.memo)(e=>{var t,n,r;let{rawCode:o,originalLanguage:f,setOpen:x,codeBlocksInMarkdownText:v,codeBlockIndex:C,customCodeEnvironments:y}=e,w=X(),{setScratchpadCodeState:k,getScratchpadCodeState:j}=R(),S=(0,l.useMemo)(()=>I.createHash("sha256").update("".concat(o,"-").concat(f,"-codingScratchpad}")).digest("hex"),[o,f]),T=null!==(t=null==y?void 0:y.find(e=>e.language===f))&&void 0!==t?t:void 0,E={code:o,language:null!==(n=null==T?void 0:T.language)&&void 0!==n?n:f,selectedCustomCodeEnvironment:T};(0,l.useEffect)(()=>{j(S)||k(S,E)},[S,j,k]);let{code:N,language:M,selectedCustomCodeEnvironment:A}=null!==(r=j(S))&&void 0!==r?r:E,L=!!h.LANGUAGE_OPTIONS.find(e=>{let{id:t}=e;return t===M})||!!A,[B,_]=(0,l.useState)(v.length>1),[D,O]=(0,l.useState)(!0),{outputTabOpen:F,outputValue:z,tab:H,isFetching:V,fetchError:$,loadingTaskIdForLogging:Z,handleExecuteCode:W,setOutputTabOpen:U,setTab:J}=(0,P.Z)({storeKey:S,code:N,language:M,customCodeEnvironment:A}),K=(0,l.useMemo)(()=>{if("json"!==M)return{formattingSuccessful:!1,formattedContent:N};let e=Q[M.toLowerCase()];return e?e(N):{formattingSuccessful:!1,formattedContent:N}},[N,M]),G=q[M],{formattingSuccessful:Y,formattedContent:ee}=K,et=!!G&&!!Y,[en,er]=(0,l.useState)(et),handleCodeChange=e=>{k(S,{code:e})},handleClickOutsideClose=e=>{e.target===e.currentTarget&&x(!1)};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"fixed top-0 left-0 w-full h-full bg-utility-black/50 flex flex-col justify-center items-center z-[2] text-danger",onClick:e=>{e.stopPropagation(),e.preventDefault(),handleClickOutsideClose(e)},children:(0,s.jsxs)("div",{className:"flex flex-row w-[80vw] h-[80vh]",children:[(0,s.jsxs)("div",{className:(0,b.m)("flex flex-col z-[2]",!en&&F?"w-9/12":"w-full"),children:[(0,s.jsxs)("div",{className:"flex flex-row rounded-t-lg h-16 justify-between bg-[#2d2d30] w-full z-50",children:[(0,s.jsx)(LanguageDropdown,{selectMenuClassName:"pl-1 pt-2",selectMenuButtonClassName:"py-0 h-12 w-40 [&>p]:m-0",selectMenuOptionClassName:"list-none w-40 py-0.5 px-0",customCodeEnvironments:y,selectedLanguage:M,selectedCustomCodeEnvironment:A,handleLanguageChange:e=>{k(S,{language:e})},setSelectedCustomCodeEnvironment:e=>k(S,{selectedCustomCodeEnvironment:e})}),L&&(0,s.jsx)("div",{className:"pt-3 pr-4",children:(0,s.jsxs)(i.zx,{className:g()("h-10",{"w-[102px]":V,"w-24":!V}),onClick:()=>W(),size:"sm",variant:"primary",disabled:V||Z,children:[V?(0,s.jsx)(d.$,{className:"",size:"xs",variant:"primary"}):(0,s.jsx)(a.FontAwesomeIcon,{icon:"play"}),(0,s.jsx)("span",{className:"pl-2",children:V?"Executing":"Run Code"})]})}),(0,s.jsxs)("div",{className:"flex flex-row pr-2 pt-4",children:[et&&(0,s.jsx)(u.u,{asChild:!0,side:"top",target:(0,s.jsx)("div",{children:(0,s.jsx)(c.r,{className:"pr-3 pb-4",checked:en,onCheckedChange:e=>er(e)})}),text:(0,s.jsx)("div",{className:"whitespace-pre-wrap bg-neutral-1000",children:en?"Show Standard View":"Show Pretty View"}),delayDuration:.1}),(0,s.jsx)(p.J,{icon:"copy",variant:"white",onClick:e=>{e.stopPropagation(),navigator.clipboard.writeText(N)},tooltipProps:{side:"top"},tooltip:"Copy Code"}),!en&&!F&&(0,s.jsx)(p.J,{icon:F?"arrow-to-left":"arrow-to-right",variant:"white",onClick:e=>{e.stopPropagation(),U(!F)},tooltipProps:{side:"top"},tooltip:"Open Output/Errors Tab"}),(0,s.jsx)(p.J,{icon:"xmark",variant:"white",onClick:e=>{e.stopPropagation(),x(!1)},tooltipProps:{side:"top"},tooltip:"Close Scratchpad"})]})]}),D&&!en&&(0,s.jsxs)("div",{className:"flex flex-row h-[4vh] bg-[#242424] px-2 justify-between items-center bg-neutral-9",children:[(0,s.jsxs)("div",{className:"flex flex-row justify-center items-center gap-1",children:[(0,s.jsx)("div",{children:(0,s.jsx)(p.J,{icon:"exclamation-circle",variant:"white",size:"sm"})}),(0,s.jsx)(m.ZT.Paragraph1,{className:"text-neutral-0 text-xs",children:"Changes made in this scratchpad won't be saved in your response."})]}),(0,s.jsx)("div",{children:(0,s.jsx)(p.J,{icon:"xmark",variant:"white",onClick:e=>{e.stopPropagation(),O(!1)},size:"sm"})})]}),en&&et?(0,s.jsx)(G,{className:(0,b.m)("bg-neutral-900 overflow-auto text-neutral-0 flex-1 w-full whitespace-pre-line rounded-b-md",w.scrollbarStyles),content:ee,disableYScroll:!0}):(0,s.jsx)("div",{className:"flex flex-col flex-1 min-h-0",children:(0,s.jsx)(CodeEditorField,{className:"flex flex-row bg-[#2d2d30] flex-1 min-h-0",value:N,onKeyDown:e=>{"Space"===e.code&&e.stopPropagation()},onChange:handleCodeChange,editorProps:{language:M,theme:"vs-dark"},editorOptions:{fontSize:14,minimap:{enabled:!0},scrollBeyondLastLine:!1,padding:{top:19,bottom:8},formatOnPaste:!0,formatOnType:!0,renderLineHighlight:"none",readOnly:!1,hover:{enabled:!1},inlineSuggest:{enabled:!0},readOnlyMessage:{value:"Editor is in read-only mode"}}})}),!en&&(0,s.jsx)(CodeContextSidebar,{className:"z-[50]",codeBlocks:v,codeBlockIndex:C,language:M,handleSetEditorCode:handleCodeChange,handleOpen:e=>_(e),open:B})]}),!en&&F&&(0,s.jsx)(coding_CodeEditorExecutionOutput,{className:"flex-1 min-w-0 h-full w-3/12",outputValue:null!=z?z:"",setOutputTabOpen:U,tab:H,setTab:J,fetchError:$,fullScreenEnabled:!0,fullWidthEnabled:!1})]})})})}),Q={json:function(e){try{let t=JSON.parse(e);return{formattingSuccessful:!0,formattedContent:JSON.stringify(t,null,2)}}catch(t){return{formattingSuccessful:!1,formattedContent:e}}}},X=(0,G.ZL)(()=>({scrollbarStyles:{"& div":{scrollbarColor:"rgba(248, 248, 242, 0.5) rgba(0, 0, 0, 0)",scrollbarWidth:"thin"}}}))},929228:function(e,t,n){"use strict";n.d(t,{LQ:function(){return extractCodeBlocks},c$:function(){return executeCodeSubmission},l0:function(){return s}});var r=n(242095),o=n(571085);let s=108e5,executeCodeSubmission=async(e,t,n,s,a)=>{let l,i;try{i=null==(l=await (0,r.fetchApi)("/genai/executeSubmission",{body:{sourceCode:e,language:t,customEnvConfig:a?{projectId:a.sphereEngineProjectId,scenarioName:a.scenario,entryPoint:a.entryPoint,customEnvName:a.name,useCustomFiles:!!a.customFiles}:void 0,assignmentId:s},maxRetries:3,method:"POST",parseAndHandle:!0,redirectOnUnauthorized:!0}))?void 0:l.success}catch(e){throw i=!1,e}finally{n&&await (0,o.Kz)(o.ju.SphereSubmissionEvent,{...n,successfulExecution:i})}return l},extractCodeBlocks=e=>{let t;let n=[],r=/```(\w*)\s*(?:\r?\n)((?:.|[\r\n])*?)(?:\r?\n)```/g;for(;null!==(t=r.exec(e));){let[,e,r]=t;n.push({language:e,code:r})}return n}},445820:function(e,t,n){"use strict";n.d(t,{Z:function(){return hooks_useCodeExecutionState}});var r=n(827378),o=n(456552),s=n(929228),a=n(556997),l=n(298784),i=n.n(l),d=n(236125),u=n(527467);let c=(0,d.Ue)()((0,u.mW)((e,t)=>({codeExecutionState:{},setCodeExecutionState:(t,n)=>{e(e=>({codeExecutionState:{...e.codeExecutionState,[t]:i().merge(e.codeExecutionState[t],n)}}))},getCodeExecutionState:e=>{let n=t().codeExecutionState[e];return n&&0!==Object.keys(n).length?n:{outputTabOpen:!1,tab:a.A.STDOUT}}})));var p=n(965167),m=n(813306),h=n(885894),f=n(789018),hooks_useCodeExecutionState=e=>{var t,n,l;let{storeKey:d,code:u,language:g,customCodeEnvironment:x,onExecutionComplete:v}=e,[b,C]=(0,r.useState)(null),[y,w]=(0,r.useState)(!1),{setCodeExecutionState:k,getCodeExecutionState:j}=c(),[S,T]=[null!==(t=j(d).outputTabOpen)&&void 0!==t&&t,e=>k(d,{outputTabOpen:e})],[E,N]=[null!==(n=j(d).tab)&&void 0!==n?n:a.A.STDOUT,e=>k(d,{tab:e})],M=(0,r.useContext)(m.p),R=(0,p.xg)(),A=(0,p.t0)(e=>e.reviewLevel),{isFetching:P,data:I}=(0,o.useQuery)(["assignmentDetails",M.assignmentId],async()=>{var e;let t=await f.Z.genai.getAssignmentDetails({assignmentId:null!==(e=M.assignmentId)&&void 0!==e?e:""});return t},{enabled:!!M.assignmentId,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,retry:!1,staleTime:s.l0}),L={taskId:null!==(l=M.taskId)&&void 0!==l?l:null==I?void 0:I.taskId,projectId:M.projectId,assignmentId:M.assignmentId,workerId:M.workerId,stepId:null==R?void 0:R.id,stepType:null==R?void 0:R.type,reviewLevel:A,timestamp:new Date,submissionType:h.U.ExecutableCodeBlock},{isFetching:B,data:_,error:D,refetch:O}=(0,o.useQuery)([d],async()=>{var e,t;let n=await (0,s.c$)(u,g,L,null!==(t=null!==(e=M.taskId)&&void 0!==e?e:M.assignmentId)&&void 0!==t?t:null==I?void 0:I.taskId,x);return n},{enabled:!1,onSettled:e=>{handleOutputDisplay(!0,e),v&&v(e)}});(0,r.useEffect)(()=>{if(_&&!y){var e;N(i().isNil(null==_?void 0:_.stderr)&&i().isNil(null==_?void 0:_.stdout)?a.A.STDOUT:(null==_?void 0:_.stderr)?a.A.STDERR:a.A.STDOUT),C(i().isNil(null==_?void 0:_.stderr)&&i().isNil(null==_?void 0:_.stdout)?"":null!==(e=null==_?void 0:_.stderr)&&void 0!==e?e:null==_?void 0:_.stdout),w(!0)}},[_]);let handleOutputDisplay=(e,t)=>{if(i().isNil(null==t?void 0:t.stderr)&&i().isNil(null==t?void 0:t.stdout)){N(a.A.STDOUT),C(""),e&&T(!0);return}i().isNil(null==t?void 0:t.stderr)?!i().isNil(null==t?void 0:t.stdout)&&(N(a.A.STDOUT),C(t.stdout),e&&T(!0)):(N(a.A.STDERR),C(t.stderr),e&&T(!0))};return{outputTabOpen:S,outputValue:b,tab:E,setOutputTabOpen:T,setTab:e=>{var t,n;e===a.A.STDOUT?(N(a.A.STDOUT),C(null!==(t=null==_?void 0:_.stdout)&&void 0!==t?t:null)):e===a.A.STDERR&&(N(a.A.STDERR),C(null!==(n=null==_?void 0:_.stderr)&&void 0!==n?n:null))},setOutputValue:C,isFetching:B,submissionResponse:_,fetchError:D,handleExecuteCode:O,loadingTaskIdForLogging:P}}},961661:function(e,t,n){"use strict";n.d(t,{f:function(){return CodeBlockCopyButton}});var r=n(824246),o=n(713222),s=n(636012),a=n.n(s),l=n(827378),i=n(720227);let CodeBlockCopyButton=e=>{let{code:t,className:n}=e,[s,d]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{if(s){let e=setTimeout(()=>d(!1),1e3);return()=>{clearTimeout(e)}}},[s]),(0,r.jsx)("span",{className:n,onClick:e=>e.stopPropagation(),children:(0,r.jsx)("button",{type:"button",onClick:()=>{a()(t),d(!0)},className:(0,i.m)("group overflow-hidden py-1 text-xs font-medium backdrop-blur transition bg-neutral-700/30 hover:bg-neutral-700/40"),children:s?(0,r.jsx)(o.J,{icon:["fas","check"],className:"w-3 h-3 fill-neutral-300/50 stroke-success-500",variant:"white"}):(0,r.jsx)(o.J,{icon:["far","clipboard"],className:"w-3 h-3 fill-neutral-300/50 stroke-neutral-300",variant:"white"})})})}},349596:function(e,t,n){"use strict";n.d(t,{Q:function(){return o},V:function(){return r}});let r={'code[class*="language-"]':{color:"#FF0000",background:"none",fontFamily:"\"Fira Code\", Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",wordWrap:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",fontSize:"10px"}},o={'code[class*="language-"]':{color:"#f8f8f2",background:"none",fontFamily:"\"Fira Code\", Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",wordWrap:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",fontSize:"10px"},'pre[class*="language-"]':{color:"#f8f8f2",background:"none",fontFamily:"\"Fira Code\", Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",wordWrap:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",overflow:"auto",borderRadius:"0.3em"},':not(pre) > code[class*="language-"]':{background:"#2E3440",padding:".1em",borderRadius:".3em",whiteSpace:"normal"},':not(pre) > pre[class*="language-"]':{background:"#2E3440"},comment:{color:"#636f88"},prolog:{color:"#636f88"},doctype:{color:"#636f88"},cdata:{color:"#636f88"},punctuation:{color:"#81A1C1"},".namespace":{Opacity:".7"},property:{color:"#81A1C1"},tag:{color:"#81A1C1"},constant:{color:"#81A1C1"},symbol:{color:"#81A1C1"},deleted:{color:"#81A1C1"},number:{color:"#B48EAD"},boolean:{color:"#81A1C1"},selector:{color:"#A3BE8C"},"attr-name":{color:"#A3BE8C"},string:{color:"#A3BE8C"},char:{color:"#A3BE8C"},builtin:{color:"#A3BE8C"},inserted:{color:"#A3BE8C"},operator:{color:"#81A1C1"},entity:{color:"#81A1C1",cursor:"help"},url:{color:"#81A1C1"},".language-css .token.string":{color:"#81A1C1"},".style .token.string":{color:"#81A1C1"},variable:{color:"#81A1C1"},atrule:{color:"#88C0D0"},"attr-value":{color:"#88C0D0"},function:{color:"#88C0D0"},"class-name":{color:"#88C0D0"},keyword:{color:"#81A1C1"},regex:{color:"#EBCB8B"},important:{color:"#EBCB8B",fontWeight:"bold"},bold:{fontWeight:"bold"},italic:{fontStyle:"italic"}}},556997:function(e,t,n){"use strict";var r,o;n.d(t,{A:function(){return r}}),(o=r||(r={})).STDOUT="stdout",o.STDERR="stderr"},367741:function(e,t,n){"use strict";n.d(t,{TG:function(){return v},ZP:function(){return Editor},RP:function(){return useEditorRendererContext}});var r=n(824246),o=n(855549),s=n(827378),a=n(60042),l=n.n(a),i=n(720227),d=n(614035),u=n(107786),c=n(901491),p=n(792739),m=n(919374),h=n(177126),f=(0,s.memo)(function(){let{editor:e}=(0,o.fi)(),[t,n]=(0,s.useState)(!1),[a,l]=(0,s.useState)(""),[i,d]=(0,s.useState)({left:0,right:0,top:0,bottom:0}),u=(0,s.useRef)(null);return((0,s.useEffect)(()=>{if(e)return e.on("transaction",handleTransaction),()=>{e.off("transaction",handleTransaction),u.current&&clearTimeout(u.current)};function handleTransaction(e){let{transaction:t}=e,r=t.getMeta(h.j.WARNING);if(r){let{message:e,coords:t}=r;l(e),d(t),n(!0),u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{n(!1)},3e3)}}},[e]),(0,s.useEffect)(()=>{function hideTooltipWhenTransactionHappens(){n(!1)}if(e){if(!t){e.off("transaction",hideTooltipWhenTransactionHappens);return}return e.on("transaction",hideTooltipWhenTransactionHappens),()=>{e.off("transaction",hideTooltipWhenTransactionHappens)}}},[e,t]),e&&t)?(0,r.jsxs)("div",{className:"flex items-center gap-2 font-medium transition-all bg-warning-50/90 text-warning-800 rounded-full px-2 py-1 fixed z-50 alert-tooltip -translate-y-[180%] -translate-x-[18px] pointer-events-none",style:{left:"".concat(i.right,"px"),top:"".concat(i.top+window.scrollY,"px")},children:[(0,r.jsx)(p.FontAwesomeIcon,{icon:m.xHz}),a]}):null}),g=n(266726),x=n.n(g);let v=(0,s.createContext)(void 0),useEditorRendererContext=()=>{let e=(0,s.useContext)(v);if(!e)throw Error("useEditorRendererContext must be used within a EditorRendererProvider");return e};function Editor(e){let{className:t,content:n,placeholder:a,disabled:p,readOnly:m,disableCopy:h,disablePaste:g,onDisabledCopy:v,onDisabledPaste:b,onContentChange:C,onEditorBlur:y,onEditorFocus:w,onJsonChange:k,enableRTL:j=!1,"data-testid":S,...T}=e,[E,N]=(0,u.Z)(!1,300),M=(0,d.Z)(C),R=(0,d.Z)(k),A=(0,d.Z)(y),P=(0,d.Z)(w),{editor:I}=(0,o.fi)(),{editorRef:L}=useEditorRendererContext(),B=(0,s.useCallback)(e=>{var t,n;let{editor:r,transaction:o}=e,s=(0,c.Xm)(r);if(!s)return;let a=o.time,l=r.getJSON();null===(t=R.current)||void 0===t||t.call(R,l),null===(n=M.current)||void 0===n||n.call(M,s(),a)},[M,R]);return(0,s.useEffect)(function(){null==I||I.setEditable(!p&&!m)},[I,p,m]),(0,s.useEffect)(function(){I&&I.commands.setTextDirection("auto")},[I]),(0,s.useEffect)(function(){if(!I)return;let onFocus=e=>{var t;let{editor:n,transaction:r,event:o}=e;N(!0);let s=(0,c.Xm)(n);s&&(null===(t=P.current)||void 0===t||t.call(P,{content:s(),timestamp:r.time,event:o}),B({editor:n,transaction:r}))},onBlur=e=>{var t;let{editor:n,transaction:r,event:o}=e;N(!1);let s=(0,c.Xm)(n);s&&(null===(t=A.current)||void 0===t||t.call(A,{content:s(),timestamp:r.time,event:o}))};return I.on("update",B),I.on("focus",onFocus),I.on("blur",onBlur),()=>{I.off("update",B),I.off("focus",onFocus),I.off("blur",onBlur)}},[I,B,N,A,P]),(0,s.useEffect)(function(){if(!I)return;let e=(0,c.BY)(I),t=x()(e,500);return t(n,E),()=>{t.cancel()}},[I,n,E]),(0,s.useEffect)(function(){I&&I.commands.updatePlaceholder(null!=a?a:"")},[I,a]),(0,s.useEffect)(function(){I&&(I.commands.updateDisableCopy(!!h),I.commands.updateDisablePaste(!!g))},[I,h,g]),(0,s.useEffect)(function(){I&&(I.storage.noCopyPaste.onDisabledCopy=v,I.storage.noCopyPaste.onDisabledPaste=b)},[I,v,b]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f,{}),(0,r.jsx)(o.kg,{...T,className:(0,i.m)(l()("relative w-full placeholder:text-neutral-100 bg-neutral-0 px-2 py-2 rounded-t-md rounded-b-md",{"cursor-not-allowed opacity-50":p,"text-right":j},t)),dir:j?"rtl":"ltr",editor:I,ref:L,"data-testid":null!=S?S:"editor-content"})]})}},826659:function(e,t,n){"use strict";var r=n(824246),o=n(827378),s=n(855549),a=n(60042),l=n.n(a),i=n(720227),d=n(378279);let u=(0,o.forwardRef)(function(e,t){let{children:n,className:o}=e,{editor:a}=(0,s.fi)(),u=(0,d.Z)();return a?(0,r.jsx)("div",{ref:t,className:(0,i.m)(l()("box-border relative leading-normal border rounded-md border-solid resize-none border-neutral-200 ring-primary-400",{"focus-within:ring-2":u},o)),children:n}):null});t.Z=(0,o.memo)(u)},874271:function(e,t,n){"use strict";n.d(t,{Z:function(){return $},C:function(){return Z}});var r=n(824246),o=n(855549),s=n(550158),a=n(60042),l=n.n(a),i=n(720227),d=n(554913),u=n(582557),c=n(908043),p=n(901491),m=n(616711),h=n(53355),f=n(583469),g=n(792739),x=n(704076),v=n(827378),b=n(834770),C=n(713222);let y=(0,v.memo)(e=>{var t,n;let{isRunningCodeExecution:o,codeExecutionResponse:s}=e,a=(null!==(t=null==s?void 0:s.stdout)&&void 0!==t?t:"").trim(),l=(null!==(n=null==s?void 0:s.stderr)&&void 0!==n?n:"").trim();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 px-4 border-border border-t",children:[(0,r.jsx)("div",{className:"text-muted-contrast",children:"Output"}),(0,r.jsx)(b.u,{text:"Copy output to clipboard",target:(0,r.jsx)(C.J,{icon:"copy",onClick:()=>{navigator.clipboard.writeText(JSON.stringify(null!=s?s:"",null,2))}})})]}),(0,r.jsx)("div",{className:"pb-2 px-4",children:o?(0,r.jsx)("div",{className:"text-muted-contrast",children:"Running code execution..."}):a||l?(0,r.jsxs)(r.Fragment,{children:[a?(0,r.jsx)("div",{className:"text-contrast",children:a}):null,l?(0,r.jsx)("div",{className:"text-error-text",children:l}):null]}):s?(0,r.jsx)("div",{className:"text-muted-contrast",children:"Ok"}):null})]})});var w=n(780892),k=n(89916),j=n(929228);function isSupportedCodeRunLanguage(e){return k.LANGUAGE_OPTIONS.some(t=>{let{id:n}=t;return n===e})}var S=n(412937),T=n(107786),E=n(813306),N=n(729205);let M={javascript:"js",js:"js",typescript:"ts",ts:"ts",python:"python",java:"java",shell:"sh",c:"c",cpp:"cpp",jsx:"jsx",json:"json",plaintext:"text",html:"html",swift:"swift",go:"go",csharp:"csharp"},R={javascript:"JavaScript",js:"JavaScript",typescript:"TypeScript",ts:"TypeScript",python:"Python",java:"Java",shell:"BashScript",c:"C",cpp:"C++",jsx:"JSX",json:"JSON",plaintext:"Plaintext",html:"HTML",swift:"Swift",go:"Go",csharp:"C#"},A=Object.entries(M).reduce((e,t)=>{let[n,r]=t;return e[r]=n,e},{}),P=(0,v.memo)(e=>{var t,n,s,a,l,i,d;let{editor:u,node:c,getPos:p,updateAttributes:h}=e,{enableFactChecker:C}=(0,v.useContext)(E.p),k=A[null==c?void 0:null===(t=c.attrs)||void 0===t?void 0:t.language]||A.text,[P,I]=(0,v.useState)(!u.isEditable),[L,B]=(0,T.Z)("",200),_=(0,N.y)(e=>e.setSelection),D=null!==(d=null==c?void 0:null===(a=c.content)||void 0===a?void 0:null===(s=a.content)||void 0===s?void 0:null===(n=s[0])||void 0===n?void 0:n.text)&&void 0!==d?d:"",O=null===(l=u.extensionStorage.noCopyPaste)||void 0===l?void 0:l.disableCopy,F=null===(i=u.extensionStorage.noCopyPaste)||void 0===i?void 0:i.disablePaste,[z,H]=(0,v.useState)(null),[V,$]=(0,v.useState)(400);(0,v.useEffect)(()=>{let handleEditableChange=e=>{let{editor:t}=e;I(!t.isEditable)};return u.on("update",handleEditableChange),()=>{u.off("update",handleEditableChange)}},[u]);let Z=(0,v.useCallback)(()=>{let{state:e,dispatch:t}=u.view,{tr:n}=e,r=p(),o=n.setSelection(m.Bs.near(n.doc.resolve(Math.max(0,r))));t(o)},[p,u]),W=(0,v.useCallback)(()=>{if(!u.isEditable)return;let{state:e,dispatch:t}=u.view,{tr:n}=e,r=p();n.delete(r,r+c.nodeSize),u.commands.focus(r>0?r-1:r),t(n)},[p,u.isEditable,u.commands,u.view,c.nodeSize]),U=(0,v.useCallback)(e=>{H(e),$(e.getContentHeight())},[]);(0,v.useEffect)(()=>{let updateEditorHeight=()=>{z&&$(z.getContentHeight())},e=null==z?void 0:z.onDidChangeCursorSelection(()=>{var e;let t=(null===(e=z.getModel())||void 0===e?void 0:e.getValueInRange(z.getSelection()||{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}))||"";B(t)}),t=null==z?void 0:z.onDidChangeModelLanguageConfiguration(updateEditorHeight),n=null==z?void 0:z.onDidLayoutChange(updateEditorHeight),r=null==z?void 0:z.onKeyDown(e=>{let{state:t}=u.view,{doc:n}=t,r=p();if("Backspace"===e.code){let e=n.nodeAt(r);(null==e?void 0:e.textContent)||W()}if("ArrowDown"===e.code){let e=z.getPosition(),t=z.getModel();if(null===t||null===e)return;let n=t.getLineCount();e.lineNumber===n&&(u.commands.exitCode(),u.commands.focus())}if("ArrowUp"===e.code){let e=z.getPosition();(null==e?void 0:e.lineNumber)===1&&(u.commands.insertParagraphBefore(),u.commands.focus())}O&&(e.ctrlKey||e.metaKey)&&33===e.keyCode&&e.preventDefault(),F&&(e.ctrlKey||e.metaKey)&&52===e.keyCode&&e.preventDefault()}),o=null==z?void 0:z.onDidFocusEditorWidget(()=>{Z(),z.focus()});return()=>{null==e||e.dispose(),null==t||t.dispose(),null==n||n.dispose(),null==o||o.dispose(),null==r||r.dispose()}},[z,B,p,Z,u,W]),(0,v.useEffect)(()=>{L||u.commands.setCopilotOpen(!1)},[u,L,_,p]);let J=(0,v.useCallback)(()=>{if(!u)return;let e=p();u.commands.setCopilotSelection({empty:""===L,text:L,from:Math.max(0,e),to:0}),u.commands.setCopilotOpen(!0)},[u,L,p]),K=(0,v.useCallback)(e=>{let t;let{state:n,dispatch:r}=u.view,{tr:o}=n,s=n.schema.nodes.executableCodeBlock,a=p();if(e!==c.content.textBetween(0,c.content.size,"")){if(e){let r=s.create({...c.attrs},n.schema.text(e));t=o.replaceWith(a,a+c.nodeSize,r)}else{let e=s.create({...c.attrs});t=o.replaceWith(a,a+c.nodeSize,e)}t.setSelection(m.Bs.near(o.doc.resolve(Math.max(0,a)))),r(t)}},[p,u,c]),[{loading:q,value:G},Y]=function(e){let{language:t,code:n,assignmentId:r="assignmentId",customCodeEnvironment:o}=e;return(0,w.Z)(async()=>{if(!isSupportedCodeRunLanguage(t))return{success:!1,stderr:"Language not supported",stdout:""};try{return await (0,j.c$)(n,t,void 0,r,o)}catch(t){var e;return console.error(t),{success:!1,stderr:null!==(e=null==t?void 0:t.message)&&void 0!==e?e:"Error",stdout:""}}},[t,n])}({language:k,code:D}),Q=D.length>1e4?{folding:!1,renderLineHighlight:"none",scrollBeyondLastLine:!1,automaticLayout:!0,wordWrap:"off",occurrencesHighlight:!1,selectionHighlight:!1,renderWhitespace:"none",suggestOnTriggerCharacters:!1,tabCompletion:"off",contextmenu:!1,quickSuggestions:!1,renderIndentGuides:!1}:{};return(0,r.jsxs)(o.T5,{as:"div",contentEditable:!1,dir:"auto",className:"react-monaco-code-block bg-neutral-800 not-wysiwyg font-mono text-neutral-0 border-neutral-700 border rounded overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center py-2 px-4 gap-5 border-neutral-700 border-b rounded-t",children:[(0,r.jsx)("div",{children:(0,r.jsx)(S.S,{isInPortal:!0,menuDirection:"bottom",optionsClassName:"scale-theme border border-neutral-400",disabled:P,selectedOptionId:k,options:Object.keys(M).map(e=>({id:e,name:R[e]})),setSelected:e=>{h({language:M[e]})}})}),isSupportedCodeRunLanguage(k)&&(0,r.jsx)(b.u,{text:q?"Running code execution...":"Run code execution",target:(0,r.jsx)("div",{className:"flex items-center",onClick:q?void 0:Y,children:(0,r.jsx)(g.FontAwesomeIcon,{className:"text-muted-contrast cursor-pointer h-4 w-4",spin:q,icon:q?f.LM3:f.zc})})}),!O&&(0,r.jsx)(b.u,{text:"Copy code to clipboard",target:(0,r.jsx)(g.FontAwesomeIcon,{className:"text-muted-contrast cursor-pointer",icon:f.kZ_,onClick:e=>{e.preventDefault(),navigator.clipboard.writeText(D)}})}),u.isEditable&&(0,r.jsx)(b.u,{text:"Delete code block",target:(0,r.jsx)("div",{className:"flex items-center cursor-pointer",children:(0,r.jsx)(g.FontAwesomeIcon,{onClick:W,icon:f.XAH,className:"text-muted-contrast cursor-pointer h-4 w-4"})})}),L&&C&&(0,r.jsx)(b.u,{text:"Copilot",target:(0,r.jsx)("div",{className:"flex items-center cursor-pointer",children:(0,r.jsx)(g.FontAwesomeIcon,{onClick:J,icon:f.Y$T,className:"text-muted-contrast cursor-pointer h-4 w-4"})})}),D.length>1e4&&(0,r.jsx)(b.u,{text:"Some features have been disabled due to the long code block",target:(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(g.FontAwesomeIcon,{icon:f.sqG,className:"text-muted-contrast cursor-pointer h-4 w-4"})})})]}),(0,r.jsxs)("div",{className:"pr-4",children:[(0,r.jsx)(x.default,{theme:"vs-dark",height:V,wrapperProps:{className:"reset-all-css rounded-b"},value:D,language:D.length>1e4?"plaintext":k,options:{lineNumbers:"on",roundedSelection:!1,scrollBeyondLastLine:!1,minimap:{enabled:!1},padding:{top:10,bottom:10},lineDecorationsWidth:5,lineNumbersMinChars:4,unicodeHighlight:{ambiguousCharacters:!1},wordWrap:"on",overviewRulerBorder:!1,domReadOnly:P,readOnly:P,...Q},onMount:U,onChange:e=>{z&&($(z.getContentHeight()),null==K||K(e))}}),(q||G)&&(0,r.jsx)(y,{isRunningCodeExecution:q,codeExecutionResponse:G})]})]})}),I="language-",L=/^```([a-z]+)?[\s\n]$/,B=h.NB.create({name:"executableCodeBlock",content:"text*",group:"block",marks:"",code:!0,defining:!0,addStorage:()=>({markdown:{serialize(e,t){let n=t.textContent||"";e.write("```"+(t.attrs.language||"")),e.write("\n"),e.text(n,!1),e.ensureNewLine(),e.write("```"),e.closeBlock(t)},parse:{setup(e){var t;e.set({langPrefix:null!==(t=this.options.languageClassPrefix)&&void 0!==t?t:"language-"})},updateDOM(e){e.innerHTML=e.innerHTML.replace(/\n<\/code><\/pre>/g,"</code></pre>")}}}}),addAttributes:()=>({language:{default:null,parseHTML:e=>{var t;let n=[...(null===(t=e.firstElementChild)||void 0===t?void 0:t.classList)||[]],r=n.filter(e=>e.startsWith(I)).map(e=>e.replace(I,"")),o=r[0];return o||null},rendered:!1}}),parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML(e){let{node:t,HTMLAttributes:n}=e;return["pre",n,["code",{class:t.attrs.language?I+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>t=>{let{commands:n}=t;return n.setNode(this.name,e)},toggleCodeBlock:e=>t=>{let{commands:n}=t;return n.toggleNode(this.name,"paragraph",e)},insertParagraphBefore:()=>e=>{let{tr:t,dispatch:n,state:{schema:r}}=e,{selection:o}=t,{$from:s}=o,a=s.before(s.depth),l=r.nodes.paragraph.create(),i=t.insert(a,l),d=a+1;return i.setSelection(m.Bs.create(t.doc,d)),n&&n(i),!0}}},addKeyboardShortcuts:()=>({}),addInputRules(){return[(0,h.zK)({find:L,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new m.Sy({key:new m.H$("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;let n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),o=r?JSON.parse(r):void 0,s=null==o?void 0:o.mode;if(!n||!s)return!1;let{tr:a,schema:l}=e.state,i=l.text(n.replace(/\r\n?/g,"\n"));return a.replaceSelectionWith(this.type.create({language:s},i)),a.selection.$from.parent.type!==this.type&&a.setSelection(m.Bs.near(a.doc.resolve(Math.max(0,a.selection.from-2)))),a.setMeta("paste",!0),e.dispatch(a),!0}}})]},addNodeView:()=>(0,o.fW)(P)});var _=n(51446),D=n(367741),O=n(657097),F=n(938910),z=n(568334),H=n(177126),V=n(84605);let $={boldToken:F.BoldToken.ASTERISK,italicToken:F.ItalicToken.ASTERISK,bulletListToken:F.BulletListToken.ASTERISK,mathToken:F.MathToken.DOLLARS};function DefaultTokenConfigWatcher(e){let{defaultTokens:t=$}=e,{editor:n}=(0,o.fi)();return(0,v.useEffect)(()=>{n&&(n.storage.markdownExtensions.boldToken=t.boldToken,n.storage.markdownExtensions.italicToken=t.italicToken,n.storage.markdownExtensions.bulletListToken=t.bulletListToken,n.storage.markdownExtensions.mathToken=t.mathToken)},[n,t]),null}var Z=(0,v.memo)(function(e){let{className:t,children:n,extensions:a,initialContent:m,defaultTokens:h=$,enableMath:f=!1,enableCourseTools:g=!1,enableHtml:x=!1}=e,b=(0,v.useRef)(null),C=(0,o.jE)({content:m,immediatelyRender:!1,extensions:[c.Z,_.Z.configure({enableMath:f,enableCourseTools:g,enableHtml:x,boldToken:h.boldToken,italicToken:h.italicToken,bulletListToken:h.bulletListToken,mathToken:h.mathToken}),p.ZP.configure({type:"markdown",isCourseEditor:g}),s.V.configure({text:!1,bold:!1,italic:!1,bulletList:!1,listItem:!1,codeBlock:!1,paragraph:!1}),u.Z,d.Z,B,O.ZP.configure({classes:{base:"comment hover:cursor-pointer",selection:"bg-warning-100",comment:"bg-primary-100 hover:bg-primary-200",selectedComment:"bg-primary-200"}}),z.Z,H.Z,V.Z,...null!=a?a:[]],editorProps:{attributes:{class:(0,i.m)(l()("relative max-w-none [&>pre]:p-2 [&>pre]:rounded-lg focus:outline-none min-h-[60px] text-neutral-800 scale-tailwind wysiwyg wysiwyg-chat wysiwyg-sm",t))}}},[f,null==h?void 0:h.mathToken]);return C?(0,r.jsxs)(o.rU.Provider,{value:{editor:C},children:[(0,r.jsx)(DefaultTokenConfigWatcher,{defaultTokens:h}),(0,r.jsx)(D.TG.Provider,{value:{editorRef:b},children:n})]}):null})},210559:function(e,t,n){"use strict";n.d(t,{Z:function(){return PlainTextEditorContext}});var r=n(824246),o=n(855549),s=n(60042),a=n.n(s),l=n(53355);let i=l.hj.create({name:"disableAllShortcuts",addKeyboardShortcuts:()=>({"Mod-b":()=>!0,"Mod-i":()=>!0,"Mod-u":()=>!0,"Mod-shift-x":()=>!0,"Mod-shift-h":()=>!0,"Mod-e":()=>!0,"Mod-alt-0":()=>!0,"Mod-alt-1":()=>!0,"Mod-alt-2":()=>!0,"Mod-alt-3":()=>!0,"Mod-alt-4":()=>!0,"Mod-alt-5":()=>!0,"Mod-alt-6":()=>!0,"Mod-shift-7":()=>!0,"Mod-shift-8":()=>!0,"Mod-shift-9":()=>!0,"Mod-shift-b":()=>!0,"Mod-shift-l":()=>!0,"Mod-shift-e":()=>!0,"Mod-shift-r":()=>!0,"Mod-shift-j":()=>!0,"Mod-alt-c":()=>!0,"Mod-,":()=>!0,"Mod-.":()=>!0,Enter:e=>{let{editor:t}=e;return t.commands.keyboardShortcut("shift-Enter")}})});var d=n(56065);let u=d.U.extend({addStorage:()=>({markdown:{serialize:(e,t,n,r)=>{for(let e=r+1;e<n.childCount;e++)if(n.child(e).type===t.type)continue;let o="inTable"in e&&e.inTable;e.write(o?"<br>":"\n")},parse:{}}})});var c=n(554913),p=n(582557),m=n(908043);let h=l.hj.create({addKeyboardShortcuts:()=>({Enter:e=>{let{editor:t}=e;return t.commands.setHardBreak()},"Shift-Enter":()=>!0})});var f=n(901491),g=n(550158),x=n(827378),v=n(367741),b=n(657097),C=n(568334),y=n(102396),w=n(177126),k=n(84605);function PlainTextEditorContext(e){var t;let{children:n,extensions:s,initialContent:l,editorProps:d}=e,j=(0,x.useRef)(null),S=null==s?void 0:null===(t=s.find(e=>"mention"===e.name))||void 0===t?void 0:t.options,T=(0,f.Uk)(null!=l?l:"",S),E=(0,o.jE)({content:T,immediatelyRender:!1,parseOptions:{preserveWhitespace:"full"},extensions:[m.Z,f.ZP.configure({type:"text"}),g.Z.configure({blockquote:!1,bold:!1,bulletList:!1,code:!1,codeBlock:!1,heading:!1,listItem:!1,orderedList:!1,strike:!1,italic:!1,hardBreak:!1}),u,p.Z,c.Z,i,h,b.ZP.configure({classes:{base:"comment hover:cursor-pointer",selection:"bg-warning-100",comment:"bg-primary-100 hover:bg-primary-200",selectedComment:"bg-primary-200"}}),C.Z,w.Z,k.Z,...null!=s?s:[]],editorProps:{attributes:{class:a()("relative wysiwyg wysiwyg-sm max-w-none [&>pre]:p-2 [&>pre]:rounded-lg wysiwyg-p:text-neutral-800 focus:outline-none min-h-[60px]")},...d,handlePaste(e,t){var n;let r=null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text/plain");if(!r)return!1;let o=(0,f.vT)(r,S),s=o.map(t=>"text"===t.type?e.state.schema.text(t.text):"hardBreak"===t.type?e.state.schema.node("hardBreak"):"mention"===t.type?e.state.schema.node("mention"):null).filter(Boolean),a=y.HY.fromArray(s),l=e.state.tr.replaceSelectionWith(a,!1);return e.dispatch(l),!0}}},[]);return E?(0,r.jsx)(o.rU.Provider,{value:{editor:E},children:(0,r.jsx)(v.TG.Provider,{value:{editorRef:j},children:n})}):null}},378279:function(e,t,n){"use strict";n.d(t,{Z:function(){return useIsEditorEditable}});var r=n(855549),o=n(827378);function useIsEditorEditable(){var e;let{editor:t}=(0,r.fi)(),[n,s]=(0,o.useState)(null!==(e=null==t?void 0:t.isEditable)&&void 0!==e&&e);return(0,o.useEffect)(()=>{if(t)return s(t.isEditable),t.on("update",handleIsEditableChange),()=>{t.off("update",handleIsEditableChange)};function handleIsEditableChange(e){let{editor:t}=e;s(t.isEditable)}},[t]),n}},28590:function(e,t,n){"use strict";n.d(t,{ML:function(){return c.ZP},Nf:function(){return i.Z},bk:function(){return FooterContainer},UV:function(){return C},yD:function(){return T.yD},u3:function(){return ea},LZ:function(){return u.Z},Tg:function(){return T.Tg},MB:function(){return f},Tw:function(){return j},qe:function(){return w.Z},bI:function(){return EditorWordCounter}});var r,o,s=n(824246),a=n(827378),l=n(792739);n(331542),n(298784),n(352991),(r=o||(o={})).SelectedMatchUpdated="selectedMatchUpdated",r.LoadingUpdated="languageToolLoading",r.ErrorsUpdated="languageToolError",r.IgnoredWordsUpdated="languageToolIgnoredWords";var i=n(826659),d=n(720227);function FooterContainer(e){let{children:t,className:n}=e;return t?(0,s.jsx)("div",{className:(0,d.m)("border-t border-neutral-200 px-2 py-1 bg-neutral-50 rounded-b",n),children:t}):null}var u=n(210559),c=n(367741),p=n(855549),m=n(60042),h=n.n(m),f=(0,a.memo)(function(e){let{className:t,content:n,disableCopy:r,onDisabledCopy:o,textDirection:l,...i}=e,{editor:u}=(0,p.fi)(),{editorRef:m}=(0,c.RP)();return(0,a.useEffect)(function(){null==u||u.setEditable(!1)},[u]),(0,a.useEffect)(function(){u&&u.commands.updateDisableCopy(!!r)},[u,r]),(0,a.useEffect)(function(){u&&(u.storage.noCopyPaste.onDisabledCopy=o)},[u,o]),(0,s.jsx)(p.kg,{...i,className:(0,d.m)(h()("relative w-full placeholder:text-muted-foreground px-2 py-2",{"text-right":"rtl"===l},t)),dir:l,editor:u,ref:m})}),g=n(282258),x=n(901491);function EditorWordCounter(){var e;let{editor:t}=(0,p.fi)(),[n,r]=(0,a.useState)(null!==(e=null==t?void 0:t.getText())&&void 0!==e?e:"");return((0,a.useEffect)(()=>{if(!t)return;let handleUpdate=e=>{let{editor:t}=e,n=(0,x.Xm)(t);n&&r(n())};return t.on("update",handleUpdate),()=>{t.off("update",handleUpdate)}},[t]),t)?(0,s.jsx)(g.Z,{text:n,active:t.isEditable}):null}var v=n(53355);let b=v.hj.create({name:"keyHandler",addOptions:()=>({shortcuts:{}}),addKeyboardShortcuts(){return this.options.shortcuts}});var C=b;n(999883);var y=n(214317),w=n(470623),k=n(767906),j=(0,a.memo)(function(){let{editor:e}=(0,p.fi)();return e?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(y.Z,{name:"ReadOnlyFloatingMenu",shouldShow:e=>{let{editor:t}=e;return!t.isEditable&&!t.state.selection.empty},children:(0,s.jsx)(k.k,{})})}):null}),S=n(657097),T=n(937057),E=n(874271),N=n(550158),M=n(554913),R=n(908043),A=n(782195),P=n(616711),I=n(353553),L=n(196920);function getHighlightNodes(e){return e.value||e.children||[]}function getDecorations(e){let{doc:t,name:n,lowlight:r,defaultLanguage:o}=e,s=[];return(0,v.N2)(t,e=>e.type.name===n).forEach(e=>{var t;let n=e.pos+1,a=e.node.attrs.language||o,l=r.listLanguages(),i=a&&(l.includes(a)||L.Z.getLanguage(a)||(null===(t=r.registered)||void 0===t?void 0:t.call(r,a)))?getHighlightNodes(r.highlight(a,e.node.textContent)):getHighlightNodes(r.highlightAuto(e.node.textContent));(function parseNodes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.map(e=>{let n=[...t,...e.properties?e.properties.className:[]];return e.children?parseNodes(e.children,n):{text:e.value,classes:n}}).flat()})(i).forEach(e=>{let t=n+e.text.length;if(e.classes.length){let r=I.p.inline(n,t,{class:e.classes.join(" ")});s.push(r)}n=t})}),I.EH.create(t,s)}var B=n(831089),_=n(202537),D=n(961661),O=n(89916);let getReadableLanguage=e=>O.fullLanguageMap[e]||e.toUpperCase();var F=(0,a.memo)(function(e){var t,n,r,o,i,u;let{node:c,extension:m}=e,f=null!==(i=null==c?void 0:null===(r=c.content)||void 0===r?void 0:null===(n=r.content)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.text)&&void 0!==i?i:"",g=null!==(u=null==c?void 0:null===(o=c.attrs)||void 0===o?void 0:o.language)&&void 0!==u?u:"plaintext",[x,v]=(0,a.useState)(m.options.defaultExpanded),b=null!=g?g:"",toggleExpand=e=>{e.stopPropagation(),v(!x)},C=f.split(/\r\n|\r|\n/).length;return(0,s.jsx)(p.T5,{className:"hljs rounded-md",children:(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:(0,d.m)("group bg-transparent relative px-0 py-0 scale-theme",x?"overflow-auto":"overflow-hidden"),children:[(0,s.jsxs)("div",{className:"text-white text-xs font-medium font-mono px-3 flex items-center justify-between bg-neutral-800 rounded-t-md py-1.5",children:[(0,s.jsx)("span",{className:"text-neutral-0",children:getReadableLanguage(b)}),(0,s.jsxs)("div",{className:"flex items-center justify-end",children:[(0,s.jsx)("div",{className:"pl-2 pr-3 pt-1",children:(0,s.jsx)(D.f,{code:f})}),C>15&&x&&(0,s.jsxs)("button",{onClick:e=>toggleExpand(e),className:"border ml-1 rounded-md py-1.5 px-2 text-xs flex items-center justify-center bg-neutral-600 border-neutral-500 text-neutral-0",children:["Collapse",(0,s.jsx)(l.FontAwesomeIcon,{icon:"chevron-up",className:"ml-1"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:h()("p-3 bg-neutral-900",x?"max-h-[900px] overflow-auto rounded-b-md":"max-h-[290px] overflow-hidden"),children:(0,s.jsx)(p.ms,{className:"not-wysiwyg font-mono"})}),C>15&&!x&&(0,s.jsx)("div",{className:"flex font-mono items-center justify-center py-2 text-white text-xs font-medium bg-neutral-900 rounded-b-md",children:(0,s.jsxs)("button",{onClick:e=>toggleExpand(e),className:"border ml-1 text-white rounded-md py-1.5 px-2 text-xs flex items-center justify-center bg-neutral-600 border-neutral-500 text-neutral-0",children:["Expand",(0,s.jsx)(l.FontAwesomeIcon,{icon:"chevron-down",className:"ml-1"})]})})]})]})})})}),z=n(722030),H=n(713222),V=n(257770),$=n(424727),Z=n(63275),W=n(445820),U=n(813306),J=n(232337),K=n(929228);let CodeBlockPreviewWithExecutionNodeView_getReadableLanguage=e=>O.fullLanguageMap[e]||e.toUpperCase();var q=(0,a.memo)(function(e){var t,n,r,o,i,u,c;let{editor:m,node:f,extension:g}=e,[v]=(0,a.useState)(!1),b=null!==(u=null==f?void 0:null===(r=f.content)||void 0===r?void 0:null===(n=r.content)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.text)&&void 0!==u?u:"",C=null!==(c=null==f?void 0:null===(o=f.attrs)||void 0===o?void 0:o.language)&&void 0!==c?c:"plaintext",y=(0,x.Xm)(m),w=y(),k=(0,K.LQ)(w),j=k.findIndex(e=>e.code===String(b).replace(/\n$/,"")),[S,T]=(0,a.useState)(g.options.defaultExpanded),E=null!=C?C:"",N=(0,a.useContext)(U.p),M=null==N?void 0:null===(i=N.codingConfig)||void 0===i?void 0:i.customCodeEnvironments,R=(null==M?void 0:M.length)===1||(!M||0===M.length)&&!!O.LANGUAGE_OPTIONS.find(e=>{let{id:t}=e;return t===E}),A=(0,a.useMemo)(()=>v?"":J.createHash("sha256").update("".concat(b,"-").concat(E,"-executableCodeBlock")).digest("hex"),[b,E,v]),{getScratchpadOpenState:P,setScratchpadOpenState:I}=(0,Z.U)(),[L,B]=[P(A),e=>I(A,e)],{outputTabOpen:_,outputValue:F,tab:q,isFetching:G,fetchError:Y,loadingTaskIdForLogging:Q,handleExecuteCode:X,setOutputTabOpen:ee,setTab:et}=(0,W.Z)({storeKey:A,code:b,language:E,customCodeEnvironment:null==M?void 0:M[0]}),toggleExpand=e=>{e.stopPropagation(),T(!S)},en=b.split(/\r\n|\r|\n/).length;return(0,s.jsx)(p.T5,{className:"hljs rounded-md",children:(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:(0,d.m)("group bg-transparent relative px-0 py-0 scale-theme",S?"overflow-auto":"overflow-hidden"),children:[(0,s.jsxs)("div",{className:"text-white text-xs font-medium font-mono px-3 flex items-center justify-between bg-neutral-800 rounded-t-md py-1.5",children:[(0,s.jsx)("span",{className:"text-neutral-0",children:CodeBlockPreviewWithExecutionNodeView_getReadableLanguage(E)}),(0,s.jsxs)("div",{className:"flex items-center justify-end",children:[!v&&R&&(0,s.jsx)("div",{className:"pr-1",children:G?(0,s.jsx)(z.$,{className:"pr-2",size:"xs",variant:"primary"}):(0,s.jsx)(H.J,{icon:["far","play"],className:"hover:bg-neutral-700/40",variant:"white",onClick:e=>{e.stopPropagation(),X()},disabled:G||Q,tooltip:"Run Code",tooltipProps:{side:"top",delayDuration:100},"data-testid":"run-code-button"})}),!v&&M&&(null==M?void 0:M.length)>1&&(0,s.jsx)(H.J,{icon:["far","exclamation-circle"],className:"hover:bg-neutral-800",variant:"white",tooltip:"Please use the coding scratchpad (click on the pencil icon to the right) to execute and test your code.",tooltipProps:{side:"top",delayDuration:100}}),!v&&(0,s.jsx)("div",{className:"pr-1",children:(0,s.jsx)(H.J,{icon:["far","pen"],className:"hover:bg-neutral-700/40",variant:"white",onClick:e=>{e.stopPropagation(),e.preventDefault(),B(!0)},tooltip:"Scratchpad (changes made are not saved)",tooltipProps:{side:"top",delayDuration:100}})}),(0,s.jsx)("div",{className:"pl-2 pr-3 pt-1",children:(0,s.jsx)(D.f,{code:b})}),en>11&&S&&(0,s.jsxs)("button",{onClick:e=>toggleExpand(e),className:"border ml-1 rounded-md py-1.5 px-2 text-xs flex items-center justify-center bg-neutral-600 border-neutral-500 text-neutral-0",children:["Collapse",(0,s.jsx)(l.FontAwesomeIcon,{icon:"chevron-up",className:"ml-1"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:h()("p-3 bg-neutral-900",S?"max-h-[900px] overflow-auto rounded-b-md":"max-h-[290px] overflow-hidden"),children:(0,s.jsx)(p.ms,{className:"not-wysiwyg font-mono"})}),en>11&&!S&&(0,s.jsx)("div",{className:"flex items-center justify-center py-2 text-white text-xs font-medium font-mono bg-neutral-900 rounded-b-md",children:(0,s.jsxs)("button",{onClick:e=>toggleExpand(e),className:"border ml-1 text-white rounded-md py-1.5 px-2 text-xs flex items-center justify-center bg-neutral-600 border-neutral-500 text-neutral-0",children:["Expand",(0,s.jsx)(l.FontAwesomeIcon,{icon:"chevron-down",className:"ml-1"})]})})]}),"text"!==E&&_&&(0,s.jsx)("div",{className:"border-none pt-4",onClick:e=>e.stopPropagation(),children:(0,s.jsx)(V.Z,{className:"w-full h-40 p-0 whitespace-pre-line",outputValue:null!=F?F:"",setOutputTabOpen:ee,tab:q,setTab:et,fetchError:Y,fullScreenEnabled:!1,fullWidthEnabled:!0})}),L&&(0,s.jsx)("div",{className:"fixed top-0 left-0 w-full h-full bg-utility-black/50 flex flex-col justify-center items-center z-[100]",children:(0,s.jsx)($.Q,{rawCode:b,originalLanguage:E,codeBlocksInMarkdownText:k,setOpen:B,codeBlockIndex:j,customCodeEnvironments:M})})]})})})});let G=(0,B.B)(_.y),Y=A.ZP.extend({addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),enableCodeExecution:!1,languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,defaultExpanded:!0,HTMLAttributes:{class:"hljs"}}},addStorage:()=>({markdown:{serialize(e,t){let n=t.textContent||"";e.write("```"+(t.attrs.language||"")),e.write("\n"),e.text(n,!1),e.ensureNewLine(),e.write("```"),e.closeBlock(t)},parse:{setup(e){var t;e.set({langPrefix:null!==(t=this.options.languageClassPrefix)&&void 0!==t?t:"language-"})},updateDOM(e){e.innerHTML=e.innerHTML.replace(/\n<\/code><\/pre>/g,"</code></pre>")}}}}),addProseMirrorPlugins(){var e;return[...(null===(e=this.parent)||void 0===e?void 0:e.call(this))||[],function(e){let{name:t,lowlight:n,defaultLanguage:r}=e;if(!["highlight","highlightAuto","listLanguages"].every(e=>"function"==typeof n[e]))throw Error("You should provide an instance of lowlight to use the code-block-lowlight extension");let o=new P.Sy({key:new P.H$("lowlight"),state:{init:(e,o)=>{let{doc:s}=o;return getDecorations({doc:s,name:t,lowlight:n,defaultLanguage:r})},apply:(e,o,s,a)=>{let l=s.selection.$head.parent.type.name,i=a.selection.$head.parent.type.name,d=(0,v.N2)(s.doc,e=>e.type.name===t),u=(0,v.N2)(a.doc,e=>e.type.name===t);return e.docChanged&&([l,i].includes(t)||u.length!==d.length||e.steps.some(e=>void 0!==e.from&&void 0!==e.to&&d.some(t=>t.pos>=e.from&&t.pos+t.node.nodeSize<=e.to)))?getDecorations({doc:e.doc,name:t,lowlight:n,defaultLanguage:r}):o.map(e.mapping,e.doc)}},props:{decorations:e=>o.getState(e)}});return o}({name:this.name,lowlight:G,defaultLanguage:this.options.defaultLanguage})]},addNodeView(){return this.options.enableCodeExecution?(0,p.fW)(q):(0,p.fW)(F)}});var Q=n(51446),X=n(568334),ee=n(177126),et=n(266726),en=n.n(et);let er=new Set(["THEAD","TBODY"]),eo=v.NB.create({name:"anyhtml",priority:0,content:"(anyhtml|text)*",atom:!0,group:"inline",inline:!0,addAttributes:()=>({tag:{default:null},attrRecord:{default:{}}}),parseHTML:()=>[{tag:"*",getAttrs:e=>{let t=e.tagName;if(er.has(t))return!1;let n=e.getAttributeNames(),r={};for(let t of n){let n=e.getAttribute(t);null!=n&&(r[t]=n)}return{attrRecord:r,tag:t}}}],renderHTML(e){let{HTMLAttributes:{tag:t,attrRecord:n}}=e;return[t,n,0]}});var es=n(16985),ea=(0,a.memo)(function(e){let{className:t,children:n,extensions:r,content:o,defaultTokens:l=E.Z,enableMath:i=!1,enableHtml:u=!1,enableSoftBreaks:m=!1,enableCodeExecution:f=!1,enableSingleDollarTextMath:g=!1,defaultExpandCodeBlocks:v=!0,shouldDebounceContentUpdates:b=!0,isCoursePreview:C=!1}=e,y=(0,a.useRef)(null),w=(0,p.jE)({content:o,immediatelyRender:!0,extensions:[R.Z,Q.Z.configure({enableMath:i,enableHtml:u,enableSoftBreaks:m,enableSingleDollarTextMath:g,boldToken:l.boldToken,italicToken:l.italicToken,bulletListToken:l.bulletListToken,mathToken:l.mathToken,isCoursePreview:C}),x.ZP.configure({type:"markdown"}),N.V.configure({text:!1,bold:!1,italic:!1,bulletList:!1,listItem:!1,codeBlock:!1,paragraph:!1}),M.Z,S.ZP.configure({classes:{base:"comment hover:cursor-pointer",selection:"bg-warning-100",comment:"bg-primary-100 hover:bg-primary-200",selectedComment:"bg-primary-200"}}),X.Z.configure(),Y.configure({enableCodeExecution:f,defaultExpanded:v}),ee.Z,es.Z.configure({types:["heading","paragraph"]}),...null!=r?r:[],...u?[eo]:[]],editorProps:{attributes:{class:(0,d.m)(h()("relative max-w-none [&>pre]:p-2 [&>pre]:rounded-lg focus:outline-none min-h-[60px] text-neutral-800 scale-tailwind wysiwyg wysiwyg-chat wysiwyg-sm",t))}}},[i,u,m,g,f,null==l?void 0:l.mathToken,C]);return((0,a.useEffect)(function(){if(!w)return;let e=(0,x.BY)(w);if(b){let t=en()(e,1e3);return t(o,!1),()=>{t.cancel()}}e(o,!1)},[w,o,b]),w)?(0,s.jsx)(p.rU.Provider,{value:{editor:w},children:(0,s.jsx)(c.TG.Provider,{value:{editorRef:y},children:n})}):null})},177126:function(e,t,n){"use strict";n.d(t,{j:function(){return r}});var r,o=n(53355);(r||(r={})).WARNING="warning";let s=o.hj.create({name:"alert",addCommands:()=>({showWarning:e=>t=>{let{editor:n,tr:r}=t,{from:o}=n.state.selection,s=n.view.coordsAtPos(o);return r.setMeta("warning",{message:e,coords:s}),!0}})});t.Z=s},901491:function(e,t,n){"use strict";n.d(t,{BY:function(){return getContentParser},Uk:function(){return generateJson},Xm:function(){return getContentSerializer},vT:function(){return generateParagraphContent}});var r=n(53355),o=n(396686);function getContentParser(e){var t,n;let r=null===(n=e.storage)||void 0===n?void 0:null===(t=n.content)||void 0===t?void 0:t.parseContent;if(!r)throw Error("Content parser is not available. Make sure the Content extension is enabled.");return r}function getContentSerializer(e){var t,n;let r=null===(n=e.storage)||void 0===n?void 0:null===(t=n.content)||void 0===t?void 0:t.getContent;if(!r)throw Error("Content serializer is not available. Make sure the Content extension is enabled.");return r}function generateParagraphContent(e,t){let n=e.split("\n").map((e,n,r)=>{let s;let a=n===r.length-1;return""===e?a?[]:[{type:"hardBreak"}]:(s=t?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"@",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=!(arguments.length>3)||void 0===arguments[3]||arguments[3],s=(0,o.i)(t),a=[...e.matchAll(s)],l=0,i=[];for(let o of a){let s=o.index+(o[0].startsWith(" ")?1:0),a=o.index+o[0].length;if(s>l&&i.push({type:"text",text:e.substring(l,s)}),r){let e=n.find(e=>o[2].startsWith(e.id)||o[2].startsWith(e.label));if(e){i.push({type:"mention",attrs:{id:e.id,label:e.label}});let n=o[0].trim().replace(t,"").replace(e.label,"");n.length&&i.push({type:"text",text:n})}else i.push({type:"text",text:o[1]});o[0].endsWith(" ")&&i.push({type:"text",text:" "})}else i.push({type:"mention",attrs:{id:o[2].trim(),label:o[2].trim()}});l=a}return l<e.length&&i.push({type:"text",text:e.substring(l)}),i}(e,t.char,t.items,t.parseKnownOnly):[{type:"text",text:e}],a?[...s]:[...s,{type:"hardBreak"}])}).flat();return n}function generateJson(e,t){let n=generateParagraphContent(e,t);return{type:"doc",content:[{type:"paragraph",content:n.flat()}]}}let s=r.hj.create({name:"content",addOptions:()=>({type:"text"}),addStorage(){return{type:this.options.type}},onBeforeCreate(){this.editor.storage.content={type:this.options.type,getContent:()=>{let e=this.options.type,t=this.editor.storage.markdown;if(!t&&"markdown"===e)throw Error("Markdown storage is not available");let n="text"===e?this.editor.getText():"markdown"===e?t.getMarkdown():this.editor.getHTML();return n},parseContent:(e,t)=>{let n=this.options.type,r=this.editor,o=t||r.isFocused;switch(n){case"text":if(!o&&void 0!==e&&e!==r.getText()){let t=r.storage.mention,n=generateJson(e,null==t?void 0:t.mention);setTimeout(()=>{r.commands.setContent(n,!1)})}break;case"markdown":{let t=r.storage.markdown;if(!t&&"markdown"===n)throw Error("Markdown storage is not available");let s=t.getMarkdown();o||void 0===e||e===s||r.commands.setContent(e,!1,{preserveWhitespace:!0});break}case"html":{let t=r.getHTML();o||void 0===e||e===t||setTimeout(()=>{r.commands.setContent(e,!1,{preserveWhitespace:"full"})})}}}}}});t.ZP=s},554913:function(e,t,n){"use strict";var r=n(53355),o=n(616711);let s=r.hj.create({name:"noCopyPaste",addOptions:()=>({disableCopy:!1,disablePaste:!1,onDisabledCopy:()=>{},onDisabledPaste:()=>{}}),addStorage(){return{onDisabledCopy:this.options.onDisabledCopy,onDisabledPaste:this.options.onDisabledPaste}},addCommands(){return{updateDisableCopy:e=>()=>(this.options.disableCopy=e,this.editor.view.updateState(this.editor.state),!0),updateDisablePaste:e=>()=>(this.options.disablePaste=e,this.editor.view.updateState(this.editor.state),!0)}},addProseMirrorPlugins(){let e=new o.H$("noCopyPastePlugin");return[new o.Sy({key:e,props:{handleDOMEvents:{copy:(e,t)=>{if(this.options.disableCopy){var n,r;return t.preventDefault(),null===(n=(r=this.storage).onDisabledCopy)||void 0===n||n.call(r),!0}return!1},cut:(e,t)=>{if(this.options.disableCopy){var n,r;return t.preventDefault(),null===(n=(r=this.storage).onDisabledCopy)||void 0===n||n.call(r),!0}return!1},paste:(e,t)=>{if(this.options.disablePaste){var n,r;return t.preventDefault(),null===(n=(r=this.storage).onDisabledPaste)||void 0===n||n.call(r),!0}return!1},drop:(e,t)=>{if(this.options.disablePaste){var n,r;return t.preventDefault(),null===(n=(r=this.storage).onDisabledPaste)||void 0===n||n.call(r),!0}}}}})]}});t.Z=s},582557:function(e,t,n){"use strict";var r=n(386422);let o=r.V.extend({addOptions:()=>({emptyEditorClass:"before:content-[attr(data-placeholder)] before:text-muted-foreground before:float-left before:h-0 before:pointer-events-none",emptyNodeClass:"is-empty",placeholder:"",showOnlyWhenEditable:!0,considerAnyAsEmpty:!1,showOnlyCurrent:!0,includeChildren:!1}),addCommands(){return{updatePlaceholder:e=>()=>(this.options.placeholder=e,this.editor.view.updateState(this.editor.state),!0)}}});t.Z=o},568334:function(e,t,n){"use strict";n.d(t,{j:function(){return o}});var r,o,s=n(53355);(r=o||(o={})).ENABLED_CHANGE="enabledChange",r.OPEN_CHANGE="openChange",r.SELECTED_CHANGE="selectedChange",t.Z=new s.hj({name:"reviewerCopilot",addStorage:()=>({enabled:!1,open:!1}),addCommands(){return{setCopilotEnabled:e=>t=>{let{tr:n}=t;return this.storage.enabled=e,n.setMeta("enabledChange",e),!0},setCopilotOpen:e=>t=>{let{tr:n}=t;return this.storage.open=e,n.setMeta("openChange",e),!0},setCopilotSelection:e=>t=>{let{tr:n}=t;return n.setMeta("selectedChange",e),!0}}}})},84605:function(e,t,n){"use strict";var r=n(53355),o=n(616711);let s=["ltr","rtl","auto"],a=r.hj.create({name:"textDirection",addOptions:()=>({types:["paragraph","heading"],defaultDirection:"auto"}),addGlobalAttributes(){return[{types:this.options.types,attributes:{dir:{default:null,rendered:!0,parseHTML:e=>e.dir||this.options.defaultDirection,renderHTML:e=>({dir:e.dir})}}}]},addCommands(){return{setTextDirection:e=>t=>{let{commands:n}=t;return!!s.includes(e)&&(this.options.defaultDirection=e,this.options.types.every(t=>n.updateAttributes(t,{dir:e})))}}},addProseMirrorPlugins(){return[new o.Sy({key:new o.H$("textDirection"),appendTransaction:(e,t,n)=>{let r=e.some(e=>e.docChanged);if(!r)return;let o=!1,s=n.tr;return n.doc.descendants((e,t)=>{if(this.options.types.includes(e.type.name)){if(null!==e.attrs.dir&&e.textContent.length>0)return;let n=s.storedMarks||[];for(let e of(s.setNodeAttribute(t,"dir",this.options.defaultDirection),n))s.addStoredMark(e);o=!0}}),o?s:null}})]}});t.Z=a},908043:function(e,t,n){"use strict";var r=n(53355),o=n(616711),s=n(711719);let a=new Set;t.Z=new r.hj({name:"unique-id",priority:99999,addOptions:()=>({attributeName:"id",createId:()=>(0,s.v4)()}),addGlobalAttributes(){return[{types:["paragraph","heading"],attributes:{[this.options.attributeName]:{default:null,rendered:!0,keepOnSplit:!1}}}]},onCreate(){!function(e,t,n){let{tr:r,doc:o}=e,{attributeName:s,createId:l}=n,i=!1;o.descendants((e,t)=>{if("codeBlock"===e.type.name)return!1;if(e.isTextblock&&!e.attrs[s]){let n=l();r.setNodeMarkup(t,void 0,{...e.attrs,[s]:n}),a.add(n),i=!0}}),i&&(r.setMeta("addToHistory",!1),t.dispatch(r))}(this.editor.state,this.editor.view,this.options)},addProseMirrorPlugins(){let{attributeName:e,createId:t}=this.options;return[new o.Sy({key:new o.H$("unique-id"),appendTransaction(n,o,s){if(!n.some(e=>{let{docChanged:t}=e;return t}))return null;let l=!1,i=s.tr,d=(0,r.XP)(o.doc,n),u=(0,r.QC)(d);return u.forEach(n=>{let{newRange:o}=n,d=(0,r.b5)(s.doc,o,e=>e.isTextblock);d.forEach(n=>{let{node:r,pos:o}=n,s=r.attrs[e];if(!s){let n=t();i.setNodeMarkup(o,void 0,{...r.attrs,[e]:n}),a.add(n),l=!0}})}),l?i:null}})]}})},657097:function(e,t,n){"use strict";n.d(t,{Cw:function(){return o},EQ:function(){return getSelectionFromEditor}});var r,o,s=n(53355),a=n(616711),l=n(353553),i=n(138944);(r=o||(o={})).CommentsUpdated="Comment:Updated",r.Enabled="Comment:Enabled",r.CommentSelected="Comment:Selected",r.CommentPositionsUpdated="Comment:PositionsUpdated";let d=s.hj.create({name:"comment",addOptions:()=>({enabled:!1,classes:{base:"comment-plugin",comment:"comment",selectedComment:"selected-comment",selection:"selection"}}),addStorage:()=>({enabled:!1,isFocused:!1,selectedCommentId:null,comments:[],selection:null}),onCreate(){this.storage.enabled=this.options.enabled},addCommands(){return{selectComment:e=>t=>{let{tr:n}=t;return this.storage.selectedCommentId!==e&&(this.storage.selectedCommentId=e,n.setMeta("Comment:Selected",e),n.setMeta("Comment:Updated",!0),!0)},deselectComment:()=>e=>{let{tr:t}=e;return null!==this.storage.selectedCommentId&&(this.storage.selectedCommentId=null,t.setMeta("Comment:Selected",null),t.setMeta("Comment:Updated",!0),!0)},deleteComment:e=>t=>{let{tr:n}=t;return!!this.storage.comments.find(t=>t.id===e)&&(this.storage.comments=this.storage.comments.filter(t=>t.id!==e),n.setMeta("Comment:Updated",!0),!0)},addComment:e=>t=>{let{tr:n}=t;return!this.storage.comments.find(t=>t.id===e.id)&&(this.storage.comments.push(e),n.setMeta("Comment:Updated",!0),!0)},dropComments:()=>e=>{let{tr:t}=e;return 0!==this.storage.comments.length&&(this.storage.comments=[],t.setMeta("Comment:Updated",!0),!0)},setComments:e=>t=>{let{tr:n}=t;return!this.storage.isFocused&&(this.storage.comments=e,this.storage.selection=null,n.setMeta("Comment:Updated",!0),!0)},enableComments:()=>e=>{let{tr:t}=e;return!this.storage.enabled&&(this.storage.enabled=!0,t.setMeta("Comment:Enabled",!0),!0)},disableComments:()=>e=>{let{tr:t}=e;return!!this.storage.enabled&&(this.storage.enabled=!1,t.setMeta("Comment:Enabled",!1),!0)}}},onFocus(){this.storage.isFocused=!0},onBlur(){this.storage.isFocused=!1},addProseMirrorPlugins(){let e=this;return[new a.Sy({key:new a.H$("commentPlugin"),props:{decorations(e){var t;return null===(t=this.getState(e))||void 0===t?void 0:t.decorators},handleDOMEvents:{click:(e,t)=>{let n=t.target;return n&&(null==n?void 0:n.classList.contains("comment"))&&n.id?this.editor.commands.selectComment(n.id):this.editor.commands.deselectComment(),!1}}},state:{init:()=>({decorators:l.EH.empty,enabled:e.storage.enabled}),apply:(t,n)=>{let r=t.getMeta("Comment:Enabled");if(void 0!==r)return{decorators:n.decorators,enabled:r};if(!n.enabled)return{decorators:l.EH.empty,enabled:n.enabled};let o=t.getMeta("Comment:Updated"),s=n.decorators;return(t.docChanged||o)&&(s=function(e,t,n,r){let o=t.map(e=>l.p.inline(e.range.from,e.range.to,{class:(0,i.default)(r.base,{[r.comment]:e.id!==n,[r.selectedComment]:e.id===n}),id:e.id},{id:e.id,inclusiveLeft:!0,inclusiveRight:!0}));return l.EH.create(e,o)}(t.doc,e.storage.comments,e.storage.selectedCommentId,e.options.classes)),{decorators:s,enabled:n.enabled}}},filterTransaction(t,n){let r=this.getState(n);if(!(null==r?void 0:r.enabled))return!0;let o=t.doc.nodeSize-t.before.nodeSize,s=!t.before.eq(t.doc),alertAndSelectComment=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"You have to rate the comment to be able to edit the highlighted area!";t.setMeta("Comment:Updated",!0),e.editor.commands.selectComment(n[0].id),window.alert(r)};if(s){let n=t.selection.from-o,r=e.storage.comments,s=r.filter(e=>e.range.from<n&&e.range.to>n||o<0&&e.range.to===n);if(s.length)return alertAndSelectComment(s),!1;if(o<-1){let e=r.filter(e=>e.range.to>t.selection.from&&e.range.to<t.selection.from+Math.abs(o)||e.range.from<t.selection.from+Math.abs(o)&&e.range.from>t.selection.from);for(let n of e){let e=n.range.to-t.selection.from;if(n.range.to-e<=n.range.from)return alertAndSelectComment([n],"You have to rate the comment to be able to delete the highlighted area!"),!1}}if(-1===o){let e=r.filter(e=>e.range.from<n&&e.range.to>=n);if(e.length&&e[0].range.from===e[0].range.to+o)return alertAndSelectComment(e,"You have to rate the comment to be able to remove the highlighted area!"),!1}let a=[];e.storage.comments=r.map(e=>{if(o<-1&&e.range.to>t.selection.from&&e.range.to<t.selection.from+Math.abs(o)||e.range.from<t.selection.from+Math.abs(o)&&e.range.from>t.selection.from){let n=e.range.to-t.selection.from,r={from:e.range.from,to:e.range.to-n};return a.push({id:e.id,range:r}),{...e,range:r}}if(e.range.from>=n){let t={from:e.range.from+o,to:e.range.to+o};return a.push({id:e.id,range:t}),{...e,range:t}}return{...e}}),t.setMeta("Comment:PositionsUpdated",a),t.setMeta("Comment:Updated",!0)}return!0}}),new a.Sy({state:{init:()=>({deco:l.EH.empty,enabled:e.storage.enabled}),apply(t,n,r,o){let s=t.getMeta("Comment:Enabled");if(void 0!==s)return{deco:n.deco,enabled:s};let a=o.selection;if(a){let t=l.EH.create(o.doc,[l.p.inline(a.$from.pos,a.$to.pos,{class:e.options.classes.selection},{inclusiveLeft:!0,inclusiveRight:!0})]);return{deco:t,enabled:n.enabled}}return{deco:l.EH.empty,enabled:n.enabled}}},props:{decorations(t){var n;return(null===(n=this.getState(t))||void 0===n?void 0:n.enabled)&&!e.editor.isEditable&&t&&this.getState(t)?this.getState(t).deco:null}}})]}}),getSelectionFromEditor=e=>{let{selection:t}=e.state;if(t.empty)return{range:null,content:""};{let e={from:t.$from.pos,to:t.$to.pos},n=t.content().content.textBetween(0,t.content().content.size);return{range:e,content:n}}};t.ZP=d},51446:function(e,t,n){"use strict";n.d(t,{Z:function(){return ei}});var r=n(53355),o=n(416817),s=n(616711),a=n(938910);let l=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,i=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,d=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,u=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,c=RegExp("^(?![\"'])\\p{P}+","gu"),preventSpacelessPunctuation=e=>new s.Sy({key:new s.H$("".concat(e,"-spaceless-punctuation")),appendTransaction:(t,n,r)=>{let o=r.tr,s=!1,a=[];return r.doc.descendants((t,n)=>{t.isText&&t.marks.forEach(o=>{if(o.type.name===e){let e=t.text,o=RegExp("[^\\p{L}\\p{N}\\s]$","u").test(null!=e?e:"");if(o){let e=n+t.nodeSize,o=r.doc.textBetween(e,e+1,null,"");o&&!/\s/.test(o)&&(a.push({pos:e,text:" "}),s=!0)}}})}),a.reverse().forEach(e=>{let{text:t,pos:n}=e;o=o.insertText(t,n)}),s?o:null}}),preventStartingWithPunctuation=e=>new s.Sy({key:new s.H$("".concat(e,"-prevent-starting-with-punctuation")),appendTransaction(t,n,r){let o=r.tr,s=!1;return r.doc.descendants((t,n)=>{t.isText&&t.marks.forEach(a=>{if(a.type.name===e){var l;let e=null!==(l=t.text)&&void 0!==l?l:"",i=e.match(c);if(i){let l=i[0],d=e.slice(l.length),u=n+t.nodeSize;o=o.delete(n,u).insert(n,r.schema.text(l)),l.length!==t.nodeSize&&(o=o.insert(n+l.length,r.schema.text(d,[a]))),s=!0}}})}),s?o:null}});var p=o.ZP.extend({addStorage:()=>({markdown:{serialize:{open:(e,t)=>t.attrs.token,close:(e,t)=>t.attrs.token,mixable:!0,expelEnclosingWhitespace:!0},parse:{setup(e){e.renderer.rules.strong_open=(e,t,n,r,o)=>{let s=e[t],a=s.markup;return s.attrSet("token",a),o.renderToken(e,t,n)}}}}}),addCommands(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),toggleBoldWithDefaultToken:()=>e=>{var t;let{commands:n}=e,r=null!==(t=this.editor.storage.markdownExtensions.boldToken)&&void 0!==t?t:a.BoldToken.ASTERISK;return n.toggleMark(this.name,{token:r}),!0}}},addAttributes:()=>({token:{default:"**",renderHTML:e=>({token:e.token})}}),addInputRules(){return[(0,r.Cf)({find:l,type:this.type,getAttributes:()=>({token:"**"})}),(0,r.Cf)({find:d,type:this.type,getAttributes:()=>({token:"__"})})]},addPasteRules(){return[(0,r.K9)({find:i,type:this.type,getAttributes:()=>({token:"**"})}),(0,r.K9)({find:u,type:this.type,getAttributes:()=>({token:"__"})})]},addProseMirrorPlugins:()=>[preventSpacelessPunctuation("bold"),preventStartingWithPunctuation("bold")]}),m=n(857074);let h=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,f=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,g=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,x=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g;var v=m.ZP.extend({addStorage:()=>({markdown:{serialize:{open:(e,t)=>t.attrs.token,close:(e,t)=>t.attrs.token,mixable:!0,expelEnclosingWhitespace:!0},parse:{setup(e){e.renderer.rules.em_open=(e,t,n,r,o)=>{let s=e[t],a=s.markup;return s.attrSet("token",a),o.renderToken(e,t,n)}}}}}),addCommands(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),toggleItalicWithDefaultToken:()=>e=>{var t;let{commands:n}=e,r=null!==(t=this.editor.storage.markdownExtensions.italicToken)&&void 0!==t?t:a.ItalicToken.ASTERISK;return n.toggleMark(this.name,{token:r}),!0}}},addAttributes:()=>({token:{default:"*",renderHTML:e=>({token:e.token})}}),addInputRules(){return[(0,r.Cf)({find:h,type:this.type,getAttributes:()=>({token:"*"})}),(0,r.Cf)({find:g,type:this.type,getAttributes:()=>({token:"_"})})]},addPasteRules(){return[(0,r.K9)({find:f,type:this.type,getAttributes:()=>({token:"*"})}),(0,r.K9)({find:x,type:this.type,getAttributes:()=>({token:"_"})})]},addProseMirrorPlugins:()=>[preventSpacelessPunctuation("italic"),preventStartingWithPunctuation("italic")]}),b=n(238379),C=n(251655);let y=/^\s*([-+*])\s$/;var w=b.ZP.extend({addStorage:()=>({markdown:{serialize:(e,t)=>(Object.assign(t,{attrs:{...t.attrs,tight:!0}}),e.renderList(t,"  ",()=>t.attrs.token+" ")),parse:{setup(e){e.renderer.rules.bullet_list_open=(e,t,n,r,o)=>{let s=e[t],a=e[t+1],l=a.markup||"";return s.attrSet("token",l),o.renderToken(e,t,n)}}}}}),addCommands(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),toggleBulletListWithDefaultToken:()=>e=>{var t;let{commands:n}=e,r=null!==(t=this.editor.storage.markdownExtensions.bulletListToken)&&void 0!==t?t:a.BulletListToken.ASTERISK;return n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks,{token:r}),!0}}},addAttributes:()=>({token:{default:"*",renderHTML:e=>({token:e.token})}}),addInputRules(){let e=(0,r.S0)({find:y,type:this.type,getAttributes:e=>({token:e[1]})});return(this.options.keepMarks||this.options.keepAttributes)&&(e=(0,r.S0)({find:y,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>(0,r.P1)(this.editor.getAttributes(C.Z.name),{token:e[1]}),editor:this.editor})),[e]}}),k=n(491077),j=n(102396),S=n(8465);let sinkListItem=e=>t=>{let{state:n,dispatch:o}=t,s=(0,r.jo)(e,n.schema),{$from:a}=n.selection,l=a.node(-2),i=l.attrs.token||"*";return function(e,t){let{$from:n,$to:r}=e.selection,o=n.blockRange(r,e=>e.childCount>0&&e.firstChild.type===s);if(!o)return!1;let a=o.startIndex;if(0===a)return!1;let l=o.parent,d=l.child(a-1);if(d.type!==s)return!1;if(t){let n=l.type.name===w.name?{token:i}:null,r=d.lastChild&&d.lastChild.type===l.type,a=j.HY.from(r?s.create():null),u=new j.p2(j.HY.from(s.create(null,j.HY.from(l.type.create(n,a)))),r?3:1,0),c=o.start,p=o.end;t(e.tr.step(new S.FC(c-(r?3:1),p,c,p,u,1,!0)).scrollIntoView())}return!0}(n,o)};var T=k.Z.extend({addCommands:()=>({customSinkListItem:e=>sinkListItem(e)}),addKeyboardShortcuts(){var e;return Object.assign({},(null===(e=this.parent)||void 0===e?void 0:e.call(this))||{},{Tab:()=>this.editor.commands.customSinkListItem(this.name)})}}),E=n(324519),N=r.NB.create({name:"markdownHTMLNode",addStorage:()=>({markdown:{serialize(e,t,n){this.editor.storage.markdown.options.html?e.write(function(e,t){let n=e.type.schema,o=(0,r.d1)(j.HY.from(e),n);return e.isBlock&&(t instanceof j.HY||t.type.name===n.topNodeType.name)?function(e){let t=function(e){let t="<body>".concat(e,"</body>");return new window.DOMParser().parseFromString(t,"text/html").body}(e),n=t.firstElementChild;return n.innerHTML=n.innerHTML.trim()?"\n".concat(n.innerHTML,"\n"):"\n",n.outerHTML}(o):o}(t,n)):(console.warn('Tiptap Markdown: "'.concat(t.type.name,'" node is only available in html mode')),e.write("[".concat(t.type.name,"]"))),t.isBlock&&e.closeBlock(t)},parse:{}}})});function childNodes(e){var t,n;return null!==(n=null==e?void 0:null===(t=e.content)||void 0===t?void 0:t.content)&&void 0!==n?n:[]}var M=E.ZP.extend({addProseMirrorPlugins(){return[new s.Sy({props:{handlePaste:(e,t)=>{var n;let r=null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text/html");if(r){let t=document.createElement("div");t.innerHTML=r;let n=t.querySelector("table");if(n){if(this.editor.isActive(this.type.name))return!0;n.querySelectorAll("td, th").forEach(e=>{e.removeAttribute("colspan"),e.removeAttribute("rowspan")});let r=n.querySelector("tr");r&&r.querySelectorAll("td").forEach(e=>{let t=document.createElement("th");t.innerHTML=e.innerHTML,e.replaceWith(t)});let o=j.aw.fromSchema(e.state.schema),s=o.parse(t),a=e.state.tr.replaceSelectionWith(s);return e.dispatch(a),!0}}return!1}}})]},addStorage:()=>({markdown:{serialize(e,t,n){if(!function(e){let t=childNodes(e),n=t[0],r=t.slice(1);return!(childNodes(n).some(e=>hasSpan(e)||e.childCount>1)||r.some(e=>childNodes(e).some(e=>hasSpan(e)||e.childCount>1)))}(t)){N.storage.markdown.serialize.call(this,e,t,n);return}e.inTable=!0,t.forEach((t,n,r)=>{if(e.write("| "),t.forEach((t,n,r)=>{r&&e.write(" | ");let o=t.firstChild;(null==o?void 0:o.textContent.trim())&&e.renderInline(o)}),e.write(" |"),e.ensureNewLine(),!r){let n=Array.from({length:t.childCount}).map(()=>"---").join(" | ");e.write("| ".concat(n," |")),e.ensureNewLine()}}),e.closeBlock(t),e.inTable=!1},parse:{}}})});function hasSpan(e){return e.attrs.colspan>1||e.attrs.rowspan>1}var R=n(731248),A=n(77427);let preventNewLinesInsideTable=e=>new s.Sy({key:new s.H$("prevent-new-lines-inside-table-".concat(e)),props:{handlePaste(e,t){let{state:n,dispatch:r}=e,{schema:o,selection:s}=n,a=n.schema.nodes.tableCell&&s.$from.node(-1).type===n.schema.nodes.tableCell,l=n.schema.nodes.tableHeader&&s.$from.node(-1).type===n.schema.nodes.tableHeader;if(a||l){var i;t.preventDefault();let e=(null===(i=t.clipboardData)||void 0===i?void 0:i.getData("text/plain"))||"",s=e.split("\n"),a=[];s.forEach((e,t)=>{e.trim()&&a.push(o.text(e)),t<s.length-1&&a.push(o.nodes.hardBreak.create())});let l=o.nodes.paragraph.create({},a);return r(n.tr.replaceSelectionWith(l)),!0}return!1}}});var P=R.Z.extend({addProseMirrorPlugins:()=>[preventNewLinesInsideTable("table-cell")],addKeyboardShortcuts:()=>({Enter:e=>{let{editor:t}=e,{state:n,commands:r}=t;return!!(0,A.Tr)(n.schema.nodes.tableCell)(n.selection)&&(r.setHardBreak(),!0)}})}),I=n(695674).Z.extend({addProseMirrorPlugins:()=>[preventNewLinesInsideTable("table-header")],addKeyboardShortcuts:()=>({Enter:e=>{let{editor:t}=e,{state:n,commands:r}=t;return!!(0,A.Tr)(n.schema.nodes.tableHeader)(n.selection)&&(r.setHardBreak(),!0)}})}),L=n(227202),B=n(119773),_=n(465259),D=n(959394),O=_.Z.extend({addKeyboardShortcuts:()=>({Enter:e=>{var t;let{editor:n}=e,{state:r}=n,{$from:o,$to:s}=r.selection;n.commands.setMeta("key","enter");let a="paragraph"===o.parent.type.name&&0===o.parent.content.size,l=[r.schema.nodes.listItem,r.schema.nodes.tableCell,r.schema.nodes.tableHeader,r.schema.nodes.blockquote,r.schema.nodes.image];if(l.some(e=>(0,A.Tr)(e)(r.selection))||"doc"===o.node().type.name)return!1;let i=0===o.parentOffset,d=o.parentOffset===o.node().content.size,u=o.doc.nodeAt(s.pos+1),c=u&&"paragraph"===u.type.name&&0===u.content.size&&"paragraph"===o.parent.type.name&&d,p=o.index(o.depth-1),m=n.getJSON(),h=p-1>=0?null===(t=m.content)||void 0===t?void 0:t[p-1]:null,f=(null==h?void 0:h.type)==="paragraph"&&!(null==h?void 0:h.content)&&i&&"paragraph"===o.parent.type.name;return(!!a||!!c||!!f)&&(n.commands.showWarning("Try to avoid extra blank lines, if necessary use Shift + Enter"),!0)}}),addStorage:()=>({markdown:{serialize:D.Dm.nodes.paragraph,parse:{}}})}),F=n(252856).Z.extend({addStorage:()=>({markdown:{serialize(e,t){var n,r;e.text(null==(r=null!==(n=t.text)&&void 0!==n?n:"")?void 0:r.replace(/</g,"<").replace(/>/g,">"))},parse:{}}})}),z=n(404598),H=n(760035),V=n(767890),$=n(171493),Z=n(561506),W=n(999883),U=n(23707),J=n(904668),K=r.NB.create({name:"iframe",group:"block",atom:!0,addOptions:()=>({allowFullscreen:!0,HTMLAttributes:{}}),addAttributes(){return{src:{default:null},width:{default:"100%"},height:{default:"500"},frameborder:{default:0},style:{default:"border: 1px solid gray;"},allowfullscreen:{default:this.options.allowFullscreen,parseHTML:()=>this.options.allowFullscreen}}},parseHTML:()=>[{tag:"iframe"}],renderHTML(e){let{HTMLAttributes:t}=e;return["iframe",t]},addCommands(){return{setIframe:e=>t=>{let{tr:n,dispatch:r}=t,{selection:o}=n,s=this.type.create(e);return r&&n.replaceRangeWith(o.from,o.to,s),!0}}}}),q=n(824246),G=n(855549),Y=n(386070),Q=n(827378);let X="#0096fd",useEvent=e=>{let t=(0,Q.useRef)(null);return(0,Q.useLayoutEffect)(()=>{t.current=e},[e]),(0,Q.useCallback)(function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!t.current)throw Error("Handler is not assigned");return t.current(...n)},[])},ResizableImageTemplate=e=>{let{node:t,updateAttributes:n}=e,r=(0,Q.useRef)(null),o=(0,Q.useRef)(null),[s,a]=(0,Q.useState)(!1),[l,i]=(0,Q.useState)(),[d,u]=(0,Q.useState)(t.attrs.alt||"");(0,Q.useEffect)(()=>{let handleClickOutside=e=>{var t;(null===(t=r.current)||void 0===t?void 0:t.contains(e.target))||a(!1)};return document.addEventListener("click",handleClickOutside),()=>document.removeEventListener("click",handleClickOutside)},[]);let c=useEvent(e=>{if(!o.current)return;e.preventDefault();let t=e.currentTarget.dataset.direction||"--",r=e.clientX,s=o.current.width,a=s,l="w"===t[1]?-1:1,removeListeners=()=>{window.removeEventListener("mousemove",mouseMoveHandler),window.removeEventListener("mouseup",removeListeners),n({width:a}),i(void 0)},mouseMoveHandler=e=>{i({width:a=Math.max(s+l*(e.clientX-r),60)}),e.buttons||removeListeners()};window.addEventListener("mousemove",mouseMoveHandler),window.addEventListener("mouseup",removeListeners)}),dragCornerButton=e=>(0,q.jsx)("div",{role:"button",tabIndex:0,onMouseDown:c,"data-direction":e,style:{position:"absolute",height:"10px",width:"10px",backgroundColor:X,...{n:{top:0},s:{bottom:0}}[e[0]],...{w:{left:0},e:{right:0}}[e[1]],cursor:"".concat(e,"-resize")}});return(0,q.jsx)(G.T5,{ref:r,as:"div",draggable:!0,"data-drag-handle":!0,onClick:()=>a(!0),onBlur:()=>a(!1),children:(0,q.jsxs)("div",{style:{overflow:"hidden",position:"relative",display:"inline-block",lineHeight:"0px"},children:[(0,q.jsx)("img",{...t.attrs,ref:o,style:{...l,cursor:"default"}}),s&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Y.f,{size:"1",value:d,onChange:e=>{let t=e.target.value;u(t),n({alt:t})},placeholder:"Enter alt text..."}),[{left:0,top:0,height:"100%",width:"1px"},{right:0,top:0,height:"100%",width:"1px"},{top:0,left:0,width:"100%",height:"1px"},{bottom:0,left:0,width:"100%",height:"1px"}].map((e,t)=>(0,q.jsx)("div",{style:{position:"absolute",backgroundColor:X,...e}},t)),dragCornerButton("nw"),dragCornerButton("ne"),dragCornerButton("sw"),dragCornerButton("se")]})]})})},ee=z.ZP.extend({name:"resizableImage",addAttributes(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),src:{default:null},alt:{default:null},width:{default:null,parseHTML:e=>e.getAttribute("width"),renderHTML:e=>e.width?{width:e.width}:{}}}},parseHTML:()=>[{tag:"img[src]",getAttrs:e=>"string"==typeof e?{}:{src:e.getAttribute("src"),alt:e.getAttribute("alt"),width:e.getAttribute("width")}}],addNodeView:()=>(0,G.fW)(ResizableImageTemplate)});var et=ee.configure({inline:!0});let en=C.Z.extend({addAttributes(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),fontSize:{default:null,parseHTML:e=>{var t,n;return(null===(n=e.style)||void 0===n?void 0:null===(t=n.fontSize)||void 0===t?void 0:t.replace(/['"]+/g,""))||""},renderHTML:e=>e.fontSize?{style:"font-size: ".concat(e.fontSize)}:{}}}},addCommands(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),setFontSize:e=>t=>{let{chain:n}=t;return n().setMark(this.name,{fontSize:e}).run()},unsetFontSize:()=>e=>{let{chain:t}=e;return t().setMark(this.name,{fontSize:null}).removeEmptyTextStyle().run()}}}});var er=n(85349);let eo={width:"420",height:"240"},es=er.Z.extend({addAttributes(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),width:{default:eo.width,parseHTML:e=>e.getAttribute("width")||e.style.width||eo.width,renderHTML:e=>{let t=e.width;return t?{width:t.endsWith("%")?null:t,style:t.endsWith("%")?"width: ".concat(t,";"):null}:{}}},height:{default:eo.height,parseHTML:e=>e.getAttribute("height")||eo.height,renderHTML:e=>e.height?{height:e.height}:{}}}},addCommands(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),setYoutubeVideoWithStringParams:e=>{let{src:t,width:n,height:r}=e;return e=>{let{commands:o}=e;return!!t&&o.insertContent({type:this.name,attrs:{src:t,width:n||eo.width,height:r||eo.height}})}}}}}),ea=C.Z.extend({addAttributes(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),textAlign:{default:null,parseHTML:e=>{var t;return(null===(t=e.style)||void 0===t?void 0:t.textAlign)||null},renderHTML:e=>e.textAlign?{style:"text-align: ".concat(e.textAlign,"; display: inline-block; width: 100%;")}:{}}}},addCommands(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),setTextAlign:e=>t=>{let{chain:n}=t;return n().setMark(this.name,{textAlign:e}).run()},unsetTextAlign:()=>e=>{let{chain:t}=e;return t().setMark(this.name,{textAlign:null}).removeEmptyTextStyle().run()}}}}),el=r.hj.create({name:"markdownExtensions",addOptions:()=>({enableMath:!1,enableCourseTools:!1,enableHtml:!1,enableSoftBreaks:!1,enableSingleDollarTextMath:!0,boldToken:a.BoldToken.ASTERISK,italicToken:a.ItalicToken.ASTERISK,bulletListToken:a.BulletListToken.ASTERISK,mathToken:a.MathToken.DOLLARS,isCoursePreview:!1}),addStorage(){return{boldToken:this.options.boldToken,italicToken:this.options.italicToken,bulletListToken:this.options.bulletListToken,mathToken:this.options.mathToken}},addExtensions(){let{enableHtml:e,enableSoftBreaks:t,enableMath:n,enableCourseTools:r,isCoursePreview:o}=this.options,s=[B.U.configure({breaks:t,html:e}),p,v,w.configure({keepAttributes:!0}),T,M,P,I,L.Z,O,F,H.ZP];if(r?s.push(V.Z,$.I,en,Z.ZP.configure({multicolor:!0}),es,U.Z,J.ZP,K,et,ea):o||s.push(z.ZP.configure({allowBase64:!0})),n){var l;s.push(W.Z.configure({allowedRules:[a.MathToken.DOLLARS,a.MathToken.BRACKETS,a.MathToken.ESCAPED_BRACKETS],enableSingleDollarTextMath:null===(l=this.options.enableSingleDollarTextMath)||void 0===l||l}))}return s}});var ei=el},999883:function(e,t,n){"use strict";n.d(t,{Z:function(){return w}});var r=n(53355),o=n(938910);let $_pre=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=n>0&&e[n-1].charCodeAt(0);return t?!r||32===r:!r||92!==r&&(r<48||r>57)},$_post=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=e[n+1]&&e[n+1].charCodeAt(0);return t?!r||32===r||46===r||44===r||59===r:!r||r<48||r>57},s='<math-display class="math-node" open="$open" close="$close">$content</math-display>',a='<math-inline class="math-node" open="$open" close="$close">$content</math-inline>',l={[o.MathToken.BRACKETS]:{inline:[{name:"math_inline_block_bracket",rex:/\\\[([\s\S]+?)\\\]/gy,tmpl:s,tag:"\\[",closingTag:"\\]",displayMode:!0,pre:$_pre,post:$_post},{name:"math_inline_bracket",rex:/\\\((.+?)\\\)/gy,tmpl:a,tag:"\\(",closingTag:"\\)"}],block:[{name:"math_block_bracket",rex:/\\\[([\s\S]+?)\\\]/gmy,tmpl:s,tag:"\\[",closingTag:"\\]"}]},[o.MathToken.ESCAPED_BRACKETS]:{inline:[{name:"math_inline_block_escaped_bracket",rex:/\\\\\[([\s\S]+?)\\\\\]/gy,tmpl:s,tag:"\\\\[",closingTag:"\\\\]",displayMode:!0,pre:$_pre,post:$_post},{name:"math_inline_escaped_bracket",rex:/\\\\\((.+?)\\\\\)/gy,tmpl:a,tag:"\\\\(",closingTag:"\\\\)"}],block:[{name:"math_block_escaped_bracket",rex:/\\\\\[([\s\S]+?)\\\\\]/gmy,tmpl:s,tag:"\\\\[",closingTag:"\\\\]"}]},[o.MathToken.DOLLARS]:{inline:[{name:"math_inline_double_dollars",rex:/\${2}([^$]*?[^\\])\${2}/gy,tmpl:s,tag:"$$",closingTag:"$$",displayMode:!0,pre:$_pre,post:$_post},{name:"math_inline_dollars",rex:/\$((?:[^\s\\])|(?:\S.*?[^\s\\]))\$/gy,tmpl:a,tag:"$",closingTag:"$",outerSpace:!1,pre:$_pre,post:$_post}],block:[{name:"math_block_dollars",rex:/\${2}([^$]*?[^\\])\${2}/gmy,tmpl:s,tag:"$$",closingTag:"$$"}]},gitlab:{inline:[{name:"math_inline_gitlab",rex:/\$`(.+?)`\$/gy,tmpl:a,tag:"$`",closingTag:"`$"}],block:[{name:"math_block_gitlab",rex:/`{3}math\s*([^`]*?)\s*`{3}/gm,tmpl:s,tag:"```math",closingTag:"```"}]}},mergeDelimiters=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[o.MathToken.DOLLARS],t={inline:[],block:[]};for(let n of e)n in l&&(t.inline.push(...l[n].inline),t.block.push(...l[n].block));return t};function ensureReplace(e){return"$$"===e?"$$$$":e}let inlineRule=e=>function(t,n){let r=t.pos,o=t.src,s=o.startsWith(e.tag,e.rex.lastIndex=r)&&(!e.pre||e.pre(o,null==e?void 0:e.outerSpace,r)),a=s&&e.rex.exec(o),l=!!a&&r<e.rex.lastIndex&&(!e.post||e.post(o,null==e?void 0:e.outerSpace,e.rex.lastIndex-1));if(l){if(!n){let n=t.push(e.name,"math",0);n.content=a[1],n.markup=e.tag}t.pos=e.rex.lastIndex}return l},blockRule=e=>function(t,n,r,o){let s=t.bMarks[n]+t.tShift[n],a=t.src,l=a.startsWith(e.tag,e.rex.lastIndex=s)&&(!e.pre||e.pre(a,!1,s)),i=l&&e.rex.exec(a),d=!!i&&s<e.rex.lastIndex&&(!e.post||e.post(a,!1,e.rex.lastIndex-1));if(d&&!o){let o;let s=e.rex.lastIndex-1;for(o=n;o<r&&(!(s>=t.bMarks[o]+t.tShift[o])||!(s<=t.eMarks[o]));o++);let a=t.lineMax,l=t.parentType;t.lineMax=o,t.parentType="math","blockquote"===l&&(i[1]=i[1].replace(/(\n*?^(?:\s*>)+)/gm,""));let d=t.push(e.name,"math",0);d.block=!0,d.tag=e.tag,d.markup="",d.content=i[1],d.info=i[i.length-1],d.map=[n,o+1],t.parentType=l,t.lineMax=a,t.line=o+1}return d};var math_texmath=function(e,t){var n,r;let o=mergeDelimiters(null==t?void 0:t.delimiters),s=null!==(n=null==t?void 0:t.outerSpace)&&void 0!==n&&n,a=null!==(r=null==t?void 0:t.rules)&&void 0!==r?r:"all";if("all"===a||"inline"===a)for(let t of o.inline)s&&"outerSpace"in t&&(t.outerSpace=!0),e.inline.ruler.before("escape",t.name,inlineRule(t)),e.renderer.rules[t.name]=(e,n)=>t.tmpl.replace(/\$content/,e[n].content).replace(/\$open/,t.tag).replace(/\$close/,t.closingTag);if("all"===a||"block"===a)for(let t of o.block)e.block.ruler.before("fence",t.name,blockRule(t)),e.renderer.rules[t.name]=(e,n)=>t.tmpl.replace(/\$content/,e[n].content).replace(/\$open/,ensureReplace(t.tag)).replace(/\$close/,ensureReplace(t.closingTag))},i=n(616711),d=n(8465),u=n(436927),c=n(555089),p=n(216228);function collapseMathCmd(e,t,n){let r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(o,s)=>{let a=e.state,{to:l,from:d}=a.selection,{to:u,from:c}=o.selection;if(r&&u!==c)return!1;let p=t>0?u:c;if(n){let e=o.doc.nodeSize-2;if(t>0&&p<e||t<0&&p>0)return!1}if(s){let n=t>0?l:d;e.dispatch(a.tr.setSelection(i.Bs.create(a.doc,n))),e.focus()}return!0}}var m=n(353553);let KatexRenderQueue=class KatexRenderQueue{static getInstance(){return this.instance||(this.instance=new KatexRenderQueue),this.instance}add(e){this.queue.push(e),this.isProcessing||this.processQueue()}async processQueue(){if(0===this.queue.length){this.isProcessing=!1;return}this.isProcessing=!0;let e=this.queue.shift();e&&(e(),await new Promise(e=>setTimeout(e,0)),this.processQueue())}constructor(){this.queue=[],this.isProcessing=!1}};let MathView=class MathView{destroy(){this.closeEditor(!1),this._mathRenderElt&&(this._mathRenderElt.remove(),delete this._mathRenderElt),this._mathSrcElt&&(this._mathSrcElt.remove(),delete this._mathSrcElt),this._observer.disconnect(),this.dom.remove()}ensureFocus(){this._innerView&&this._outerView.hasFocus()&&this._innerView.focus()}update(e){if(!e.sameMarkup(this._node))return!1;if(this._node=e,this._innerView){let t=this._innerView.state,n=e.content.findDiffStart(t.doc.content);if(null!=n){let r=e.content.findDiffEnd(t.doc.content);if(r){let{a:o,b:s}=r,a=n-Math.min(o,s);a>0&&(o+=a,s+=a),this._innerView.dispatch(t.tr.replace(n,s,e.slice(n,o)).setMeta("fromOutside",!0))}}}return this._isEditing||this.renderMath(),!0}selectNode(){this._outerView.editable&&(this.dom.classList.add("ProseMirror-selectednode"),this._isEditing||this.openEditor())}deselectNode(){this.dom.classList.remove("ProseMirror-selectednode"),this._isEditing&&this.closeEditor()}stopEvent(e){return void 0!==this._innerView&&void 0!==e.target&&this._innerView.dom.contains(e.target)}ignoreMutation(){return!0}renderMath(){if(!this._mathRenderElt){console.warn("[prosemirror-math] Cannot render math: render element is undefined");return}if(!this._isIntersecting)return;let e=this._node.content.firstChild,t="";if(null!==e&&(t=e.textContent.trim()),t.length<1){for(this.dom.classList.add("empty-math");this._mathRenderElt.firstChild;)this._mathRenderElt.firstChild.remove();return}this.dom.classList.remove("empty-math"),KatexRenderQueue.getInstance().add(()=>{var e,n,r,o;if(!this._mathRenderElt||!this.dom){console.warn("[prosemirror-math] Cannot render math: elements no longer exist");return}try{p.Z.render(t,this._mathRenderElt,this._katexOptions),null===(e=this._mathRenderElt)||void 0===e||e.classList.remove("parse-error"),null===(n=this.dom)||void 0===n||n.setAttribute("title","")}catch(e){console.error(e),null===(r=this._mathRenderElt)||void 0===r||r.classList.add("parse-error"),null===(o=this.dom)||void 0===o||o.setAttribute("title",e.toString())}})}dispatchInner(e){if(!this._innerView)return;let{state:t,transactions:n}=this._innerView.state.applyTransaction(e);if(this._innerView.updateState(t),!e.getMeta("fromOutside")){let e=this._outerView.state.tr,t=d.KS.offset(this._getPos()+1);for(let r=0;r<n.length;r++){let o=n[r].steps;for(let n=0;n<o.length;n++){let r=o[n].map(t);if(!r)throw Error("step discarded!");e.step(r)}}e.docChanged&&this._outerView.dispatch(e)}}openEditor(){var e;if(this._innerView){console.warn("[prosemirror-math] editor already open when openEditor was called");return}this._innerView=new m.tk(this._mathSrcElt,{state:i.yy.create({doc:this._node,plugins:[(0,u.h)({Tab:(e,t)=>(t&&t(e.tr.insertText("	")),!0),Backspace:(0,c.QF)(c.NE,e=>!!e.selection.empty&&!(this._node.textContent.length>0)&&(this._outerView.dispatch(this._outerView.state.tr.insertText("")),this._outerView.focus(),!0)),"Ctrl-Backspace":()=>(this._outerView.dispatch(this._outerView.state.tr.insertText("")),this._outerView.focus(),!0),Enter:(0,c.QF)(c.QK,collapseMathCmd(this._outerView,1,!1)),"Ctrl-Enter":collapseMathCmd(this._outerView,1,!1),ArrowLeft:collapseMathCmd(this._outerView,-1,!0),ArrowRight:collapseMathCmd(this._outerView,1,!0),ArrowUp:collapseMathCmd(this._outerView,-1,!0),ArrowDown:collapseMathCmd(this._outerView,1,!0)})]}),dispatchTransaction:this.dispatchInner.bind(this)});let t=this._innerView.state;this._innerView.focus();let n=null===(e=this._mathPluginKey.getState(this._outerView.state))||void 0===e?void 0:e.prevCursorPos;null==n&&console.error("[prosemirror-math] Error:  Unable to fetch math plugin state from key.");let r=(null!=n?n:0)<=this._getPos()?0:this._node.nodeSize-2;this._innerView.dispatch(t.tr.setSelection(i.Bs.create(t.doc,r))),this._isEditing=!0}closeEditor(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this._innerView&&(this._innerView.destroy(),this._innerView=void 0),e&&this._isIntersecting&&this.renderMath(),this._isEditing=!1}constructor(e,t,n,r={},o){this._isIntersecting=!1,this._node=e,this._outerView=t,this._getPos=n,this._mathPluginKey=o,this._isEditing=!1,this._katexOptions=Object.assign({globalGroup:!0,throwOnError:!1},r.katexOptions),this._tagName=r.tagName||this._node.type.name.replace("_","-"),this.dom=document.createElement(this._tagName),this.dom.classList.add("math-node"),this.dom.setAttribute("open",this._node.attrs.open),this.dom.setAttribute("close",this._node.attrs.close),this._mathRenderElt=document.createElement("span"),this._mathRenderElt.textContent="",this._mathRenderElt.classList.add("math-render"),this.dom.appendChild(this._mathRenderElt),this._mathSrcElt=document.createElement("span"),this._mathSrcElt.classList.add("math-src"),this._mathSrcElt.spellcheck=!1,this.dom.appendChild(this._mathSrcElt),this.dom.addEventListener("click",()=>this.ensureFocus()),this._observer=new IntersectionObserver(e=>{e.forEach(e=>{this._isIntersecting=e.isIntersecting,e.isIntersecting&&!this._isEditing&&this.renderMath()})},{root:null,rootMargin:"50px",threshold:0}),this._observer.observe(this.dom),this.renderMath()}};let h=new i.H$("prosemirror-math");function createMathView(e){return(t,n,r)=>{let o=h.getState(n.state);if(!o)throw Error("no math plugin!");let s=new MathView(t,n,r,{katexOptions:{displayMode:e,macros:o.macros}},h);return s}}let f=new i.Sy({key:h,state:{init:()=>({macros:{},prevCursorPos:0}),apply:(e,t,n)=>({macros:t.macros,prevCursorPos:n.selection.from})}}),g=/^\$\$?[\s\n]$/,x=RegExp("(?<!\\\\)\\\\\\[[\\s\\n]$"),v=/\\\\\[[\s\n]$/;function nodeInputRule(e){return new r.VK({find:e.find,handler:t=>{let{state:n,range:o,match:s}=t,a=(0,r.nU)(e.getAttributes,void 0,s)||{},{tr:l}=n,d=o.from,u=o.to,c=e.type.create(a);if(s[1]){let e=s[0].lastIndexOf(s[1]),t=d+e;t>u?t=u:u=t+s[1].length;let n=s[0][s[0].length-1];l.insertText(n,d+s[0].length-1),l.replaceWith(t,u,c),c.isTextblock?l.setSelection(i.Bs.create(l.doc,t)):c.isInline&&l.setSelection(i.Bs.create(l.doc,t))}else if(s[0]){let t=e.type.isInline?d:d-1,n=e.type.create(a);l.insert(t,n).delete(l.mapping.map(d),l.mapping.map(u)),n.isTextblock?l.setSelection(i.Bs.create(l.doc,t)):n.isInline&&l.setSelection(i.Bs.create(l.doc,t))}l.scrollIntoView()}})}var b=r.NB.create({name:"math_display",group:"block math",content:"text*",atom:!0,code:!0,addOptions:()=>({allowedRules:[o.MathToken.DOLLARS]}),addStorage:()=>({markdown:{serialize(e,t){e.text("".concat(t.attrs.open),!1),e.text("".concat(t.textContent),!1),e.text("".concat(t.attrs.close),!1),e.ensureNewLine()},parse:{setup(e){let t=this.options.allowedRules;e.use(math_texmath,{delimiters:t,rules:"block"})}}}}),addAttributes:()=>({open:{default:"$$",renderHTML:e=>({open:e.open})},close:{default:"$$",renderHTML:e=>({close:e.close})}}),parseHTML:()=>[{tag:"math-display"}],renderHTML(e){let{HTMLAttributes:t}=e;return["math-display",(0,r.P1)(t,{class:"math-node"}),0]},addInputRules(){let e=this.options.allowedRules,t={[o.MathToken.DOLLARS]:nodeInputRule({find:g,type:this.type,getAttributes:{open:"$$",close:"$$"}}),[o.MathToken.ESCAPED_BRACKETS]:nodeInputRule({find:v,type:this.type,getAttributes:{open:"\\\\[",close:"\\\\]"}}),[o.MathToken.BRACKETS]:nodeInputRule({find:x,type:this.type,getAttributes:{open:"\\[",close:"\\]"}}),gitlab:nodeInputRule({find:/```math(.+)```/,type:this.type,getAttributes:{open:"```math",close:"```"}})};return e.map(e=>t[e])},addCommands(){return{setFormulaBlock:e=>t=>{let{commands:n}=t;return n.setNode(this.name,e)},toggleFormulaBlock:()=>e=>{var t;let{commands:n}=e,r=null!==(t=this.editor.storage.markdownExtensions.mathToken)&&void 0!==t?t:o.MathToken.DOLLARS;return n.toggleNode(this.name,"paragraph",function(e){switch(e){case o.MathToken.DOLLARS:return{open:"$$",close:"$$"};case o.MathToken.BRACKETS:return{open:"\\[",close:"\\]"};case o.MathToken.ESCAPED_BRACKETS:return{open:"\\\\[",close:"\\\\]"}}}(r))},unsetFormulaBlock:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addNodeView(){return e=>{let{node:t,getPos:n}=e,r=createMathView(!0);return r(t,this.editor.view,n)}}});RegExp("(?:^|\\s)(\\$(?!\\s+\\$)(?<content>(?:[^$]+))\\$(?!\\s+\\$))$");var C=r.NB.create({name:"math_inline",group:"inline math",content:"text*",inline:!0,atom:!0,addOptions:()=>({allowedRules:[o.MathToken.DOLLARS]}),addStorage:()=>({markdown:{serialize(e,t){e.text("".concat(t.attrs.open).concat(t.textContent).concat(t.attrs.close),!1)},parse:{setup(e){let t=this.options.allowedRules;e.use(math_texmath,{delimiters:t,rules:"inline"})}}}}),parseHTML:()=>[{tag:"math-inline",getAttrs:e=>({open:e.getAttribute("open")||"$",close:e.getAttribute("close")||"$"})}],addAttributes:()=>({open:{default:"$",renderHTML:e=>({open:e.open})},close:{default:"$",renderHTML:e=>({close:e.close})}}),renderHTML(e){let{HTMLAttributes:t}=e;return["math-inline",(0,r.P1)({class:"math-node"},t),0]},addProseMirrorPlugins:()=>[f],addNodeView(){return e=>{let{node:t,getPos:n}=e,r=createMathView(!1);return r(t,this.editor.view,n)}},addInputRules(){let handleReplacement=(e,t,n,o,s)=>{let a=this.type,l=t.from,i=t.to,d=e.doc.resolve(l),u=d.index(),c=e.doc.resolve(i),p=(0,r.nU)({open:o,close:s},void 0,n)||{};if(!d.parent.canReplaceWith(u,c.index(),a))return null;e.tr.replaceRangeWith(l,i,a.create(p,a.schema.text(n[1])))},e=this.options.allowedRules,t={[o.MathToken.DOLLARS]:new r.VK({find:/\$(.+)\$/,handler:e=>{let{state:t,range:n,match:r}=e;handleReplacement(t,n,r,"$","$")}}),[o.MathToken.ESCAPED_BRACKETS]:new r.VK({find:/\\\\\((.+)\\\\\)/,handler:e=>{let{state:t,range:n,match:r}=e;handleReplacement(t,n,r,"\\\\(","\\\\)")}}),[o.MathToken.BRACKETS]:new r.VK({find:RegExp("(?<!\\\\)\\\\\\((.+?)\\\\\\)"),handler:e=>{let{state:t,range:n,match:r}=e;handleReplacement(t,n,r,"\\(","\\)")}}),gitlab:new r.VK({find:/\$`(.+)`\$/,handler:e=>{let{state:t,range:n,match:r}=e;handleReplacement(t,n,r,"$`","`$")}})};return e.map(e=>t[e])},addCommands(){return{setFormulaMark:e=>t=>{let{commands:n}=t;return n.setMark(this.name,e)},toggleFormulaMark:()=>e=>{var t,n;let{state:r,dispatch:s}=e,{selection:a}=r,{from:l,to:d}=a,u=null!==(t=this.editor.storage.markdownExtensions.mathToken)&&void 0!==t?t:o.MathToken.DOLLARS,c=function(e){switch(e){case o.MathToken.DOLLARS:return{open:"$",close:"$"};case o.MathToken.BRACKETS:return{open:"\\(",close:"\\)"};case o.MathToken.ESCAPED_BRACKETS:return{open:"\\\\(",close:"\\\\)"}}}(u),p=!1,m=null;if(r.doc.nodesBetween(l,d,(e,t)=>{e.type===this.type&&(p=!0,m=t)}),p&&null!==m){if(s){let e=r.tr,t=r.doc.nodeAt(m);if(t){let o;let s=r.schema.text((n=t.content,o="",n.forEach(e=>{e.isText?o+=e.text:e.isLeaf&&(o+=e.textContent)}),o));e.replaceRangeWith(m,m+t.nodeSize,s)}s(e)}return!0}if(s){let{tr:e}=r,t=r.doc.slice(l,d).content,n=this.type.create(c,t);e.replaceRangeWith(l,d,n),e.setSelection(i.Bs.create(e.doc,l+1,l+1)),s(e)}return!0},unsetFormulaMark:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}}});let y=r.hj.create({name:"MathExtensions",addOptions:()=>({allowedRules:[o.MathToken.DOLLARS],enableSingleDollarTextMath:!0}),addExtensions(){let e=this.options.allowedRules;return this.options.enableSingleDollarTextMath||(e=e.filter(e=>e!==o.MathToken.DOLLARS)),[b.configure({allowedRules:this.options.allowedRules}),C.configure({allowedRules:e})]}});var w=y},396686:function(e,t,n){"use strict";n.d(t,{i:function(){return getMentionRegexp}});var r=n(600787);function getMentionRegexp(e){let t=RegExp("(?:^|\\s)("+e+"(\\w+(?:\\s\\w+)?))(?:[.!?:;\\s]|$)","g");return t}t.Z=r.ZP.extend({addOptions(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),char:"@",items:[],parseKnownOnly:!0}},addStorage(){var e;return{...null===(e=this.parent)||void 0===e?void 0:e.call(this),mention:{char:this.options.char,items:this.options.items,parseKnownOnly:this.options.parseKnownOnly},markdown:{serialize(e,t){var n;e.text("".concat(this.options.suggestion.char).concat(null!==(n=t.attrs.label)&&void 0!==n?n:t.attrs.id))},parse:{setup(e){let t=this.options.HTMLAttributes.class,n=this.options.suggestion.char,r=this.options.parseKnownOnly;e.use(e=>{e.renderer.rules.mention=(e,r)=>'<span class="'.concat(t,'" data-type="mention" data-id="').concat(e[r].content,'">').concat(n).concat(e[r].content,"</span>"),e.core.ruler.after("inline","mention",e=>{let t=getMentionRegexp(n);e.tokens.forEach(e=>{var o;if("inline"!==e.type)return;let{children:s}=e,a=null!==(o=null==s?void 0:s.flatMap(e=>{if("text"!==e.type)return[e];let o=[...e.content.matchAll(t)];if(!o.length)return[e];let s=0,a=[];for(let t of o){let o=t.index+(t[0].startsWith(" ")?1:0),l=t.index+t[0].length;if(o>s&&a.push(Object.assign({},e,{type:"text",content:e.content.substring(s,o)})),r){let r=this.options.items.find(e=>t[2].startsWith(e.id)||t[2].startsWith(e.label));if(r){a.push(Object.assign({},e,{type:"mention",content:null==r?void 0:r.label}));let o=t[0].trim().replace(n,"").replace(r.label,"");o.length&&a.push(Object.assign({},e,{type:"text",content:o}))}else a.push(Object.assign({},e,{type:"text",content:t[1]}));t[0].endsWith(" ")&&a.push(Object.assign({},e,{type:"text",content:" "}))}else a.push(Object.assign({},e,{type:"mention",content:t[2].trim()}));s=l}return s<e.content.length&&a.push(Object.assign({},e,{type:"text",content:e.content.substring(s)})),a}))&&void 0!==o?o:[];e.children=a})})})}}}}}})},589764:function(e,t,n){"use strict";n.d(t,{Z:function(){return MarkdownToolbar}});var r=n(824246),o=n(937057);function MarkdownToolbar(e){let{enableMath:t=!1,enableCourseTools:n=!1}=e;return(0,r.jsxs)(o.qJ,{children:[(0,r.jsx)(o.h6,{}),(0,r.jsx)(o.JH,{}),(0,r.jsx)(o.n3,{}),(0,r.jsx)(o.BI,{}),(0,r.jsx)(o.o0,{}),n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Qj,{}),(0,r.jsx)(o.tg,{}),(0,r.jsx)(o.Df,{}),(0,r.jsx)(o.Eo,{}),(0,r.jsx)(o.au,{}),(0,r.jsx)(o.K2,{}),(0,r.jsx)(o.e4,{}),(0,r.jsx)(o._3,{}),(0,r.jsx)(o.zA,{}),(0,r.jsx)(o.j9,{}),(0,r.jsx)(o.ic,{})]}),(0,r.jsx)(o.bt,{}),(0,r.jsx)(o.pu,{}),(0,r.jsx)(o.cU,{}),(0,r.jsx)(o.nk,{}),(0,r.jsx)(o.Px,{}),(0,r.jsx)(o.zI,{}),(0,r.jsx)(o.Ou,{}),t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.tJ,{}),(0,r.jsx)(o.Rq,{})]})]})}},767906:function(e,t,n){"use strict";n.d(t,{k:function(){return ReviewerCopilotButton}});var r=n(824246),o=n(713222),s=n(855549),a=n(827378),l=n(568334);function ReviewerCopilotButton(){let{editor:e}=(0,s.fi)(),[t,n]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(e)return e.on("transaction",handleTransaction),()=>{e.off("transaction",handleTransaction)};function handleTransaction(e){let t=e.transaction.getMeta(l.j.ENABLED_CHANGE);void 0!==t&&n(t)}},[e]);let i=(0,a.useCallback)(()=>{e&&!e.state.selection.empty&&e.chain().focus().setCopilotSelection({empty:!1,from:e.state.selection.from,to:e.state.selection.to,text:e.state.doc.content.textBetween(e.state.selection.from,e.state.selection.to)}).setCopilotOpen(!0).run()},[e]);return e&&t?(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Fact Checker",tooltipProps:{delayDuration:0},onClick:i,icon:"magnifying-glass",size:"sm"})}):null}},937057:function(e,t,n){"use strict";n.d(t,{n3:function(){return BoldButton},_3:function(){return ClearFormattingButton},Ou:function(){return CodeBlockButton},Eo:function(){return ColorButton},K2:function(){return FontFamilyButton},e4:function(){return FontSizeButton},tJ:function(){return FormulaBlockButton},Rq:function(){return FormulaMarkButton},au:function(){return HighlightButton},ic:function(){return IFrameButton},zA:function(){return ImageButton},bt:function(){return InlineCodeButton},BI:function(){return ItalicButton},Qj:function(){return LinkButton},yD:function(){return E},pu:function(){return OrderedListButton},Tg:function(){return N},nk:function(){return QuoteButton},JH:function(){return history_RedoButton},o0:function(){return StrikethroughButton},Px:function(){return TableButton},zI:function(){return TableDropdown},Df:function(){return TextAlignButton},qJ:function(){return ToolbarContainer_ToolbarContainer},tg:function(){return UnderlineButton},h6:function(){return history_UndoButton},cU:function(){return UnorderedListButton},j9:function(){return YoutubeButton}});var r=n(824246);let ToolbarContainer_ToolbarContainer=e=>{let{children:t}=e;return(0,r.jsx)("div",{className:"flex flex-wrap border-solid border-neutral-300 border-b-[1px] bg-neutral-100 rounded-t-md overflow-x-auto",children:t})};var o=n(713222),s=n(855549),a=n(378279);function history_UndoButton(){let{editor:e}=(0,s.fi)(),t=(0,a.Z)();return e?(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Undo",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().undo().run(),icon:"undo",size:"sm",disabled:!e.can().undo()||!t})}):null}function history_RedoButton(){let{editor:e}=(0,s.fi)(),t=(0,a.Z)();return e?(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Redo",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().redo().run(),icon:"redo",size:"sm",disabled:!e.can().redo()||!t})}):null}var l=n(489812),i=n(31605),d=n(513475),u=n(386070),c=n(359183),p=n(214088),m=n(759276),h=n(443512),f=n(518530),g=n(592461),x=n(591821),v=n(857025),b=n(330714),C=n(186445),y=n(373250),w=n(237706),k=n(827378),j=n(583469);function FormatButton(e){let{type:t,icon:n,onToggle:l}=e,{editor:i}=(0,s.fi)(),d=(0,a.Z)();return i?(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:t,tooltipProps:{delayDuration:0},selected:i.isActive(t),onClick:()=>l(i),disabled:!d,icon:n,size:"sm"})}):null}let BoldButton=()=>(0,r.jsx)(FormatButton,{type:"bold",icon:"bold",onToggle:e=>e.chain().focus().toggleBoldWithDefaultToken().run()}),ItalicButton=()=>(0,r.jsx)(FormatButton,{type:"italic",icon:"italic",onToggle:e=>e.chain().focus().toggleItalicWithDefaultToken().run()}),StrikethroughButton=()=>(0,r.jsx)(FormatButton,{type:"strike",icon:"strikethrough",onToggle:e=>e.chain().focus().toggleStrike().run()}),InlineCodeButton=()=>(0,r.jsx)(FormatButton,{type:"code",icon:"code-simple",onToggle:e=>e.chain().focus().toggleCode().run()}),LinkButton=()=>{let{editor:e}=(0,s.fi)(),[t,n]=(0,k.useState)(!1),[o,a]=(0,k.useState)("");return e?(0,r.jsxs)(l.Vq.fC,{open:t,onOpenChange:n,children:[(0,r.jsx)(l.Vq.xz,{children:(0,r.jsx)(FormatButton,{type:"link",icon:"link",onToggle:()=>{var r;if(t){n(!1);return}a((null===(r=e.getAttributes("link"))||void 0===r?void 0:r.href)||""),n(!0)}})}),(0,r.jsxs)(l.Vq.VY,{children:[(0,r.jsx)(l.Vq.Dx,{children:"Link"}),(0,r.jsxs)(l.kC,{direction:"column",gap:"3",children:[(0,r.jsxs)(i.N,{size:"1",children:[(0,r.jsx)(d.E,{children:"URL"}),(0,r.jsx)(u.f,{value:o,onChange:e=>a(e.target.value)})]}),(0,r.jsxs)(l.kC,{direction:"row",gap:"3",justify:"end",children:[(0,r.jsx)(c.z,{variant:"outline",onClick:()=>{e.chain().focus().unsetLink().run(),n(!1)},children:"Remove"}),(0,r.jsx)(c.z,{onClick:()=>{o?e.chain().focus().setLink({href:o}).run():e.chain().focus().unsetLink().run(),n(!1)},children:"Done"})]})]})]})]}):null},UnderlineButton=()=>(0,r.jsx)(FormatButton,{type:"underline",icon:"underline",onToggle:e=>e.chain().focus().toggleUnderline().run()}),TextAlignButton=()=>{var e;let{editor:t}=(0,s.fi)(),[n,a]=(0,k.useState)(!1);if(!t)return null;let i=(null===(e=t.getAttributes("textStyle"))||void 0===e?void 0:e.textAlign)||"left";return(0,r.jsxs)(p.fC,{open:n,onOpenChange:a,children:[(0,r.jsx)(p.xz,{children:(0,r.jsx)(l.kC,{p:"2",children:(0,r.jsx)(o.J,{tooltip:"Text Align",icon:"indent",size:"sm",selected:"left"!==i,onClick:()=>a(!n)})})}),(0,r.jsx)(p.VY,{size:"1",children:(0,r.jsx)(l.kC,{direction:"column",gap:"2",children:[{value:"left",icon:"align-left",label:"Align Left"},{value:"center",icon:"align-center",label:"Align Center"},{value:"right",icon:"align-right",label:"Align Right"},{value:"justify",icon:"align-justify",label:"Justify"}].map((e,n)=>(0,r.jsx)(l.kC,{justify:"start",children:(0,r.jsx)(c.z,{color:i===e.value?"accent":"neutral",variant:"ghost",onClick:()=>{t.chain().focus().setTextAlign(e.value).run(),a(!1)},children:(0,r.jsxs)(l.kC,{gap:"2",align:"center",children:[(0,r.jsx)(o.J,{icon:e.icon,size:"sm"}),(0,r.jsx)(m.xv,{size:"1",children:e.label})]})},n)},n))})})]})},ImageButton=()=>{var e;let t;(e=t||(t={})).Url="URL",e.FileUpload="File Upload";let{editor:n}=(0,s.fi)(),[a,p]=(0,k.useState)(!1),[y,w]=(0,k.useState)(""),[S,T]=(0,k.useState)(""),[E,N]=(0,k.useState)(null),[M,R]=(0,k.useState)("URL");return n?(0,r.jsxs)(l.Vq.fC,{open:a,onOpenChange:p,children:[(0,r.jsx)(l.Vq.xz,{children:(0,r.jsx)(l.kC,{p:"2",children:(0,r.jsx)(o.J,{tooltip:"Image",icon:"image",size:"sm",onClick:()=>{if(a){p(!1);return}w(""),T(""),R("URL"),N(null),p(!0)}})})}),(0,r.jsxs)(l.Vq.VY,{children:[(0,r.jsx)(l.Vq.Dx,{children:"Image"}),(0,r.jsxs)(l.kC,{direction:"column",gap:"3",children:[(0,r.jsx)(h.fC,{value:M,onValueChange:e=>R(e),children:(0,r.jsx)(h.aV,{size:"1",children:Object.values(t).map((e,t)=>(0,r.jsx)(f.S,{value:e,children:(0,r.jsx)(m.xv,{size:"1",children:e})},t))})}),"URL"===M&&(0,r.jsxs)(i.N,{size:"1",children:[(0,r.jsx)(d.E,{children:"URL"}),(0,r.jsx)(u.f,{value:y,onChange:e=>w(e.target.value)})]}),"File Upload"===M&&(0,r.jsxs)(i.N,{size:"1",children:[(0,r.jsx)(d.E,{children:"Upload image"}),(0,r.jsx)(g.O,{maxSize:10485760,accept:".jpg,.jpeg,.png",onFilesChange:e=>N(e[0]),children:(0,r.jsxs)(l.kC,{direction:"column",gap:"2",children:[(0,r.jsxs)(l.kC,{gap:"2",align:"center",children:[(0,r.jsxs)(x.K,{children:[(0,r.jsx)(v.J,{color:"neutral",icon:j.A$k,label:"Upload"}),(0,r.jsx)(m.xv,{size:"1",children:"Upload File"})]}),(0,r.jsx)(b.$,{})]}),(0,r.jsx)(C.b,{})]})})]}),(0,r.jsxs)(i.N,{size:"1",children:[(0,r.jsx)(d.E,{children:"Alt text"}),(0,r.jsx)(u.f,{value:S,onChange:e=>T(e.target.value)})]}),(0,r.jsx)(l.kC,{direction:"row",gap:"3",justify:"end",children:(0,r.jsx)(c.z,{onClick:()=>{if("File Upload"===M&&E){let e=new FileReader;e.onload=()=>{let t=e.result;n.chain().focus().setImage({src:t,alt:S}).run()},e.readAsDataURL(E)}else"URL"===M&&y?n.chain().focus().setImage({src:y,alt:S}).run():n.chain().focus().deleteSelection().run();p(!1)},children:"Done"})})]})]})]}):null},ColorButton=()=>{let{editor:e}=(0,s.fi)(),[t,n]=(0,k.useState)(!1);return e?(0,r.jsxs)(l.Vq.fC,{open:t,onOpenChange:n,children:[(0,r.jsx)(l.Vq.xz,{children:(0,r.jsx)(FormatButton,{type:"color",icon:"palette",onToggle:()=>n(!t)})}),(0,r.jsxs)(l.Vq.VY,{style:{width:"fit-content"},children:[(0,r.jsx)(l.Vq.Dx,{children:"Text color"}),(0,r.jsxs)(l.kC,{direction:"column",gap:"3",children:[(0,r.jsx)(w.xS,{width:"300px",color:e.getAttributes("textStyle").color||"#000000FF",onChange:t=>{let{r:n,g:r,b:o,a:s}=t.rgb,a="rgba(".concat(n,", ").concat(r,", ").concat(o,", ").concat(s,")");e.chain().focus().setColor(a).run()}}),(0,r.jsxs)(l.kC,{direction:"row",gap:"3",justify:"end",children:[(0,r.jsx)(c.z,{variant:"outline",onClick:()=>e.chain().focus().unsetColor().run(),children:"Reset"}),(0,r.jsx)(c.z,{onClick:()=>n(!1),children:"Done"})]})]})]})]}):null},HighlightButton=()=>{var e;let{editor:t}=(0,s.fi)(),[n,o]=(0,k.useState)(!1);return t?(0,r.jsxs)(l.Vq.fC,{open:n,onOpenChange:o,children:[(0,r.jsx)(l.Vq.xz,{children:(0,r.jsx)(FormatButton,{type:"highlight",icon:"highlighter",onToggle:()=>o(!n)})}),(0,r.jsxs)(l.Vq.VY,{style:{width:"fit-content"},children:[(0,r.jsx)(l.Vq.Dx,{children:"Highlight color"}),(0,r.jsxs)(l.kC,{direction:"column",gap:"3",children:[(0,r.jsx)(w.xS,{disableAlpha:!0,width:"300px",color:(null===(e=t.getAttributes("highlight"))||void 0===e?void 0:e.color)||"#FFFF00",onChange:e=>{let{r:n,g:r,b:o}=e.rgb,s="rgb(".concat(n,", ").concat(r,", ").concat(o,")");t.chain().focus().toggleHighlight({color:s}).run()}}),(0,r.jsxs)(l.kC,{direction:"row",gap:"3",justify:"end",children:[(0,r.jsx)(c.z,{variant:"outline",onClick:()=>t.chain().focus().unsetHighlight().run(),children:"Reset"}),(0,r.jsx)(c.z,{onClick:()=>o(!1),children:"Done"})]})]})]})]}):null},FontFamilyButton=()=>{var e;let{editor:t}=(0,s.fi)(),[n,a]=(0,k.useState)(!1);if(!t)return null;let i=null===(e=t.getAttributes("textStyle"))||void 0===e?void 0:e.fontFamily;return(0,r.jsxs)(p.fC,{open:n,onOpenChange:a,children:[(0,r.jsx)(p.xz,{children:(0,r.jsx)(l.kC,{p:"2",children:(0,r.jsx)(o.J,{tooltip:"Font",icon:"font",size:"sm",selected:i,onClick:()=>a(!n)})})}),(0,r.jsx)(p.VY,{size:"1",children:(0,r.jsx)(l.kC,{direction:"column",gap:"2",children:[{value:"sans-serif",label:"Sans-serif"},{value:"serif",label:"Serif"},{value:'"comic sans ms"',label:"Comic Sans"},{value:"monospace",label:"Monospace"},{value:"cursive",label:"Cursive"}].map((e,n)=>(0,r.jsx)(c.z,{color:(i||"sans-serif")===e.value?"accent":"neutral",variant:"ghost",onClick:()=>{"sans-serif"===e.value?t.chain().focus().unsetFontFamily().run():t.chain().focus().setFontFamily(e.value).run(),a(!1)},style:{fontFamily:e.value},children:e.label},n))})})]})},YoutubeButton=()=>{let{editor:e}=(0,s.fi)(),[t,n]=(0,k.useState)(!1),[a,p]=(0,k.useState)(""),[m,h]=(0,k.useState)(100),[f,g]=(0,k.useState)(500),[x,v]=(0,k.useState)(""),[b,C]=(0,k.useState)(""),validateWidth=e=>{e<10||e>100?v("Width must be between 10% and 100%."):v("")},validateHeight=e=>{e<100||e>500?C("Height must be between 100px and 500px."):C("")};return e?(0,r.jsxs)(l.Vq.fC,{open:t,onOpenChange:n,children:[(0,r.jsx)(l.Vq.xz,{children:(0,r.jsx)(l.kC,{p:"2",children:(0,r.jsx)(o.J,{tooltip:"YouTube Video",icon:"video",size:"sm",selected:e.isActive("youtube"),onClick:()=>{var r;if(t){n(!1);return}let o=e.getAttributes("youtube")||{};p(o.src||""),h(parseInt(null===(r=o.width)||void 0===r?void 0:r.replace("%",""))||100),g(parseInt(o.height)||500),v(""),C(""),n(!0)}})})}),(0,r.jsxs)(l.Vq.VY,{children:[(0,r.jsx)(l.Vq.Dx,{children:"YouTube Video"}),(0,r.jsxs)(l.kC,{direction:"column",gap:"3",children:[(0,r.jsxs)(i.N,{size:"1",children:[(0,r.jsx)(d.E,{children:"URL"}),(0,r.jsx)(u.f,{value:a,onChange:e=>p(e.target.value)})]}),(0,r.jsxs)(i.N,{size:"1",children:[(0,r.jsx)(d.E,{children:"Width"}),(0,r.jsxs)(l.kC,{align:"center",gap:"2",children:[(0,r.jsx)(u.f,{type:"number",value:m,onChange:e=>{let t=parseInt(e.target.value)||0;h(t),validateWidth(t)}}),"%"]}),x&&(0,r.jsx)(y.u,{color:"error",children:x})]}),(0,r.jsxs)(i.N,{size:"1",children:[(0,r.jsx)(d.E,{children:"Height"}),(0,r.jsxs)(l.kC,{align:"center",gap:"2",children:[(0,r.jsx)(u.f,{type:"number",value:f,onChange:e=>{let t=parseInt(e.target.value)||0;g(t),validateHeight(t)}}),"px"]}),b&&(0,r.jsx)(y.u,{color:"error",children:b})]}),(0,r.jsx)(l.kC,{direction:"row",gap:"3",justify:"end",children:(0,r.jsx)(c.z,{onClick:()=>{a?e.chain().focus().setYoutubeVideoWithStringParams({src:a,width:"".concat(m,"%"),height:"".concat(f)}).run():e.chain().focus().deleteSelection().run(),n(!1)},disabled:!!x||!!b,children:"Done"})})]})]})]}):null},IFrameButton=()=>{let{editor:e}=(0,s.fi)(),[t,n]=(0,k.useState)(!1),[a,p]=(0,k.useState)(""),[m,h]=(0,k.useState)(100),[f,g]=(0,k.useState)(500);return e?(0,r.jsxs)(l.Vq.fC,{open:t,onOpenChange:n,children:[(0,r.jsx)(l.Vq.xz,{children:(0,r.jsx)(l.kC,{p:"2",children:(0,r.jsx)(o.J,{tooltip:"Embed Website",icon:"browser",size:"sm",selected:e.isActive("iframe"),onClick:()=>{if(t){n(!1);return}let r=e.getAttributes("iframe")||{};p(r.src||""),h(parseInt(r.width)||100),g(parseInt(r.height)||500),n(!0)}})})}),(0,r.jsxs)(l.Vq.VY,{children:[(0,r.jsx)(l.Vq.Dx,{children:"Embed Website"}),(0,r.jsxs)(l.kC,{direction:"column",gap:"3",children:[(0,r.jsxs)(i.N,{size:"1",children:[(0,r.jsx)(d.E,{children:"URL"}),(0,r.jsx)(u.f,{value:a,onChange:e=>p(e.target.value)})]}),(0,r.jsxs)(i.N,{size:"1",children:[(0,r.jsx)(d.E,{children:"Width"}),(0,r.jsxs)(l.kC,{align:"center",gap:"2",children:[(0,r.jsx)(u.f,{type:"number",value:m,onChange:e=>{let t=Math.min(100,Math.max(10,parseInt(e.target.value)||100));h(t)}}),"%"]})]}),(0,r.jsxs)(i.N,{size:"1",children:[(0,r.jsx)(d.E,{children:"Height"}),(0,r.jsxs)(l.kC,{align:"center",gap:"2",children:[(0,r.jsx)(u.f,{type:"number",value:f,onChange:e=>{let t=Math.min(1e3,Math.max(100,parseInt(e.target.value)||500));g(t)}}),"px"]})]}),(0,r.jsx)(l.kC,{direction:"row",gap:"3",justify:"end",children:(0,r.jsx)(c.z,{onClick:()=>{a?e.chain().focus().setIframe({src:a,width:"".concat(m,"%"),height:"".concat(f,"px")}).run():e.chain().focus().deleteSelection().run(),n(!1)},children:"Done"})})]})]})]}):null},ClearFormattingButton=()=>{let{editor:e}=(0,s.fi)();return e?(0,r.jsx)(FormatButton,{type:"Clear Text Formatting",icon:"eraser",onToggle:e=>e.chain().focus().unsetAllMarks().run()}):null},FontSizeButton=()=>{let{editor:e}=(0,s.fi)(),[t,n]=(0,k.useState)(!1);if(!e)return null;let a=[...Array.from({length:20},(e,t)=>{let n=8+4*t;return{value:"".concat(n,"px"),label:"".concat(n,"px")}}),{value:"unset",label:"Unset"}],i=(()=>{let{from:t,to:n}=e.state.selection,r=new Set;return e.state.doc.nodesBetween(t,n,e=>{var t;let n=(null===(t=e.marks)||void 0===t?void 0:t.map(e=>e.attrs.fontSize))||[];n.forEach(e=>{e&&r.add(e)})}),r})(),d=i.size>1;return(0,r.jsxs)(p.fC,{open:t,onOpenChange:n,children:[(0,r.jsx)(p.xz,{children:(0,r.jsx)(l.kC,{p:"2",children:(0,r.jsx)(o.J,{tooltip:"Font Size",icon:"text-size",size:"sm",selected:i.size>0,onClick:()=>n(!t)})})}),(0,r.jsx)(p.VY,{size:"1",children:(0,r.jsx)(l.kC,{direction:"column",gap:"2",children:a.map((t,o)=>(0,r.jsx)(c.z,{color:d||!i.has(t.value)?"neutral":"accent",variant:"ghost",onClick:()=>{"unset"===t.value?e.chain().focus().unsetFontSize().run():e.chain().focus().setFontSize(t.value).run(),n(!1)},children:t.label},o))})})]})};function UnorderedListButton(){let{editor:e}=(0,s.fi)(),t=(0,a.Z)();return e?(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Unordered List",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().toggleBulletListWithDefaultToken().run(),icon:"list-ul",size:"sm",selected:e.isActive("bulletList"),disabled:!t})}):null}function OrderedListButton(){let{editor:e}=(0,s.fi)(),t=(0,a.Z)();return e?(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Ordered List",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().toggleOrderedList().run(),icon:"list-ol",size:"sm",selected:e.isActive("orderedList"),disabled:!t})}):null}function CodeBlockButton(){let{editor:e}=(0,s.fi)(),t=(0,a.Z)();return e?(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Code Block",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().toggleCodeBlock().run(),icon:"code",size:"sm",selected:e.isActive("codeBlock"),disabled:!t})}):null}function QuoteButton(){let{editor:e}=(0,s.fi)(),t=(0,a.Z)();return e?(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Quote",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().toggleBlockquote().run(),icon:"quote-left",size:"sm",selected:e.isActive("blockquote"),disabled:!t})}):null}function TableButton(){let{editor:e}=(0,s.fi)(),t=(0,a.Z)();return!e||(null==e?void 0:e.isActive("table"))?null:(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Insert Table",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run(),icon:"table",size:"sm",disabled:!t})})}function TableDropdown(){let{editor:e}=(0,s.fi)(),t=(0,a.Z)(),n=(0,k.useCallback)(()=>{if(e){if(e.isActive("tableHeader")){e.chain().focus().deleteRow().toggleHeaderRow().run();return}e.chain().focus().deleteRow().run()}},[e]),l=(0,k.useCallback)(()=>{if(e){if(e.isActive("tableHeader")){e.chain().toggleHeaderRow().addRowBefore().command(t=>{let{tr:n,chain:r}=t;if(e.isActive("table")){let{anchor:e}=n.selection,t=0;return n.doc.descendants((n,r)=>{"table"===n.type.name&&e>=r&&e<=r+n.nodeSize&&(t=r)}),r().focus(t+2).toggleHeaderRow(),!0}return!1}).run();return}e.chain().focus().addRowBefore().run()}},[e]);return e&&t&&e.isActive("table")?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"inline-block w-0.5 self-stretch bg-neutral-200"}),(0,r.jsx)("div",{className:"p-2 text-xs flex items-center",children:"Table:"}),(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Delete Table",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().deleteTable().run(),icon:"times",size:"sm",disabled:!t})}),(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Add row before",tooltipProps:{delayDuration:0},onClick:l,icon:"diagram-previous",size:"sm",disabled:!t})}),(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Add row after",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().addRowAfter().run(),icon:"diagram-next",size:"sm",disabled:!t})}),(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Delete row",tooltipProps:{delayDuration:0},onClick:n,icon:"diagram-cells",size:"sm",disabled:!t})}),(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Add column before",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().addColumnBefore().run(),icon:"border-left",size:"sm",disabled:!t})}),(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Add column after",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().addColumnAfter().run(),icon:"border-right",size:"sm",disabled:!t})}),(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Delete column",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().deleteColumn().run(),icon:"border-none",size:"sm",disabled:!t})}),(0,r.jsx)("div",{className:"inline-block w-0.5 self-stretch bg-neutral-200"})]}):null}function FormulaBlockButton(){let{editor:e}=(0,s.fi)(),t=(0,a.Z)();return e?(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Formula Block",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().toggleFormulaBlock().run(),icon:"square-root-variable",size:"sm",selected:e.isActive("math_display"),disabled:!t})}):null}function FormulaMarkButton(){let{editor:e}=(0,s.fi)(),t=(0,a.Z)();return e?(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(o.J,{tooltip:"Inline Formula",tooltipProps:{delayDuration:0},onClick:()=>e.chain().focus().toggleFormulaMark().run(),icon:"less-than-equal",size:"sm",selected:e.isActive("math_inline"),disabled:!t})}):null}var S=n(214317),T=n(767906),E=(0,k.memo)(function(e){let{enableMath:t=!1}=e,{editor:n}=(0,s.fi)();return n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.Z,{name:"ReadOnlyFloatingMenu",shouldShow:e=>{let{editor:t}=e;return!t.isEditable&&!t.state.selection.empty},children:(0,r.jsx)(T.k,{})}),(0,r.jsxs)(S.Z,{name:"EditableFloatingMenu",shouldShow:e=>{let{editor:t}=e;return t.isEditable&&!t.state.selection.empty},children:[(0,r.jsx)(BoldButton,{}),(0,r.jsx)(ItalicButton,{}),(0,r.jsx)(StrikethroughButton,{}),(0,r.jsx)(InlineCodeButton,{}),t&&(0,r.jsx)(FormulaMarkButton,{}),(0,r.jsx)(T.k,{})]})]}):null}),N=(0,k.memo)(function(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(S.Z,{name:"PlaintextFloatingMenu",shouldShow:e=>{let{editor:t}=e;return!t.state.selection.empty},children:(0,r.jsx)(T.k,{})})})});n(589764)},214317:function(e,t,n){"use strict";n.d(t,{Z:function(){return FloatingMenu}});var r=n(824246),o=n(855549);function FloatingMenu(e){let{name:t="FloatingMenu",shouldShow:n,children:s}=e,{editor:a}=(0,o.fi)();return a?(0,r.jsx)(o.NM,{pluginKey:t,shouldShow:n,editor:a,tippyOptions:{duration:100},children:(0,r.jsx)("div",{className:"flex border-solid border-neutral-300 border bg-neutral-100 rounded-md shadow",children:s})}):null}},470623:function(e,t,n){"use strict";n.d(t,{Z:function(){return A}});var r,o,s=n(824246),a=n(827378),l=n(722030),i=n(776845),d=n(713222),u=n(412937),c=n(339389),p=n(416534),m=n(788524),h=n(37190);n(729205);var f=n(577997),g=n(789018),x=n(456552),v=n(173286),b=n(854358),C=n(813306),y=n(784200),w=n(588039),k=n(441993),j=n(986910),S=n(965167);let T=y.z.object({feedbackResponse:y.z.nativeEnum(b.FeedbackResponseType),errorCategory:y.z.string().optional(),otherFeedback:y.z.string().optional()}).refine(e=>e.feedbackResponse!==b.FeedbackResponseType.Dismiss||("Other"===e.errorCategory?void 0!==e.otherFeedback:void 0!==e.errorCategory));(r=o||(o={})).IncorrectVerdict="Incorrect Verdict",r.IncorrectReasoning="Incorrect Reasoning",r.ReasoningTooWordy="Reasoning too wordy",r.IncorrectLinks="Incorrect Links",r.TooManyLinks="Too many links",r.IncorrectClaimHighlighted="Incorrect Claim Highlighted",r.Other="Other";let ReviewerCopilotResultFeedback=e=>{let{inferenceId:t,reviewerCopilotResult:n,hasFeedback:r,setFeedback:m}=e,{handleSubmit:h,watch:f,setValue:x}=(0,w.cI)({mode:"onBlur",resolver:(0,k.F)(T)}),v=f("feedbackResponse"),C=f("errorCategory"),y=f("otherFeedback"),[S,E]=a.useState(!1),N=(0,a.useCallback)(async e=>{if(!S){E(!0);try{await g.Z.genai.sendReviewerCopilotFeedback({inferenceId:t,claimId:n.id,result:e.feedbackResponse,errorCategory:e.errorCategory,otherFeedback:e.otherFeedback}),m(e)}catch(e){j.Am.error(e.message)}E(!1)}},[S,E,t,n.id,m]);return S?(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(l.$,{size:"sm"})}):r?(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(i.ZT.Paragraph2,{className:"font-medium",children:"Thank you for your feedback!"})}):(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)(i.ZT.Paragraph2,{className:"font-medium",children:"Was this helpful/accurate?"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(d.J,{icon:[v===b.FeedbackResponseType.Accept?"fas":"far","thumbs-up"],size:"sm",onClick:()=>{x("feedbackResponse",b.FeedbackResponseType.Accept),h(N)()}}),(0,s.jsx)(d.J,{icon:[v===b.FeedbackResponseType.Dismiss?"fas":"far","thumbs-down"],size:"sm",onClick:()=>x("feedbackResponse",b.FeedbackResponseType.Dismiss)})]}),v===b.FeedbackResponseType.Dismiss&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)(u.S,{label:"Select Error Category",options:Object.keys(o).map(e=>({id:e,name:o[e]})),selectedOptionId:C||"",setSelected:e=>{x("errorCategory",e),"Other"!==e&&h(N)()}}),"Other"===C&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)(i.ZT.Paragraph2,{className:"font-medium",children:"Other Feedback:"}),(0,s.jsx)(c.K,{value:y,onChange:e=>x("otherFeedback",e.target.value),rows:2}),(0,s.jsx)(p.zx,{variant:"primary",size:"sm",onClick:h(N),className:"mt-2",children:"Submit"})]})]})]})},ReviewerCopilotResultViewer=e=>{let{inferenceId:t,reviewerCopilotResult:n,hasFeedback:r,setFeedback:o}=e,{claim:a,verdict:l,reasoning:d,links:u}=n;return(0,s.jsxs)("div",{children:[a&&(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsxs)(i.ZT.Paragraph2,{children:[(0,s.jsx)("span",{className:"font-medium",children:"Claim:"})," ",a]})}),(0,s.jsxs)("div",{className:"flex flex-row gap-2 items-center mb-2",children:[(0,s.jsx)(i.ZT.Paragraph2,{className:"font-medium",children:"Validation Verdict:"}),(e=>{let t=e.toLowerCase();return t.includes("true")?(0,s.jsx)(m.V,{variant:"success",children:"True"}):t.includes("false")?(0,s.jsx)(m.V,{variant:"danger",children:"False"}):(0,s.jsx)(m.V,{variant:"neutral",children:e})})(l)]}),(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsxs)(i.ZT.Paragraph2,{children:[(0,s.jsx)("span",{className:"font-medium",children:"Reasoning:"})," ",d]})}),null==u?void 0:u.map((e,t)=>(0,s.jsxs)("a",{className:"flex gap-1 items-center text-primary-400",target:"_blank",rel:"noopener noreferrer",href:e,children:[new URL(e).hostname,(0,s.jsx)(h.s,{icon:["fas","external-link-alt"],contrastText:!0,edge:"end",variant:"secondary"})]},t)),(0,s.jsx)(ReviewerCopilotResultFeedback,{inferenceId:t,reviewerCopilotResult:n,hasFeedback:r,setFeedback:o},n.id)]})};var E=n(232095),N=n(855549),M=n(276281),R=n(568334),A=(0,a.memo)(e=>{let{enabled:t=!1,anchorRef:n,isLeftPosition:r=!1}=e,{editor:o}=(0,N.fi)(),[i,d]=(0,a.useState)(!1),[u,c]=(0,a.useState)({from:0,to:0,empty:!0,text:void 0});(0,a.useEffect)(()=>{o&&(null==o||o.commands.setCopilotEnabled(t))},[o,t]),(0,a.useEffect)(()=>{if(o)return o.on("transaction",handleTransaction),()=>{o.off("transaction",handleTransaction)};function handleTransaction(e){let t=e.transaction.getMeta(R.j.OPEN_CHANGE),n=e.transaction.getMeta(R.j.SELECTED_CHANGE);void 0!==t&&d(t),void 0!==n&&c(n)}},[o]);let p=(0,v.Z)(u.text,400),[m,h]=a.useState({}),b=(0,S.Xn)(E.InteractionStepType.PromptInput),y=(0,S.Xn)(E.InteractionStepType.MultiTurnContinue),w=[...b,...y].flatMap(e=>e.context.referenceTexts||[]),[k,j]=(0,a.useState)(null),T=(0,a.useContext)(C.p),[A,P]=a.useState(0),{data:I,error:L,isLoading:B}=(0,x.useQuery)({queryFn:async()=>!p||p.length<=15?Promise.resolve({results:[],inferenceId:""}):g.Z.genai.fetchReviewerCopilotInference({content:p,taskId:T.taskId,projectId:T.projectId,assignmentId:T.assignmentId,referenceTexts:w}),queryKey:[open,p],staleTime:1/0,enabled:t&&i});(0,a.useEffect)(()=>{P(0),h({}),p||(d(!1),null==o||o.commands.setCopilotOpen(!1))},[o,p]);let _=(0,a.useCallback)(()=>{o&&o.commands.setCopilotOpen(!1)},[o]),D=u&&o&&u.from>=0&&u.from<=o.view.state.doc.content.size,O=D?o.view.coordsAtPos(u.from):void 0,F=O&&n.current?O.top-n.current.getBoundingClientRect().top:0,{styles:z,attributes:H}=(0,M.D)(n.current,k,{placement:r?"left-start":"right-start",modifiers:[{name:"offset",options:{offset:[F,28]}},{name:"preventOverflow",options:{mainAxis:!1}}]});return!L&&o&&t&&i?(0,s.jsx)("div",{ref:j,style:z.popper,...H.popper,className:"z-30 flex",children:(0,s.jsxs)(f.p,{className:"w-80",children:[(0,s.jsxs)(f.p.Header,{className:"px-3 border-b border-neutral-200",children:[(0,s.jsx)(f.p.HeaderLeft,{children:(0,s.jsx)(f.p.Subtitle,{children:"Fact Checker"})}),(0,s.jsxs)(f.p.HeaderRight,{className:"gap-1 flex flex-row justify-start",children:[(null==I?void 0:I.results)&&I.results.length>1&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.p.Button,{icon:"chevron-left",onClick:()=>{A>0&&P(A-1)},disabled:0===A}),(0,s.jsx)(f.p.Button,{icon:"chevron-right",onClick:()=>{(null==I?void 0:I.results)&&I.results.length&&A<I.results.length-1&&P(A+1)},disabled:A===I.results.length-1})]}),(0,s.jsx)(f.p.Button,{icon:"times",onClick:_})]})]}),(0,s.jsxs)(f.p.Body,{className:"border-t-0 mb-1",children:[B&&(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)(l.$,{size:"sm"})}),(null==I?void 0:I.results)&&I.results.length>0&&A<I.results.length&&I.inferenceId&&(0,s.jsx)(ReviewerCopilotResultViewer,{inferenceId:I.inferenceId,reviewerCopilotResult:I.results[A],hasFeedback:!!m[I.results[A].id],setFeedback:e=>{h(t=>({...t,[I.results[A].id]:e}))}}),(null==I?void 0:I.results)&&(!p||p.length<=15)&&(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("div",{children:"The selection must be at least 15 characters long!"})})]})]})}):null})},813306:function(e,t,n){"use strict";n.d(t,{p:function(){return o}});var r=n(827378);let o=(0,r.createContext)({})},63275:function(e,t,n){"use strict";n.d(t,{U:function(){return s}});var r=n(236125),o=n(527467);let s=(0,r.Ue)()((0,o.mW)((e,t)=>({childIdToReadOnlyState:{},setReadOnlyStateForChildId:(t,n)=>e(e=>({childIdToReadOnlyState:{...e.childIdToReadOnlyState,[t]:n}})),selectedCustomCodeEnvironment:{},setSelectedCustomCodeEnvironment:(t,n)=>e(e=>({selectedCustomCodeEnvironment:{...e.selectedCustomCodeEnvironment,[t]:n}})),getSelectedCustomCodeEnvironment:e=>t().selectedCustomCodeEnvironment[e],scratchpadOpenState:{},setScratchpadOpenState:(t,n)=>e(e=>({scratchpadOpenState:{...e.scratchpadOpenState,[t]:n}})),getScratchpadOpenState:e=>{var n;return null!==(n=t().scratchpadOpenState[e])&&void 0!==n&&n}})))},614035:function(e,t,n){"use strict";var r=n(827378);t.Z=function(e){let t=(0,r.useRef)(e);return t.current=e,t}},107786:function(e,t,n){"use strict";n.d(t,{Z:function(){return useStateDelayed}});var r=n(827378);function useStateDelayed(e,t){let[n,o]=(0,r.useState)(e),s=(0,r.useRef)(null),a=(0,r.useRef)(!1);(0,r.useEffect)(()=>(a.current=!0,()=>{a.current=!1}),[]);let l=(0,r.useCallback)(e=>{null!==s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{a.current&&o(e),s.current=null},t)},[o,t]);return[n,l]}},729205:function(e,t,n){"use strict";n.d(t,{y:function(){return s},z:function(){return constructStepChildId}});var r=n(236125),o=n(527467);let constructStepChildId=(e,t)=>t?"".concat(e.type,"-").concat(e.responseIndex,"-").concat(t):"".concat(e.type,"-").concat(e.responseIndex),s=(0,r.Ue)()((0,o.mW)((0,o.XR)((e,t)=>({workerComments:[],selectedWorkerComment:null,selection:{from:0,to:0,empty:!0,childId:""},addWorkerComment:t=>{t.comment.length&&e(e=>({workerComments:[...e.workerComments,t]}))},setWorkerComments:t=>{e({workerComments:t})},setSelection:t=>{e(e=>({selection:t}))},deleteSelection:()=>{e({selection:{from:0,to:0,empty:!0,childId:""}})},getAllWorkerCommentsByChildId:e=>t().workerComments.filter(t=>t.childId===e),selectWorkerComment:t=>{e(e=>({selectedWorkerComment:t}))},getWorkerCommentByChildId:e=>t().workerComments.find(t=>t.childId===e),getWorkerCommentById:e=>t().workerComments.find(t=>t.workerCommentId===e),updateWorkerComment:(t,n,r)=>{e(e=>({workerComments:e.workerComments.map(e=>e.workerCommentId===t?{...e,comment:n,title:null!=r?r:e.title}:e)}))},updateWorkerCommentLocation(t,n){e(e=>({workerComments:e.workerComments.map(e=>{if(e.workerCommentId!==t)return e;{let[t,r]=n([e.locationStart,e.locationEnd]);return{...e,locationStart:t,locationEnd:r}}})}))},batchUpdateWorkerCommentLocations(t){e(e=>{let n=t.map(e=>e.id);return{workerComments:e.workerComments.map(e=>{if(!n.includes(e.workerCommentId))return e;{let n=t.find(t=>t.id===e.workerCommentId),[r,o]=n.updater([e.locationStart,e.locationEnd]);return{...e,locationStart:r,locationEnd:o}}})}})},deleteWorkerComment:t=>{e(e=>({workerComments:e.workerComments.filter(e=>e.workerCommentId!==t)}))},addFeedbackResponseToWorkerComment:(t,n)=>{e(e=>({workerComments:e.workerComments.map(e=>e.workerCommentId===t?{...e,feedbackResponse:n}:e)}))},resetWorkerCommentsFromResponseIndex:(t,n)=>{e(e=>{let r=t.slice(n+1),o=r.map(e=>constructStepChildId(e)),s=e.workerComments.filter(e=>!e.childId||!o.includes(e.childId));return{workerComments:s}})}}))))},577997:function(e,t,n){"use strict";n.d(t,{p:function(){return v}});var r=n(824246),o=n(827378),s=n(720227),a=n(792739),l=n(37190),i=n(834770),d=n(930640),u=n(983341),c=n(276281),p=n(92465),m=n.n(p),h=n(828338),f=n.n(h);let g=(0,o.forwardRef)((e,t)=>{let{badge:n,disabled:o,onClick:a,icon:d,selected:u,tooltip:c,tooltipProps:p,className:m,iconProps:h,enableDisabledTooltip:f}=e,g=(0,r.jsxs)("button",{ref:t,disabled:o,onClick:a,className:(0,s.m)("scaleui transition-all relative border-none focus:outline-none focus:ring-0 flex items-center justify-center rounded w-6 h-6 focus:bg-neutral-300",u&&"focus:bg-inherit bg-neutral-200",!u&&"hover:bg-neutral-200 ",o&&"cursor-not-allowed hover:bg-transparent",m),"data-testid":e["data-testid"],children:[(0,r.jsx)(l.s,{icon:d,variant:"neutral",size:"sm",disabled:o,contrastText:u,iconProps:h}),n&&(0,r.jsx)("div",{className:"absolute inline-flex items-center justify-center w-5 h-5 text-xs text-neutral-900 bg-primary-100 border border-neutral-0 rounded-full -top-2 -right-2",children:n})]});return c?(0,r.jsx)(i.u,{text:c,target:g,disabled:o&&!f,delayDuration:0,...p}):g}),x=(0,o.createContext)({cardReference:null,readOnly:!1}),v=Object.assign(e=>{let{className:t,children:n,readOnly:a=!1}=e,[l,i]=(0,o.useState)(null);return(0,r.jsx)("div",{"data-testid":"step-card",...e,ref:i,className:(0,s.m)("w-full text-left border border-neutral-200 rounded-lg h-fit scaleui bg-neutral-0 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-400 transition-colors max-w-screen-xl",t),children:(0,r.jsx)(x.Provider,{value:{cardReference:l,readOnly:a},children:n})})},{Header:e=>{let{className:t}=e;return(0,r.jsx)("div",{...e,className:(0,s.m)("flex items-center justify-between w-full bg-neutral-50 rounded-t-lg py-2 px-4",t)})},SubHeaderRow:e=>{let{className:t}=e;return(0,r.jsx)("div",{...e,className:(0,s.m)("flex w-full divide-x divide-neutral-200",t)})},SubHeader:e=>{let{className:t}=e;return(0,r.jsx)("div",{...e,className:(0,s.m)("flex items-center justify-between w-full bg-neutral-50 px-4 py-2",t)})},SubHeaderTitle:e=>{let{className:t}=e;return(0,r.jsx)("div",{...e,className:(0,s.m)("w-full text-neutral-600 font-medium text-xs",t)})},HeaderColumn:e=>{let{className:t}=e;return(0,r.jsx)("div",{...e,className:(0,s.m)("w-full flex flex-col gap-[2px]",t)})},HeaderLeft:e=>{let{className:t}=e;return(0,r.jsx)("div",{...e,className:(0,s.m)("flex items-center w-full gap-3",t)})},HeaderRight:e=>{let{className:t,children:n}=e,{readOnly:a}=(0,o.useContext)(x);return(0,r.jsxs)("div",{...e,className:(0,s.m)("flex ml-2 gap-2 items-center",t),children:[a&&(0,r.jsx)("span",{className:"text-xs text-neutral-500 whitespace-nowrap",children:"Read-only"}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:n})]})},Icon:e=>{let{className:t}=e;return(0,r.jsx)("div",{className:(0,s.m)("flex items-center justify-center rounded-full bg-neutral-0 border border-neutral-200 text-md text-neutral-500 w-8 h-8",t),children:(0,r.jsx)(a.FontAwesomeIcon,{...e})})},Image:e=>{let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,s.m)("flex items-center justify-center rounded-full bg-neutral-0 border border-neutral-200 text-md text-neutral-500 w-8 h-8",t),children:(0,r.jsx)("img",{...n,className:"rounded-full"})})},Superscript:e=>{let{className:t}=e;return(0,r.jsx)("div",{...e,className:(0,s.m)("w-full text-neutral-600 font-normal text-[10px]",t)})},Title:e=>{let{className:t}=e;return(0,r.jsx)("div",{...e,className:(0,s.m)("w-full text-neutral-600 font-semibold text-base",t)})},Subtitle:e=>{let{className:t}=e;return(0,r.jsx)("div",{...e,className:(0,s.m)("w-full text-neutral-600 font-normal text-xs",t)})},Button:g,Body:e=>{let{className:t}=e;return(0,r.jsx)("div",{...e,className:(0,s.m)("py-2 px-4 border-t border-neutral-100",t)})},Footer:e=>{let{className:t}=e;return(0,r.jsx)("div",{...e,className:(0,s.m)("flex items-center w-full px-4 py-3 border-t border-neutral-100",t)})},Popover:e=>{var t,n;let{cardReference:a}=(0,o.useContext)(x),[l,i]=(0,o.useState)(null),[p,h]=(0,o.useState)(null),v=e.useStepCardReference?a:m()(e.referenceElement)?l:e.referenceElement,{styles:b,attributes:C}=(0,c.D)(v,p,{placement:null!==(t=e.placement)&&void 0!==t?t:"bottom-end",modifiers:null!==(n=e.modifiers)&&void 0!==n?n:[{name:"offset",options:{offset:[14,14]}}]}),{children:y,isOpen:w,className:k,...j}=e;return(0,r.jsx)(d.J,{children:t=>{let{open:n,close:o}=t,a=m()(e.isOpen)?n:e.isOpen;return(0,r.jsxs)(r.Fragment,{children:[!e.disablePopoverButton&&(0,r.jsx)(d.J.Button,{ref:i,as:g,...j,selected:a}),(0,r.jsx)(d.J.Panel,{ref:h,style:b.popper,...C.popper,className:(0,s.m)("z-50",k),static:!m()(w),children:(0,r.jsx)(u.u,{show:a,appear:!0,enter:"transition-all duration-300",enterFrom:"opacity-0 -translate-y-1",enterTo:"opacity-100 translate-y-0 ",leave:"transition-all duration-300",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 -translate-y-1",children:f()(y)?y({close:()=>{var t;null===(t=e.onClose)||void 0===t||t.call(e),o()},buttonReference:l,panelReference:p,referenceElement:v}):y})})]})}})},Context:x})},282258:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var r=n(824246),o=n(827378),s=n(682603),a=n(179843),l=n(176927),i=n(481357),d=n(441256),u=n(905035),c=n(303131),p=n(39892);function stripLatex(e){return e.replace(/\\[a-zA-Z]+/g,"").replace(/[{}]/g," ").replace(/[%&_]/g,"").replace(/\s+/g," ").trim()}async function removeMarkdown(e){let t=e.replace(/\\?\\\(([\s\S]*?)\\?\\\)/g,"$$$1$$").replace(/\\\\(\[)([\s\S]*?)\\\\(\])/g,(e,t,n)=>"$$".concat(n,"$$")).replace(/\\\[([\s\S]*?)\\\]/g,(e,t)=>"$$".concat(t,"$$")),n=await (0,c.l)().use(i.Z).use(a.Z).use(l.Z).use(()=>e=>{(0,p.Vn)(e,"table",e=>{let t=[];(0,p.Vn)(e,"text",e=>{t.push(e.value)}),e.type="paragraph",e.children=[{type:"text",value:t.join(" ")}]}),(0,p.Vn)(e,"code",e=>{e.type="paragraph",e.children=[{type:"text",value:e.value}]}),(0,p.Vn)(e,"inlineMath",e=>{e.type="text",e.value=stripLatex(e.value)}),(0,p.Vn)(e,"math",e=>{e.type="paragraph",e.children=[{type:"text",value:stripLatex(e.value)}]}),(0,p.Vn)(e,"image",e=>{e.type="text",e.value=""})}).use(u.Z).use(()=>e=>{(0,p.Vn)(e,"text",e=>{e.value=e.value.trim()})}).use(d.Z).process(t);return n.toString()}function countWords(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en",n=new Intl.Segmenter(t,{granularity:"word"}),r=n.segment(e),o=0,s=null;for(let e of r){if(e.isWordLike){if(s&&"-"===s.segment)continue;o++}s=e}return o}var m=n(965167),h=n(223841),f=n(44579),g=(0,o.memo)(e=>{let{text:t,active:n=!0}=e,[a,l]=(0,o.useState)(0),i=(0,m.t0)(e=>e.languageCode);(0,h.Z)(async()=>{let e=countWords(await removeMarkdown(t),i);l(e)},200,[t,i]),(0,f.Z)(async()=>{let e=countWords(await removeMarkdown(t),i);l(e)});let d=a.toLocaleString("en-US");return(0,r.jsx)(s.A,{"data-testid":"wordCounter",label:"".concat(d," words"),active:n})})},545545:function(){},578028:function(){},850695:function(){},584215:function(){},347021:function(){},450471:function(){},171632:function(){}}]);