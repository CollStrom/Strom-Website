"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[23387],{982489:function(e,t,n){n.d(t,{KH:function(){return s},Q0:function(){return a},_O:function(){return i},mz:function(){return l}});var o=n(599789);let i=5,a="ToolTutorials",s="General",l={[o.InstructionComponentType.Label]:{iconColor:"#00BFA5",iconName:"tag"},[o.InstructionComponentType.Attribute]:{iconColor:"#F8BB06",iconName:"asterisk"},[o.InstructionComponentType.Field]:{iconColor:"#F8BB06",iconName:"asterisk"},[o.InstructionComponentType.Rule]:{iconColor:"#EF3D57",iconName:"pencil-ruler"},[o.InstructionComponentType.RichText]:{iconColor:"#C634C3",iconName:"text-size"},[o.InstructionComponentType.Group]:{iconColor:"#6A11EA",iconName:"folder"},[o.AttachmentInstructionType.Iframe]:{iconColor:"#6A11EA",iconName:"link"},[o.AttachmentInstructionType.Image]:{iconColor:"#6A11EA",iconName:"file-image"},[o.AttachmentInstructionType.Pdf]:{iconColor:"#6A11EA",iconName:"file-pdf"},workflow:{iconColor:"#EF3D57",iconName:"list"},[a]:{iconColor:"#6DD2F0",iconName:"toolbox"}}},367654:function(e,t,n){n.d(t,{S:function(){return b},k:function(){return useProjectInstructionContext}});var o=n(824246),i=n(827378),a=n(298784),s=n.n(a),l=n(686677),r=n(271351),d=n(837553),c=n(571085),p=n(789018),u=n(642830),m=n(599789),h=n(470449),x=n(982489);let quizTimerHooks=e=>{let t;return{startQuizTimer:()=>{t=setInterval(()=>{e(e=>e+1)},1e3)},pauseQuizTimer:()=>{clearInterval(t)}}};var g=n(352991),f=n(749613);let v=i.createContext({quiz:void 0,setQuiz:e=>{},title:"",enableDiff:!0,enableQuiz:!1,extraAlerts:{hasSensitiveContent:!1,isEdgeCase:!1,param_chunks:!1},enableSidePanel:!1,hasVersionComparison:!1,shouldUseNGI:!1,handleStart:()=>null,openQuiz:!1,setEnableDiff:e=>null,setOpenQuiz:e=>{},startButtonText:"",selectedSection:null,selectedPath:[],setSelectedPath:e=>null,searchResult:null,setSearchResult:e=>null,components:[],setComponents:()=>null,showingInstructionsFn:e=>null,setShowingInstructionsFn:e=>{},isMobileView:!1,setIsMobileView:e=>null,disableScrollOnMount:!1,scrollIntoView:-1,scrollToggle:!1,isLoading:!1,isEmbedded:!1,isCorpUser:!1,isOnboarding:!1,isRapidPreview:!1,typesGroup:[],timeSpentOnQuiz:0,projectId:"",projectInstruction:null,customStartButton:void 0,doNotRenderChildrenSet:void 0}),useProjectInstructionContext=()=>i.useContext(v),y=null,b=i.memo(e=>{let{projectId:t,assignmentId:n,startButtonText:a,isEmbedded:b,isMobileView:w,startTasks:j,user:T,userIsCustomer:C,isEdgeCase:S,isRapidPreview:I,instructionV2Res:k,children:N,customStartButton:A,disableDiff:E,disableScrollOnMount:z,disableSidePanel:F}=e,{query:Z,pathname:D}=(0,l.useRouter)(),{id:P,componentId:R,type:B,assignmentId:L,taskId:O}=Z,[_,H]=(0,i.useState)(!1),[M,W]=(0,i.useState)(null),[G,U]=(0,i.useState)(),[Q,V]=(0,i.useState)(0),[$,q]=(0,i.useState)(!1),[X,J]=(0,i.useState)(!1),[K,Y]=(0,i.useState)(!1),[ee,et]=(0,i.useState)(0),[en,eo]=(0,i.useState)(!1),[ei,ea]=(0,i.useState)(null!=w&&w),[es,el]=(0,i.useState)(e=>{}),[er,ed]=(0,i.useState)(null),[ec,ep]=(0,i.useState)([]),[eu,em]=(0,i.useState)({isEdgeCase:S}),[eh,ex]=(0,i.useState)([B,R]),[eg,ef]=(0,i.useState)(""),[ev,ey]=(0,i.useState)(!1),[eb,ew]=(0,i.useState)(-1),[ej,eT]=(0,i.useState)(!1),[eC,eS]=(0,i.useState)(!E),eI=(0,d.ZP)("use-rapid-instruction-limits",{},!1),ek=!!((null==T?void 0:T.spoofed)||(null==T?void 0:T.email)&&(null==T?void 0:T.email.endsWith("scale.com"))),eN=!!C||(null==T?void 0:T.isCorporateUser)||(null==T?void 0:T.accountType)===m.AccountType.User,eA=null!=t?t:P;(0,i.useEffect)(()=>{void 0!==w&&ea(w)},[w]),(0,i.useEffect)(()=>{V(new Date().getTime()),eF(eC),(async()=>{let e=await (0,r.V3)({feature:"use-instruction-side-panel"}),n=D.includes("/tasks"),o=D.includes("/training");q(!!(e&&t&&(n||o))&&!F)})()},[eA,eC,k]);let eE=(0,i.useCallback)(async()=>{if(eA)try{var e;let{tme:t}=await (0,g.ZP)(null,"corp-api/remedialCourses/findTaskerMetricsEntry",{method:"POST",body:{worker:null==T?void 0:T.id,project:eA}});return null!==(e=null==t?void 0:t.specializations)&&void 0!==e?e:[]}catch(e){return[]}else try{let e=await (0,g.ZP)(null,"corp-api/remedialCourses/findTaskerSpecializations",{method:"POST",body:{worker:null==T?void 0:T.id,taskId:O}});return e}catch(e){return[]}},[eA,O,T]),ez=(0,i.useMemo)(()=>{let e=new Set;return ec.forEach(t=>{if(t.nodeType===m.InstructionComponentType.Label){var n,o,i,a;null===(o=t.content)||void 0===o||null===(n=o.nestedAttributeIds)||void 0===n||n.forEach(t=>{e.add(t)}),null===(a=t.content)||void 0===a||null===(i=a.nestedLabelIds)||void 0===i||i.forEach(t=>{e.add(t)})}}),e},[ec]);(0,i.useEffect)(()=>{!async function(){let e=await eE(),t=ec.filter(t=>{var n,o,i;return!((null!==(o=null===(n=t.content)||void 0===n?void 0:n.specializations)&&void 0!==o?o:[]).length>0)||(0,f.checkSpecializationsConfig)(e,null===(i=t.content)||void 0===i?void 0:i.specializations)});ec.length!==t.length&&ep(t)}()},[eE,ec]);let eF=(0,i.useCallback)(async e=>{H(!0);try{if(k||(k=await p.Z.selfserve.getProjectInstructionStatus(eA,I?void 0:n||L)),!k)return;if(k.ok&&k.instruction&&k.instruction.components&&k.instruction.components.length>0){W(k);let{instruction:t,diffInstructions:n,firstSeenProjectInstruction:o,hasSensitiveContent:i,param_chunks:a,title:l,quiz:r}=k;eu.hasSensitiveContent=i,eu.param_chunks=a,Y(!!r),em({...eu}),ef(l||""),r&&U(r),ey(void 0!==n);let d=!!(o&&b),c=(0,h.Ev)({components:n&&e?n.components:t.components,isOnboarding:d,isCustomer:eN});try{let e=[];for(let t of c){let n=t.content.ontologyProjectId;if(n){let{ontology:o}=await (0,g.ZP)(null,"/internal/ontology_manager/latest_ontology/".concat(n),{method:"GET"}),convertOntologyToComponents=e=>s().sortBy(e.map(e=>({nodeName:e.display,nodeId:e.value,nodeType:m.InstructionComponentType.Field,iconName:"info",iconColor:"blue",content:{_id:e.value,type:m.InstructionComponentType.Field,title:e.display,description:e.description||""},components:convertOntologyToComponents(e.subchoices||[])})),e=>e.nodeName),i=convertOntologyToComponents(o);e.push({...t,components:i})}else e.push(t)}c=e}catch(e){u.Z.warn("ProjectInstructionProvider ",e)}ep(c),eo(d)}}catch(e){u.Z.warn("ProjectInstructionProvider ",e)}H(!1)},[eA,I]),handleTimer=()=>{if(s().isEmpty(eh))return;let e=-1,t=[-1,-1],[n,o]=eh;if(ec.forEach((i,a)=>{i.nodeType===n&&i.nodeId===o?e=a:i.nodeType===m.InstructionComponentType.Group&&i.components&&i.components.forEach((e,i)=>{e.nodeType===n&&e.nodeId===o&&(t=[a,i])})}),clearInterval(y),e>=0){let t=ec[e].waitSeconds;t&&(y=setInterval(()=>{let t=[...ec];t[e].waitSeconds-=1,0===t[e].waitSeconds&&(clearInterval(y),t[e].waitSeconds=null),ep(t)},1e3))}else if(t[0]>-1&&t[1]>-1){let[e,n]=t,o=ec[e].components;if(!o)return;let i=o[n].waitSeconds;i&&(y=setInterval(()=>{let t=[...ec],o=t[e].components;o&&(o[n].waitSeconds-=1,0===o[n].waitSeconds&&(clearInterval(y),o[n].waitSeconds=null),ep(t))},1e3))}},eZ=(0,i.useMemo)(()=>{let[e,n]=eh;if(null==ec?void 0:ec.length){if(s().isEmpty(s().compact(eh)))return ei||$&&t?null:{...ec[0].content,waitSeconds:ec[0].waitSeconds};for(let t of ec){if(t.nodeType===e&&t.nodeId===n)return{...t.content,waitSeconds:t.waitSeconds};if(t.nodeType===m.InstructionComponentType.Group&&t.components){for(let o of t.components)if(o.nodeType===e&&o.nodeId===n)return{...o.content,waitSeconds:o.waitSeconds}}}}return null},[eh,ec,ei]);(0,i.useEffect)(()=>{eZ&&handleTimer()},[eZ]);let{startQuizTimer:eD,pauseQuizTimer:eP}=(0,i.useMemo)(()=>quizTimerHooks(et),[et]);(0,i.useEffect)(()=>{X?eD():eP()},[X]);let eR=[];return b||I?eN||eR.push(x.Q0):null==ec||ec.forEach(e=>{let{nodeType:t}=e;eR.includes(t)||eR.push(t)}),(0,o.jsx)(v.Provider,{value:{quiz:G,setQuiz:U,title:eg,enableQuiz:K,enableDiff:eC,extraAlerts:eu,enableSidePanel:$,projectInstruction:M,shouldUseNGI:!!(null==M?void 0:M.shouldUseNGI),hasVersionComparison:ev,handleStart:()=>{async function updateUser(){let e=s().get(M,["instruction","_id"]);if(e){let t=Math.round((new Date().getTime()-Q)/1e3);await p.Z.selfserve.setUserHasSeenInstructions({instructionObjectId:e,timeSpentSecs:t,usingInstructionRestrictions:eI});let n={isNewInstruction:!0,isOnboardingFlow:en,isDuringTasking:!1,openTabButtonClicked:!1,startTime:Q,closeTime:new Date().getTime()};await (0,c.Kz)(c.ju.InstructionRenderRecord,n)}}j&&(j(),updateUser())},projectId:eA,openQuiz:X,setOpenQuiz:J,startButtonText:a,showingInstructionsFn:es,setEnableDiff:eS,setShowingInstructionsFn:el,selectedSection:eZ,selectedPath:eh,setSelectedPath:I?e=>{let[t,n]=e;if(ec){if(s().isEmpty(e))ew(-1);else for(let e=0;e<ec.length;e++){let o=ec[e];if(o.nodeType===t&&o.nodeId===n){eT(!ej),ew(e);break}if(o.nodeType===m.InstructionComponentType.Group&&o.components)for(let i=0;i<o.components.length;i++){let a=o.components[i];if(a.nodeType===t&&a.nodeId===n){eT(!ej),ew([e,i]);break}}}}}:ex,searchResult:er,setSearchResult:ed,timeSpentOnQuiz:ee,components:ec,setComponents:ep,isMobileView:$||ei,setIsMobileView:ea,disableScrollOnMount:z,scrollIntoView:eb,scrollToggle:ej,isLoading:_,isEmbedded:b,isCorpUser:ek,isOnboarding:en,isRapidPreview:I,typesGroup:eR,customStartButton:A,doNotRenderChildrenSet:ez,disableSidePanel:F},children:N})})},23387:function(e,t,n){var o=n(824246),i=n(827378),a=n(99562),s=n(924364),l=n(51764),r=n(272308),d=n(60042),c=n.n(d),p=n(792739),u=n(367654),m=n(298784),h=n.n(m),x=n(692975),g=n(599789);let f=(0,a.ZL)(()=>({description:{padding:"0 5px 0px 5px",display:"block",overflow:"scroll","&::-webkit-scrollbar":{height:0},"& p":{margin:0},fontStyle:"italic"},taskExampleWrapper:{position:"relative",width:170,border:"1px solid red",margin:"10px 20px 10px 0",borderRadius:10,overflow:"hidden","& img":{height:150},"&:hover":{opacity:.7}},correctness:{fontSize:13,padding:5},goodExample:{border:"2px solid #4FAD75",background:"#F9FCFB"},badExample:{border:"2px solid #B71C1C",background:"#FFF4F6"},neutralExample:{border:"2px solid #E0E0E0",background:"#F9F9F9"},fullWidth:{width:"100%",padding:0},hidden:{opacity:.25},newBadge:{borderRadius:"1000px",padding:"4px 12px",position:"absolute",left:"4px",top:"4px",fontSize:"8px",background:"var(--color-RemoGreen)",userSelect:"none",cursor:"pointer"}}));t.Z=i.memo(e=>{let{sample:t,index:n,fullWidth:i}=e,a=f(),{type:d,description:m,linkedTask:v,screenshotUrl:y,staticAsset:b,isNew:w,videoUrl:j,didChange:T}=t,{isMobileView:C}=(0,u.k)(),S=d===g.InstructionExampleSampleType.Good;return(0,o.jsxs)("div",{className:c()(a.taskExampleWrapper,{[a.goodExample]:d===g.InstructionExampleSampleType.Good,[a.badExample]:d===g.InstructionExampleSampleType.Bad,[a.neutralExample]:d===g.InstructionExampleSampleType.Neutral,[a.fullWidth]:i||C,[a.hidden]:!T&&void 0!==T}),children:[b&&!h().isEmpty(b)&&(0,o.jsx)(r._,{readOnly:!0,index:n,preventOpen:!1,handleDelete:()=>{},staticAsset:b},t.title),v&&(0,o.jsx)(l.S,{taskId:v,caption:m,isGoodExample:S,readOnly:!0,index:n}),j&&(0,o.jsx)(x.Z,{controls:!0,width:"100%",url:j}),d&&[g.InstructionExampleSampleType.Good,g.InstructionExampleSampleType.Bad].includes(d)&&(0,o.jsxs)("div",{className:a.correctness,children:[(0,o.jsx)(p.FontAwesomeIcon,{icon:S?"check-circle":"minus-circle",color:S?"#4FAD75":"#B71C1C"}),S?" Correct":" Incorrect"]}),(w||T)&&(0,o.jsx)("strong",{className:a.newBadge,children:"New!"}),y&&(0,o.jsx)("img",{src:y}),(0,o.jsx)("div",{children:(0,o.jsx)("p",{className:a.description,dangerouslySetInnerHTML:{__html:s.ZP.render(m||"")}})})]})})},470449:function(e,t,n){n.d(t,{Ev:function(){return dataNormalizer},OY:function(){return flattenWithPath},kN:function(){return getEachSubComponentDataFromId}});var o=n(599789),i=n(298784),a=n.n(i),s=n(982489);let flattenWithPath=(e,t,n)=>{let i=[];return e.forEach((e,a)=>{let{nodeType:l,nodeName:r,nodeId:d,content:c,samples:p,description:u,title:m,components:h}=e,x=null!=n?n:d;if(l===o.InstructionComponentType.Group){let n=[...t,a],o={title:m,nodeId:x,path:[...t,a]};i.push(o),i.push(...flattenWithPath(e.components,[...n,"groups"],x))}else if(Object.values(o.InstructionComponentType).includes(l)||l===s.Q0){let e=[...t,l,r],{description:n,title:o,examples:a}=c;i.push({description:n,title:o,nodeId:x,path:e}),a&&i.push(...flattenWithPath(a,[...e,"examples"],x)),h&&i.push(...flattenWithPath(h,t,x))}else if(p){let e=[...t,a],n={description:u,title:m,nodeId:x,path:[...t,a]};i.push(n),i.push(...flattenWithPath(p,[...e,"samples"],x))}else{let n={description:u,title:m,nodeId:x,path:[...t,a],linkedTask:e.linkedTask,staticAsset:e.staticAsset,screenshotUrl:e.screenshotUrl,type:e.type};i.push(n)}}),i},isComponentEmpty=e=>{if(!e||a().isEmpty(e))return!0;if(e.type===o.InstructionComponentType.Group)return a().isEmpty(e.components);let{description:t,labels:n,attributes:i,examples:s}=e;return!t&&a().isEmpty(n)&&a().isEmpty(i)&&a().isEmpty(s)},getTitleToId=e=>{let t={};return e.forEach(e=>{let{_id:n,title:o}=e;t[o]=n}),t},dataNormalizer=e=>{let{components:t,isOnboarding:n,isCustomer:i}=e,l=[],r=getTitleToId(t);return t.forEach(e=>{var t,d,c;if(isComponentEmpty(e))return;let p={},{_id:u,type:m,title:h,isNew:x,diffStatus:g}=e,f=x||n||g===o.InstructionDiffStatus.Addition||g===o.InstructionDiffStatus.Update?s._O:null;if(m===o.InstructionComponentType.RichText){let i=null==h?void 0:null===(t=h.toLowerCase())||void 0===t?void 0:t.includes("workflow");p.nodeName=h,p.nodeType=m,p.nodeId=u,p.iconName=i?s.mz.workflow.iconName:s.mz[o.InstructionComponentType.RichText].iconName,p.iconColor=i?s.mz.workflow.iconColor:s.mz[o.InstructionComponentType.RichText].iconColor,p.waitSeconds=f,p.content={...e,diffStatus:n?o.InstructionDiffStatus.Addition:g,title:a().startCase(h)}}m===o.InstructionComponentType.Label&&(p.nodeName=e.label||h,p.nodeType=m,p.nodeId=u,p.iconName=s.mz[o.InstructionComponentType.Label].iconName,p.iconColor=s.mz[o.InstructionComponentType.Label].iconColor,p.waitSeconds=f,p.content={...e,diffStatus:n?o.InstructionDiffStatus.Addition:g,title:a().startCase(e.label||h)}),m===o.InstructionComponentType.Attribute&&(p.nodeName=e.attribute||e.title,p.nodeType=m,p.nodeId=u,p.iconName=s.mz[o.InstructionComponentType.Attribute].iconName,p.iconColor=s.mz[o.InstructionComponentType.Attribute].iconColor,p.waitSeconds=f,p.content={...e,diffStatus:n?o.InstructionDiffStatus.Addition:g,title:a().startCase(e.attribute||h)}),m===o.InstructionComponentType.Field&&(p.nodeName=h,p.nodeType=m,p.nodeId=u,p.iconName=s.mz[o.InstructionComponentType.Field].iconName,p.iconColor=s.mz[o.InstructionComponentType.Field].iconColor,p.waitSeconds=f,p.content={...e,diffStatus:n?o.InstructionDiffStatus.Addition:g,title:a().startCase(h)}),m===o.InstructionComponentType.Group&&(p.nodeName=h,p.nodeType=m,p.nodeId=null!=u?u:h,p.iconName=s.mz[o.InstructionComponentType.Group].iconName,p.iconColor=s.mz[o.InstructionComponentType.Group].iconColor,p.waitSeconds=null,p.components=dataNormalizer({components:e.components,isOnboarding:n,isCustomer:i}),p.content={...e,diffStatus:n?o.InstructionDiffStatus.Addition:g,components:p.components,title:a().startCase(h)}),m===o.InstructionComponentType.Rule&&(p.nodeName=h,p.nodeId=u,p.nodeType=m,p.iconName=s.mz[o.InstructionComponentType.Rule].iconName,p.iconColor=s.mz[o.InstructionComponentType.Rule].iconColor,p.waitSeconds=f,p.content={...e,diffStatus:n?o.InstructionDiffStatus.Addition:g,title:a().startCase(h),labels:null==e?void 0:null===(d=e.labels)||void 0===d?void 0:d.map(e=>({title:e,id:r[e]})),attributes:null==e?void 0:null===(c=e.attributes)||void 0===c?void 0:c.map(e=>({title:e,id:r[e]}))}),m===o.InstructionComponentType.Attachment&&(p.nodeName=h,p.nodeId=u,p.nodeType=m,e.attachmentType===o.AttachmentInstructionType.Iframe&&(p.iconName=s.mz[o.AttachmentInstructionType.Iframe].iconName,p.iconColor=s.mz[o.AttachmentInstructionType.Iframe].iconColor),e.attachmentType===o.AttachmentInstructionType.Image&&(p.iconName=s.mz[o.AttachmentInstructionType.Image].iconName,p.iconColor=s.mz[o.AttachmentInstructionType.Image].iconColor),e.attachmentType===o.AttachmentInstructionType.Pdf&&(p.iconName=s.mz[o.AttachmentInstructionType.Pdf].iconName,p.iconColor=s.mz[o.AttachmentInstructionType.Pdf].iconColor),p.waitSeconds=f,p.content={...e,diffStatus:n?o.InstructionDiffStatus.Addition:g,title:a().startCase(h)}),l.push(p)}),l},getEachSubComponentDataFromId=(e,t)=>{let n=[];return e.map(e=>{var o,i;(null===(o=e.content)||void 0===o?void 0:o._id)&&t.includes(null===(i=e.content)||void 0===i?void 0:i._id)&&n.push(e.content)}),n}},771046:function(e,t,n){n.d(t,{Q:function(){return T}});var o=n(824246),i=n(674721),a=n.n(i),s=n(827378),l=n(293030),r=n(320280),d=n(433536),c=n(384077),p=n(513735),u=n(718755),m=n(789018),h=n(629554),x=n(167469),g=n(891298),f=n(657127),v=n(460754),y=n(298784),b=n.n(y),w=n(792739),j=n(235900);let T="What does this example illustrate? Click here to add a description.",C=(0,d.ZL)({container:{display:"flex",flexDirection:"column",justifyContent:"center",flexFlow:"column nowrap",flexWrap:"nowrap"},dialog:{width:"100%",overflow:"hidden",margin:"2% auto 20px"},dialogRoot:{zIndex:"110 !important"},exampleTypeSelector:{display:"flex",justifyContent:"center",marginBottom:"12px"},exampleType:{margin:"8px",padding:"2px 8px 2px 8px",border:"1px solid #E6E6E6",borderRadius:"8px",cursor:"pointer"},selectorControls:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"24px"},createButton:{display:"flex",width:"100%",alignItems:"center",justifyContent:"flex-end"},editableCaption:{opacity:.9,marginTop:"0px",textAlign:"center",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px",width:"100%"},captionContainer:{display:"flex",flexDirection:"column",width:"100%"},captionHeader:{width:"100%",lineHeight:1,color:"darkslategray",marginBottom:"8px"}});t.Z=e=>{let{modalOpen:t,project:n,uploadedAssets:i,taxonomy:d,setModalOpen:y,setTaskId:S,onBackToAssetSelection:I,setTasksWithProcessingAnnotationsResponses:k,initialCaption:N,resetNormalAssetCaption:A}=e,E=C(),[z,F]=(0,s.useState)(0),[Z]=(0,s.useState)({}),[D]=(0,s.useState)({}),[P,R]=(0,s.useState)(!1),[B,L]=(0,s.useState)(!1),[O,_]=(0,s.useState)(null!=N?N:""),[H,M]=(0,s.useState)(void 0),[W,G]=(0,s.useState)(""),[U,Q]=(0,s.useState)(!1),[V,$]=(0,s.useState)(-1),[q,X]=(0,s.useState)(!1),{fetchUnprocessedAttachments:J}=(0,v.Z)(),{taskType:K}=(0,g.kc)(),fetchAsset=async e=>(Z[e]||(Z[e]=(await m.Z.selfserve.fetchAssetS3URL({assetId:e})).signedURL),Z[e]),fetchAssetPages=async e=>(D[e]||(D[e]=(await m.Z.selfserve.fetchAssetPages({assetId:e})).pageURLs),D[e]),fetchAssetToTemplateAttachment=async(e,t)=>{let{attachment:n}=await m.Z.selfserve.fetchAssetToTemplateAttachment({assetId:e,project:t.id});return n};(0,s.useEffect)(()=>{t&&F(0)},[t]),(0,s.useEffect)(()=>{N&&_(N)},[N]),(0,s.useEffect)(()=>{let e=!1;return async function(){if(i&&i.length>0){M(void 0);let o=await (0,h.kh)(null!=K?K:n.type,i[z],d,!0,fetchAsset,fetchAssetPages,n.useTextCollectionTemplate?fetchAssetToTemplateAttachment:void 0,n);if(o.attachments&&b().every(o.attachments,e=>"unprocessed"===e.type)){var t;o.attachments=await J(null!==(t=o.attachments)&&void 0!==t?t:[])}e||M({...u.sampleTask,type:null!=K?K:n.type,params:o,assignment:{projectId:n.id,params:o,type:null!=K?K:n.type,featureFlags:{canLeaveInlineComments:!0,canSeeInlineComments:!0,showSidebar:(null!=K?K:n.type)===x.TaskType.NamedEntityRecognition||void 0}},timerDisabled:!0,shouldWarnOnExit:!1,readOnly:!1,editable:!0,canEdit:!0,isCustomer:!0,showHeader:!1,isTaxonomyDisplay:!0,showFooter:!1})}i&&i[z+1]&&(null!=K?K:n.type)===x.TaskType.DocumentTranscription&&m.Z.selfserve.fetchAssetPages({assetId:i[z+1]._id})}(),function(){e=!0}},[n,i,d,z]);let Y=(0,s.useRef)(),onContinue=async()=>{if(R(!0),Y.current&&n){let e=await Y.current.getReviewChanges(),t=i[z]._id,o={project:n.id,type:null!=K?K:n.type,uploadedAsset:t,taxonomy:d,response:e};try{let{taskId:t,msg:n}=await m.Z.selfserve.setInstructionsExample(o);n||(S(t,void 0,O),k&&k(n=>({...n,[t]:e})),handleCreated()),G("")}catch(e){G("Error creating example: Verify that the response is valid")}R(!1)}},hasAnnotations=async()=>{if(!Y.current)return!1;{let e=await Y.current.getReviewChanges();return K===x.TaskType.Categorization?e.taxonomies&&e.taxonomies.length>0:e.annotations&&e.annotations.length>0}},handleCreated=()=>{Q(!0),L(!0),setTimeout(()=>{Q(!1),close()},1e3)},handleMove=e=>{$(e),X(!0)},close=e=>{((null==e?void 0:e.type)!=="keydown"||(null==e?void 0:e.keyCode)!==27)&&(y(!1),A&&A())};return(0,o.jsxs)(o.Fragment,{children:[q&&(0,o.jsx)(j.Z,{isOpen:q,message:"Do you want to change assets without saving the example?",onSubmit:()=>{F(V),$(-1),L(!1),X(!1)},onRequestClose:()=>X(!1)}),(0,o.jsxs)(r.Vq,{classes:{root:E.dialogRoot,paper:E.dialog},maxWidth:"lg",open:t,onClose:close,children:[(0,o.jsx)(r.$N,{children:(0,o.jsx)("div",{style:{textAlign:"center",fontWeight:500,fontSize:"16px",lineHeight:"20px"},children:"Create an example task"})}),(0,o.jsxs)(r.cZ,{children:[(!i||0===i.length)&&(0,o.jsx)("h6",{className:"jsx-8b0aa6d31560dfb1",children:"No assets to display..."}),i&&i.length>0&&(0,o.jsxs)(o.Fragment,{children:[W.length>0&&(0,o.jsx)(r.bZ,{severity:"error",style:{marginTop:"2px",marginBottom:"12px"},children:W}),U&&(0,o.jsx)(r.bZ,{severity:"success",style:{marginTop:"2px",marginBottom:"12px"},children:"Example created!"}),H?(0,o.jsx)(f.Z,{children:(0,o.jsx)(s.Suspense,{fallback:(0,o.jsx)(l.Z,{style:{paddingBottom:"16px"}}),children:(0,o.jsx)("div",{className:"jsx-8b0aa6d31560dfb1 component",children:(0,o.jsx)(p.M5,{children:(0,o.jsx)(c.Z,{taskType:H.type,taskProps:H,taskRef:Y,isTaxonomyDisplay:(null!=K?K:n.type)!=="categorization"})})})})}):(0,o.jsx)(l.Z,{style:{paddingBottom:"16px"}}),(0,o.jsxs)("div",{className:"jsx-8b0aa6d31560dfb1 "+(E.captionContainer||""),children:[(0,o.jsx)("p",{className:"jsx-8b0aa6d31560dfb1 "+(E.captionHeader||""),children:"Caption"}),(0,o.jsx)("input",{value:O,placeholder:T,onFocus:e=>e.target.placeholder="",onBlur:e=>e.target.placeholder=T,onChange:e=>{e.preventDefault(),_(e.target.value)},className:"jsx-8b0aa6d31560dfb1 "+(E.editableCaption||"")})]}),(0,o.jsxs)("div",{className:"jsx-8b0aa6d31560dfb1 "+(E.selectorControls||""),children:[(0,o.jsx)(r.u,{arrow:!0,placement:"top",title:"jump to first asset",children:(0,o.jsx)("div",{className:"jsx-8b0aa6d31560dfb1",children:(0,o.jsx)("a",{onClick:async()=>{P||(!B&&await hasAnnotations()?handleMove(0):(F(0),L(!1)))},className:"jsx-8b0aa6d31560dfb1",children:(0,o.jsx)(w.FontAwesomeIcon,{icon:"angle-double-left",color:"black",style:{width:16,height:16,marginLeft:8,marginTop:4}})})})}),(0,o.jsx)(r.u,{arrow:!0,placement:"top",title:"view previous asset",children:(0,o.jsx)("div",{className:"jsx-8b0aa6d31560dfb1",children:(0,o.jsx)("a",{style:{marginLeft:"8px",marginRight:"8px"},onClick:async()=>{let e=(z-1+i.length)%i.length;P||(!B&&await hasAnnotations()?handleMove(e):(F(e),L(!1)))},className:"jsx-8b0aa6d31560dfb1",children:(0,o.jsx)(w.FontAwesomeIcon,{icon:"angle-left",color:"black",style:{width:16,height:16,marginLeft:8,marginTop:4}})})})}),(0,o.jsxs)("p",{style:{margin:"0px 10px 0px 10px"},className:"jsx-8b0aa6d31560dfb1",children:[z+1," of ",i.length]}),(0,o.jsx)(r.u,{arrow:!0,placement:"top",title:"view next asset",children:(0,o.jsx)("div",{className:"jsx-8b0aa6d31560dfb1",children:(0,o.jsx)("a",{style:{marginRight:"8px"},onClick:async()=>{let e=(z+1)%i.length;P||(!B&&await hasAnnotations()?handleMove(e):(F(e),L(!1)))},className:"jsx-8b0aa6d31560dfb1",children:(0,o.jsx)(w.FontAwesomeIcon,{icon:"angle-right",color:"black",style:{width:16,height:16,marginLeft:8,marginTop:4}})})})}),(0,o.jsx)(r.u,{arrow:!0,placement:"top",title:"jump to last asset",children:(0,o.jsx)("div",{className:"jsx-8b0aa6d31560dfb1",children:(0,o.jsx)("a",{onClick:async()=>{let e=i.length-1;P||(!B&&await hasAnnotations()?handleMove(e):(F(e),L(!1)))},className:"jsx-8b0aa6d31560dfb1",children:(0,o.jsx)(w.FontAwesomeIcon,{icon:"angle-double-right",color:"black",style:{width:16,height:16,marginLeft:8,marginTop:4}})})})})]})]}),(0,o.jsx)(a(),{id:"8b0aa6d31560dfb1",children:".component{height:540px}.component,.component .task{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;min-height:0;min-width:0;width:100%;overflow:auto}.task__splitpane{position:relative;overflow:auto}"})]}),(0,o.jsxs)(r.kX,{children:[(0,o.jsx)(r.zx,{type:"tertiary",onClick:I,disabled:P,children:"Back to Asset Selection"}),(0,o.jsx)(r.zx,{type:"primary",onClick:onContinue,disabled:P,children:P?"Saving":"Save example"})]})]})]})}},51764:function(e,t,n){n.d(t,{S:function(){return ExampleLabelPreview}});var o=n(824246),i=n(827378),a=n(99562),s=n(167469),l=n(674721),r=n.n(l),d=n(293030),c=n(320280),p=n(384077),u=n(513735),m=n(599789),h=n(891941),x=n(107873),g=n(718755),f=n(789018),v=n(456552),y=n(298784),b=n.n(y),w=n(246127),j=n(657127),T=n(460754),C=n(771046),S=n(367654);let I=(0,a.ZL)({dialog:{width:"100%",overflow:"hidden",margin:"3% auto 20px"},zIndexHigh:{zIndex:"2000 !important"},zIndexLow:{zIndex:"110 !important"},title:{textAlign:"center"},closeButton:{position:"absolute",right:20,top:15,"&:hover":{cursor:"pointer"}},editableCaption:{opacity:.9,marginTop:"0px",textAlign:"center",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px",width:"100%"},captionContainer:{display:"flex",flexDirection:"column",width:"100%"},captionHeader:{width:"100%",lineHeight:1,color:"darkslategray",marginBottom:"8px"}});var components_ExampleViewer=e=>{let{modalOpen:t,taskInfo:n,taskId:a,readOnly:s,setModalOpen:l,hasOpenedExample:y,projectTemplateId:k,updateCaption:N,tasksWithProcessingAnnotationsResponses:A}=e,E=I(),[z,F]=(0,i.useState)(!1),Z=(0,i.useRef)(),[D,P]=(0,i.useState)(""),[R,B]=(0,i.useState)(""),[L,O]=(0,i.useState)(void 0),{data:_}=(0,w.Z)(a,s,k,!0),{isMobileView:H,enableSidePanel:M}=(0,S.k)(),{goodExample:W,caption:G}=n,[U,Q]=(0,i.useState)(G),{params:V,response:$,type:q,projectId:X,status:J}=_,K=(0,v.useQueryClient)(),{fetchUnprocessedAttachments:Y}=(0,T.Z)(),ee=H&&!M,et=!s&&L&&J===m.TaskStatus.Completed;(0,i.useEffect)(()=>{let e=!1;return async function(){if(!z&&V&&q&&X){if(O(void 0),V&&V.attachments&&V.attachments.length>0&&b().every(V.attachments,e=>"unprocessed"===e.type)){var t;V.attachments=await Y(null!==(t=V.attachments)&&void 0!==t?t:[])}e||(y&&y(a,W),O({...g.sampleTask,assignment:{params:V,projectId:X,type:q,featureFlags:{canLeaveInlineComments:!s,canSeeInlineComments:!0},initialInlineComments:null==$?void 0:$.inlineComments},type:q,params:V,fixResponse:$||(null==A?void 0:A[a]),timerDisabled:!0,shouldWarnOnExit:!1,readOnly:!et,editable:et,isCustomer:!0,showHeader:!1,isTaxonomyDisplay:!0,showFooter:!1}))}}(),function(){e=!0}},[n]);let handleSuccess=()=>{B("Task updated"),setTimeout(()=>B(""),2e3)},handleError=()=>{P("Task update failed"),setTimeout(()=>P(""),2e3)},onUpdate=async()=>{if(B(""),P(""),F(!0),Z.current)try{let e=await Z.current.getReviewChanges(),t=await f.Z.selfserve.updateInstructionsExample({task:a,response:e});K.invalidateQueries(["use-instruction-task-data",a]),t.success?(N&&N(U),O({...L,fixResponse:e}),handleSuccess()):handleError()}catch(e){handleError()}F(!1)},close=e=>{((null==e?void 0:e.type)!=="keydown"||(null==e?void 0:e.keyCode)!==27)&&l(!1)};return(0,o.jsxs)(c.Vq,{classes:{root:s?E.zIndexHigh:E.zIndexLow,paper:E.dialog},maxWidth:"lg",open:t,onClose:close,children:[(0,o.jsx)(c.$N,{children:(0,o.jsxs)("div",{className:E.title,children:["Example"," ",(0,o.jsx)("span",{className:E.closeButton,onClick:close,children:"✕"})]})}),(0,o.jsxs)(c.cZ,{children:[ee&&(0,o.jsx)("div",{className:"jsx-78deb52573c15da2",children:"example doesn't support for small screen, please view examples on desktop"}),!L&&(0,o.jsx)("h6",{className:"jsx-78deb52573c15da2",children:"No Images to display..."}),L&&J!==m.TaskStatus.Completed&&(0,o.jsx)(h.Z,{severity:"info",style:{marginTop:"16px",marginBottom:"6px"},children:"Annotations are still being processed"}),D.length>0&&(0,o.jsx)(h.Z,{severity:"error",style:{marginTop:"2px",marginBottom:"12px"},children:D}),R.length>0&&(0,o.jsx)(h.Z,{severity:"success",style:{marginTop:"2px",marginBottom:"12px"},children:R}),!ee&&L&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(j.Z,{children:(0,o.jsx)(i.Suspense,{fallback:(0,o.jsx)(d.Z,{style:{paddingBottom:"16px"}}),children:(0,o.jsx)("div",{className:"jsx-78deb52573c15da2 component",children:(0,o.jsx)(u.M5,{children:(0,o.jsx)(p.Z,{taskType:L.type,taskProps:L,taskRef:Z,isTaxonomyDisplay:!0})})})})})}),(0,o.jsx)(r(),{id:"78deb52573c15da2",children:".component{height:540px}.component,.component .task{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;min-height:0;min-width:0;width:100%;overflow:auto}.task__splitpane{position:relative;overflow:auto}"}),!s&&(0,o.jsxs)("div",{className:"jsx-78deb52573c15da2 "+(E.captionContainer||""),children:[(0,o.jsx)("p",{className:"jsx-78deb52573c15da2 "+(E.captionHeader||""),children:"Caption"}),(0,o.jsx)("input",{value:U,placeholder:C.Q,onFocus:e=>e.target.placeholder="",onBlur:e=>e.target.placeholder=C.Q,onChange:e=>{e.preventDefault(),Q(e.target.value)},className:"jsx-78deb52573c15da2 "+(E.editableCaption||"")})]}),G&&s&&(0,o.jsx)("div",{style:{marginTop:12,textAlign:"center",background:"white",border:0,fontSize:"16px",width:"100%"},className:"jsx-78deb52573c15da2",children:G})]}),et?(0,o.jsx)(c.kX,{children:(0,o.jsx)(x.zx,{onClick:()=>onUpdate(),disabled:z||!et,type:"primary",children:"Update"})}):(0,o.jsx)(o.Fragment,{})]})},k=n(792739),N=n(390547);let getAttachmentInfo=e=>{let t,n;if(!e)return{attachmentType:null,attachment:null};let o=e.type;return o===s.TaskType.TextCollection?(t=e.params.attachments[0].type,n=e.params.attachments[0].content):o===s.TaskType.NamedEntityRecognition?(t="text",n=e.params.text):o===s.TaskType.DocumentTranscription?(t="image",n=e.params.attachments[0]):(t=e.params.attachment_type,n=e.params.attachment),{attachmentType:t,attachment:n}},ExampleLabelPreview=e=>{var t,n;let{taskId:a,isGoodExample:s,caption:l,readOnly:r,hasOpenedExample:d,projectTemplateId:p,preventOpen:u,handleDelete:m,updateCaption:h,dragHandleProps:x,tasksWithProcessingAnnotationsResponses:g}=e,f=A(),[v,y]=(0,i.useState)(!1),{isLoading:b,data:j}=(0,w.Z)(a,r,p,!0),T=(0,i.useCallback)(e=>{e.stopPropagation(),m&&m()},[m]);if(b)return(0,o.jsx)("div",{className:f.loading,children:(0,o.jsx)(c.D8,{})});let{attachmentType:C,attachment:S}=getAttachmentInfo(j);return(0,o.jsxs)("div",{className:f.label,children:[v&&(0,o.jsx)(components_ExampleViewer,{modalOpen:v,setModalOpen:e=>y(e),taskId:a,taskInfo:{...j,goodExample:s,caption:l},readOnly:r,hasOpenedExample:d,projectTemplateId:p,updateCaption:h,tasksWithProcessingAnnotationsResponses:g}),(0,o.jsxs)("div",{onClick:async e=>{e.preventDefault(),u||y(!0)},style:{cursor:u?"default":"pointer",width:"100%",height:"100%"},children:[(0,o.jsx)("div",{className:f.preview,children:(t=S,n=C,t&&n?"image"===n||"unprocessed"===n?(0,o.jsx)("img",{className:f.img,src:t,crossOrigin:"anonymous"}):"text"===n?(0,o.jsx)("div",{className:f.text,children:t}):"pdf"===n?(0,o.jsx)("object",{className:f.pdf,data:t}):"audio"===n||"transcription_audio"===n?(0,o.jsx)("audio",{className:f.audio,src:t,controls:!0}):"website"===n?(0,o.jsx)("div",{className:f.website,children:t}):"video"===n?(0,o.jsx)("video",{className:f.video,src:t}):null:(0,o.jsx)("div",{className:f.text,children:"Error loading example."}))}),(0,o.jsx)("div",{className:f.overlay}),!r&&(0,o.jsx)("div",{className:f.checkbox,onClick:T,children:(0,o.jsx)(N.Z,{size:"small",children:(0,o.jsx)(k.FontAwesomeIcon,{icon:"trash",color:"white"})})}),!!x&&!r&&(0,o.jsx)("div",{className:f.dragIcon,...x,children:(0,o.jsx)(N.Z,{size:"small",children:(0,o.jsx)(k.FontAwesomeIcon,{icon:"grip-vertical",color:"white"})})})]})]})},A=(0,a.ZL)(e=>{var t,n,o,i;return{overlay:{background:"rgba(0, 0, 0, 0.25)",position:"absolute",...null===(t=e.alignment)||void 0===t?void 0:t.inset,opacity:0,pointerEvents:"none",transition:"opacity ".concat(null===(n=e.duration)||void 0===n?void 0:n.short,"ms ease-out"),zIndex:1},checkbox:{position:"absolute",top:e.spacing(1.5),left:e.spacing(4.5),opacity:0,transform:"translate3d(0, ".concat(null==e?void 0:e.spacing(-.5),"px, 0)"),pointerEvents:"none",transition:"all ".concat(null===(o=e.duration)||void 0===o?void 0:o.short,"ms ease-out"),zIndex:2},dragIcon:{position:"absolute",top:e.spacing(1.5),left:e.spacing(1.5),opacity:0,transform:"translate3d(0, ".concat(null==e?void 0:e.spacing(-.5),"px, 0)"),pointerEvents:"none",transition:"all ".concat(null===(i=e.duration)||void 0===i?void 0:i.short,"ms ease-out"),zIndex:2},checkboxRoot:{padding:0,"@global svg":{height:28,width:28}},label:{"&:hover $button":{opacity:1},position:"relative",height:"100%",width:"100%","&:hover $checkbox":{opacity:1,transform:"translate3d(0, 0, 0)",pointerEvents:"all"},"&:hover $dragIcon":{opacity:1,transform:"translate3d(0, 0, 0)",pointerEvents:"all"},"&:hover $overlay":{opacity:1}},button:{opacity:"0",top:"-6px",right:"-6px",position:"absolute",zIndex:1,color:"gray"},preview:{width:"100%",height:"100%",overflow:"hidden"},img:{objectFit:"cover",width:"100%",height:"100%"},pdf:{width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none"},audio:{width:"100%",height:"100%",background:"#dddddd"},video:{width:"100%",height:"100%",background:"#dddddd",padding:"2px",boxSizing:"border-box"},website:{background:"#dddddd",fontSize:"10px",overflow:"hidden",width:"100%",height:"100%",boxSizing:"border-box",padding:"4px"},text:{background:"#dddddd",fontSize:"10px",overflow:"hidden",width:"100%",height:"100%",boxSizing:"border-box",padding:"4px",maxHeight:"120px"},loading:{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center"}}})},272308:function(e,t,n){n.d(t,{_:function(){return StaticAssetPreview}});var o=n(824246),i=n(789018),a=n(827378),s=n(99562),l=n(599789),r=n(320280),d=n(284614),c=n(298784),p=n.n(c);let u=(0,s.ZL)({component:{height:"540px"},dialog:{width:"100%",overflow:"hidden",margin:"3% auto 20px"},zIndexHigh:{zIndex:"2000 !important"},zIndexLow:{zIndex:"110 !important"},title:{textAlign:"center"},closeButton:{position:"absolute",right:20,top:15,"&:hover":{cursor:"pointer"}},img:{objectFit:"contain",width:"100%",height:"100%"},pdf:{width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none"},audio:{width:"100%",height:"100%",background:"#dddddd"},video:{width:"100%",height:"100%",background:"#dddddd",padding:"2px",boxSizing:"border-box"},website:{background:"#dddddd",fontSize:"10px",overflow:"hidden",width:"100%",height:"100%",boxSizing:"border-box",padding:"4px"},text:{background:"#dddddd",fontSize:"10px",overflow:"hidden",width:"100%",height:"100%",boxSizing:"border-box",padding:"4px"},caption:{opacity:.9,marginTop:12,textAlign:"center",border:0,fontSize:"16px",width:"100%"},editableCaption:{border:"1px solid #ddd",borderRadius:"4px",marginTop:"0px"},captionContainer:{display:"flex",flexDirection:"column",width:"100%"},captionHeader:{width:"100%",lineHeight:1,color:"darkslategray",marginBottom:"8px"}});var components_StaticAssetViewerModal=e=>{var t,n;let{modalOpen:i,setModalOpen:s,staticAssetAttachment:l,staticAssetAttachmentType:c,initialCaption:m,submitCaption:h}=e,x=u(),close=e=>{((null==e?void 0:e.type)!=="keydown"||(null==e?void 0:e.keyCode)!==27)&&(s(!1),!p().isNil(g)&&h&&h(g))},[g,f]=(0,a.useState)(m);return(0,o.jsxs)(r.Vq,{classes:{root:x.zIndexLow,paper:x.dialog},maxWidth:"lg",open:i,onClose:close,children:[(0,o.jsx)(r.$N,{children:(0,o.jsxs)("div",{className:x.title,children:["Example"," ",(0,o.jsx)("span",{className:x.closeButton,onClick:close,children:"✕"})]})}),(0,o.jsx)(r.cZ,{children:(0,o.jsx)("div",{className:x.component,children:(t=l,n=c,t&&n?"image"===n||"unprocessed"===n?(0,o.jsx)("img",{className:x.img,src:t,crossOrigin:"anonymous"}):"text"===n?(0,o.jsx)("div",{className:x.text,children:t}):"pdf"===n?(0,o.jsx)("object",{className:x.pdf,data:t}):"audio"===n||"transcription_audio"===n?(0,o.jsx)("audio",{className:x.audio,src:t,controls:!0}):"website"===n?(0,o.jsx)("div",{className:x.website,children:t}):"video"===n?(0,o.jsx)("video",{className:x.video,src:t}):null:(0,o.jsx)("div",{className:x.text,children:"Error loading example."}))})}),(0,o.jsx)(r.kX,{children:h?(0,o.jsxs)("div",{className:x.captionContainer,children:[(0,o.jsx)("p",{className:x.captionHeader,children:"Caption"}),(0,o.jsx)("input",{value:g,placeholder:d.Q,className:"".concat(x.caption," ").concat(x.editableCaption),onFocus:e=>e.target.placeholder="",onBlur:e=>e.target.placeholder=d.Q,onChange:e=>{e.preventDefault(),f(e.target.value)}})]}):(0,o.jsx)("div",{className:x.caption,children:g})})]})},m=n(792739),h=n(400070),x=n(390547),g=n(44579);let getAssetType=e=>{if(!(null==e?void 0:e.mimeType))return"null";if(e.mimeType.match("image/*"))return l.SelfServeSupportedAttachmentTypes.Image;if(e.mimeType.match("audio/*"))return l.SelfServeSupportedAttachmentTypes.Audio;if(e.mimeType.match("video/*"))return l.SelfServeSupportedAttachmentTypes.Video;if(e.mimeType.match("text/*")&&void 0===e.text)return l.SelfServeSupportedAttachmentTypes.DownloadableText;if("text/json"===e.mimeType)return l.SelfServeSupportedAttachmentTypes.Json;if(e.mimeType.match("text/*"))return l.SelfServeSupportedAttachmentTypes.Text;if("application/pdf"===e.mimeType)return l.SelfServeSupportedAttachmentTypes.Pdf;else if("unprocessed"===e.mimeType)return"unprocessed";else return},getAsset=async e=>{if(!e)return;let t=getAssetType(e);return("text"===t||t===l.SelfServeSupportedAttachmentTypes.Json)&&e.text?e.text:(await i.Z.selfserve.fetchAssetS3URL({...e,assetId:e._id})).signedURL},StaticAssetPreview=e=>{var t,n;let{readOnly:i,preventOpen:s,handleDelete:l,staticAsset:d,dragHandleProps:c,initialCaption:p,submitCaption:u}=e,v=f(),[y,b]=(0,a.useState)(!1),[w,j]=(0,a.useState)(void 0),[T,C]=(0,a.useState)(void 0),[S,I]=(0,a.useState)(!0);(0,g.Z)(()=>{getAsset(d).then(e=>{j(e),C(getAssetType(d)),I(!1)}).catch(()=>{I(!1)})});let k=(0,a.useCallback)(e=>{e.stopPropagation(),l&&l()},[l]);return S?(0,o.jsx)("div",{className:v.loading,children:(0,o.jsx)(r.D8,{})}):(0,o.jsxs)("div",{className:v.label,children:[y&&(0,o.jsx)(components_StaticAssetViewerModal,{modalOpen:y,setModalOpen:e=>b(e),staticAssetAttachment:w,staticAssetAttachmentType:T,initialCaption:p,submitCaption:u}),(0,o.jsxs)("div",{onClick:async e=>{e.preventDefault(),s||b(!0)},style:{cursor:s?"default":"pointer",width:"100%",height:"100%"},children:[(0,o.jsx)("div",{className:v.preview,children:(t=w,n=T,t&&n?"image"===n||"unprocessed"===n?(0,o.jsx)("img",{className:v.img,src:t,crossOrigin:"anonymous"}):"text"===n?(0,o.jsx)("div",{className:v.text,children:t}):"pdf"===n?(0,o.jsx)("object",{className:v.pdf,data:t}):"audio"===n||"transcription_audio"===n?(0,o.jsx)("audio",{className:v.audio,src:t,controls:!0}):"website"===n?(0,o.jsx)("div",{className:v.website,children:t}):"video"===n?(0,o.jsx)("video",{className:v.video,src:t}):null:(0,o.jsx)("div",{className:v.text,children:"Error loading example."}))}),!!(null==p?void 0:p.length)&&(0,o.jsx)("div",{className:v.caption,children:p}),(0,o.jsx)("div",{className:v.overlay}),!i&&(0,o.jsx)("div",{className:v.checkbox,onClick:k,children:(0,o.jsx)(h.ZP,{title:"Delete example asset",children:(0,o.jsx)(x.Z,{size:"small",children:(0,o.jsx)(m.FontAwesomeIcon,{icon:"trash",color:"white"})})})}),!!c&&!i&&(0,o.jsx)("div",{className:v.dragIcon,...c,children:(0,o.jsx)(h.ZP,{title:"Drag to reorder asset",children:(0,o.jsx)(x.Z,{size:"small",children:(0,o.jsx)(m.FontAwesomeIcon,{icon:"grip-vertical",color:"white"})})})})]})]})},f=(0,s.ZL)(e=>{var t,n,o,i;return{overlay:{background:"rgba(0, 0, 0, 0.25)",position:"absolute",...null===(t=e.alignment)||void 0===t?void 0:t.inset,opacity:0,pointerEvents:"none",transition:"opacity ".concat(null===(n=e.duration)||void 0===n?void 0:n.short,"ms ease-out"),zIndex:1},caption:{position:"absolute",bottom:0,color:"black",fontSize:14,background:"rgba(255, 255, 255, 0.75)",padding:"0.25rem",maxWidth:"100%",maxHeight:32,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},checkbox:{position:"absolute",top:e.spacing(1.5),left:e.spacing(4.5),opacity:0,transform:"translate3d(0, ".concat(null==e?void 0:e.spacing(-.5),"px, 0)"),pointerEvents:"none",transition:"all ".concat(null===(o=e.duration)||void 0===o?void 0:o.short,"ms ease-out"),zIndex:2},dragIcon:{position:"absolute",top:e.spacing(1.5),left:e.spacing(1.5),opacity:0,transform:"translate3d(0, ".concat(null==e?void 0:e.spacing(-.5),"px, 0)"),pointerEvents:"none",transition:"all ".concat(null===(i=e.duration)||void 0===i?void 0:i.short,"ms ease-out"),zIndex:2},checkboxRoot:{padding:0,"@global svg":{height:28,width:28}},label:{"&:hover $button":{opacity:1},position:"relative",width:"100%",height:"100%","&:hover $checkbox":{opacity:1,transform:"translate3d(0, 0, 0)",pointerEvents:"all"},"&:hover $dragIcon":{opacity:1,transform:"translate3d(0, 0, 0)",pointerEvents:"all"},"&:hover $overlay":{opacity:1}},button:{opacity:"0",top:"-6px",right:"-6px",position:"absolute",zIndex:1,color:"gray"},preview:{width:"100%",height:"100%"},img:{objectFit:"cover",width:"100%",height:"100%",maxHeight:"100%",maxWidth:"100%"},pdf:{width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none"},audio:{width:"100%",height:"100%",background:"#dddddd"},video:{width:"100%",height:"100%",background:"#dddddd",padding:"2px",boxSizing:"border-box"},website:{background:"#dddddd",fontSize:"10px",overflow:"hidden",width:"100%",height:"100%",boxSizing:"border-box",padding:"4px"},text:{background:"#dddddd",fontSize:"10px",overflow:"hidden",width:"100%",height:"100%",boxSizing:"border-box",padding:"4px"},loading:{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center"}}})}}]);